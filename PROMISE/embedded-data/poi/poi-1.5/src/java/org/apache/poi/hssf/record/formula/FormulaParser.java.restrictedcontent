FormulaParser
String
formulaString
int
pointer
Stack
operationsList
java
util
Stack
Stack
operandsList
java
util
Stack
List
result
ArrayList
int
numParen
char
TAB
char
CR
char
Look
FormulaParser
formula
String
formulaString
formula
pointer
GetChar
Look
charAt
pointer
println
Look
Error
s
String
println
s
Abort
s
String
Error
s
throw
RuntimeException
Expected
s
String
Abort
s
IsAlpha
boolean
c
char
return
isLetter
c
IsDigit
boolean
c
char
println
c
return
isDigit
c
IsAlNum
boolean
c
char
return
IsAlpha
c
IsDigit
c
IsAddop
boolean
c
char
return
c
c
IsWhite
boolean
c
char
return
c
c
TAB
SkipWhite
while
IsWhite
Look
block
GetChar
Match
x
char
if
Look
x
block
Expected
x
block
GetChar
SkipWhite
GetName
String
String
Token
Token
if
IsAlpha
Look
block
Expected
while
IsAlNum
Look
block
Token
Token
toUpperCase
Look
GetChar
SkipWhite
return
Token
GetNum
String
String
Value
if
IsDigit
Look
Expected
while
IsDigit
Look
block
Value
Value
Look
GetChar
SkipWhite
return
Value
Emit
s
String
print
TAB
s
EmitLn
s
String
Emit
s
println
Ident
String
Name
Name
GetName
if
Look
block
Match
Match
block
boolean
cellRef
if
cellRef
block
add
ValueReferencePtg
block
Factor
if
Look
block
Match
add
ParenthesisPtg
Expression
Match
add
ParenthesisPtg
return
if
IsAlpha
Look
block
Ident
block
IntPtg
p
IntPtg
setValue
parseShort
GetNum
add
p
Multiply
Match
Factor
add
MultiplyPtg
Divide
Match
Factor
add
DividePtg
Term
Factor
while
Look
Look
block
if
Look
Multiply
if
Look
Divide
Add
Match
Term
add
AddPtg
Subtract
Match
Term
add
SubtractPtg
Expression
if
IsAddop
Look
block
EmitLn
block
Term
while
IsAddop
Look
block
EmitLn
if
Look
Add
if
Look
Subtract
Init
GetChar
SkipWhite
parse
Init
Expression
tokenToRPN
tokenToRPN
OperationPtg
op
Ptg
operand
int
numOper
int
numOnStack
add
pop
numOnStack
while
isEmpty
block
op
OperationPtg
pop
if
op
ParenthesisPtg
block
for
forControl
numOper
getNumberOfOperands
numOper
numOper
block
if
numOnStack
block
add
pop
block
numOnStack
add
op
numOnStack
toString
String
StringBuffer
buf
StringBuffer
for
forControl
int
i
i
size
i
block
append
Ptg
get
i
append
return
toString
main
argv
String
FormulaParser
fp
FormulaParser
argv
parse
println
toString
