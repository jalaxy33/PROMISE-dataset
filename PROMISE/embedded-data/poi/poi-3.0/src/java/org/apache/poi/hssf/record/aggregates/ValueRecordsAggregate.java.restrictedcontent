ValueRecordsAggregate
short
sid
int
firstcell
int
lastcell
CellValueRecordInterface
records
ValueRecordsAggregate
records
CellValueRecordInterface
insertCell
cell
CellValueRecordInterface
short
column
getColumn
int
row
getRow
if
row
length
block
CellValueRecordInterface
oldRecords
records
int
newSize
length
if
newSize
row
newSize
row
records
CellValueRecordInterface
newSize
arraycopy
oldRecords
records
length
CellValueRecordInterface
rowCells
records
row
if
rowCells
block
int
newSize
column
if
newSize
newSize
rowCells
CellValueRecordInterface
newSize
records
row
rowCells
if
column
length
block
CellValueRecordInterface
oldRowCells
rowCells
int
newSize
length
if
newSize
column
newSize
column
rowCells
CellValueRecordInterface
newSize
arraycopy
oldRowCells
rowCells
length
records
row
rowCells
rowCells
column
cell
if
column
firstcell
firstcell
block
firstcell
column
if
column
lastcell
lastcell
block
lastcell
column
removeCell
cell
CellValueRecordInterface
if
cell
block
short
column
getColumn
int
row
getRow
if
row
length
return
CellValueRecordInterface
rowCells
records
row
if
rowCells
return
if
column
length
return
rowCells
column
getPhysicalNumberOfCells
int
int
count
for
forControl
int
r
r
length
r
block
CellValueRecordInterface
rowCells
records
r
if
rowCells
for
forControl
short
c
c
length
c
block
if
rowCells
c
count
return
count
getFirstCellNum
int
return
firstcell
getLastCellNum
int
return
lastcell
construct
int
offset
int
records
List
int
k
FormulaRecordAggregate
lastFormulaAggregate
List
sharedFormulas
java
util
ArrayList
for
forControl
k
offset
k
size
k
block
Record
rec
Record
get
k
if
rec
StringRecord
isInValueSection
rec
UnknownRecord
block
break
if
rec
SharedFormulaRecord
block
add
rec
if
rec
FormulaRecord
block
FormulaRecord
formula
FormulaRecord
rec
if
isSharedFormula
block
Record
nextRecord
Record
get
k
if
nextRecord
SharedFormulaRecord
block
add
nextRecord
k
boolean
found
for
forControl
int
i
size
i
i
block
SharedFormulaRecord
shrd
SharedFormulaRecord
get
i
if
isFormulaInShared
formula
block
convertSharedFormulaRecord
formula
found
break
if
found
block
lastFormulaAggregate
FormulaRecordAggregate
FormulaRecord
rec
insertCell
lastFormulaAggregate
if
rec
StringRecord
block
setStringRecord
StringRecord
rec
if
isValue
block
insertCell
CellValueRecordInterface
rec
return
k
serialize
int
offset
int
data
byte
throw
RuntimeException
getRowCellBlockSize
int
startRow
int
endRow
int
MyIterator
itr
MyIterator
startRow
endRow
int
size
while
hasNext
block
CellValueRecordInterface
cell
CellValueRecordInterface
next
int
row
getRow
if
row
endRow
break
if
row
startRow
row
endRow
size
Record
cell
return
size
rowHasCells
boolean
row
int
if
row
length
return
CellValueRecordInterface
rowCells
records
row
if
rowCells
return
for
forControl
int
col
col
length
col
block
if
rowCells
col
return
return
serializeCellRow
int
row
int
offset
int
data
byte
MyIterator
itr
MyIterator
row
row
int
pos
offset
while
hasNext
block
CellValueRecordInterface
cell
CellValueRecordInterface
next
if
getRow
row
break
pos
Record
cell
return
pos
offset
fillFields
in
RecordInputStream
validateSid
id
short
getSid
short
return
sid
getRecordSize
int
int
size
Iterator
irecs
getIterator
while
hasNext
block
size
Record
next
return
size
getIterator
Iterator
return
MyIterator
clone
Object
ValueRecordsAggregate
rec
ValueRecordsAggregate
for
forControl
Iterator
valIter
getIterator
hasNext
block
CellValueRecordInterface
val
CellValueRecordInterface
CellValueRecordInterface
next
insertCell
val
return
rec
MyIterator
short
nextColumn
int
nextRow
lastRow
MyIterator
nextRow
lastRow
length
findNext
MyIterator
firstRow
int
lastRow
int
nextRow
firstRow
lastRow
lastRow
findNext
hasNext
boolean
return
nextRow
lastRow
next
Object
Object
o
records
nextRow
nextColumn
findNext
return
o
remove
throw
UnsupportedOperationException
findNext
nextColumn
for
forControl
nextRow
lastRow
nextRow
block
CellValueRecordInterface
rowCells
nextRow
length
records
nextRow
if
rowCells
block
nextColumn
continue
for
forControl
nextColumn
length
nextColumn
block
if
rowCells
nextColumn
return
nextColumn
Iterator
Record
