DrawingManager
EscherDggRecord
dgg
Map
dgMap
HashMap
DrawingManager
dgg
EscherDggRecord
dgg
dgg
createDgRecord
EscherDgRecord
EscherDgRecord
dg
EscherDgRecord
setRecordId
RECORD_ID
short
dgId
findNewDrawingGroupId
setOptions
short
dgId
setNumShapes
setLastMSOSPID
addCluster
dgId
setDrawingsSaved
getDrawingsSaved
put
Short
dgId
dg
return
dg
allocateShapeId
int
drawingGroupId
short
EscherDgRecord
dg
EscherDgRecord
get
Short
drawingGroupId
int
lastShapeId
getLastMSOSPID
int
newShapeId
if
lastShapeId
block
newShapeId
findFreeSPIDBlock
addCluster
drawingGroupId
block
for
forControl
int
i
i
getFileIdClusters
length
i
block
EscherDggRecord
FileIdCluster
c
getFileIdClusters
i
if
getDrawingGroupId
drawingGroupId
block
if
getNumShapeIdsUsed
block
incrementShapeId
if
getLastMSOSPID
block
newShapeId
findFreeSPIDBlock
block
newShapeId
getLastMSOSPID
setNumShapesSaved
getNumShapesSaved
if
newShapeId
getShapeIdMax
block
setShapeIdMax
newShapeId
setLastMSOSPID
newShapeId
incrementShapeCount
return
newShapeId
findNewDrawingGroupId
short
short
dgId
while
drawingGroupExists
dgId
dgId
return
dgId
drawingGroupExists
boolean
dgId
short
for
forControl
int
i
i
getFileIdClusters
length
i
block
if
getFileIdClusters
i
getDrawingGroupId
dgId
return
return
findFreeSPIDBlock
int
int
max
getShapeIdMax
int
next
max
return
next
getDgg
EscherDggRecord
return
dgg
