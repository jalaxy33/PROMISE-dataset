HSSFFormulaEvaluator
Class
OPERATION_CONSTRUCTOR_CLASS_ARRAY
Class
Ptg
Class
VALUE_CONTRUCTOR_CLASS_ARRAY
Class
Ptg
Class
AREA3D_CONSTRUCTOR_CLASS_ARRAY
Class
Ptg
ValueEval
Class
REFERENCE_CONSTRUCTOR_CLASS_ARRAY
Class
Ptg
ValueEval
Class
REF3D_CONSTRUCTOR_CLASS_ARRAY
Class
Ptg
ValueEval
Map
VALUE_EVALS_MAP
HashMap
Map
OPERATION_EVALS_MAP
HashMap
put
BoolPtg
BoolEval
put
IntPtg
NumberEval
put
NumberPtg
NumberEval
put
StringPtg
StringEval
put
AddPtg
AddEval
put
ConcatPtg
ConcatEval
put
DividePtg
DivideEval
put
EqualPtg
EqualEval
put
FuncPtg
FuncVarEval
put
FuncVarPtg
FuncVarEval
put
GreaterEqualPtg
GreaterEqualEval
put
GreaterThanPtg
GreaterThanEval
put
LessEqualPtg
LessEqualEval
put
LessThanPtg
LessThanEval
put
MultiplyPtg
MultiplyEval
put
NotEqualPtg
NotEqualEval
put
PowerPtg
PowerEval
put
SubtractPtg
SubtractEval
put
UnaryMinusPtg
UnaryMinusEval
put
UnaryPlusPtg
UnaryPlusEval
HSSFRow
row
HSSFSheet
sheet
HSSFWorkbook
workbook
HSSFFormulaEvaluator
sheet
HSSFSheet
workbook
HSSFWorkbook
sheet
sheet
workbook
workbook
setCurrentRow
row
HSSFRow
row
row
evaluate
CellValue
cell
HSSFCell
CellValue
retval
if
cell
block
switch
getCellType
case
CELL_TYPE_BLANK
retval
CellValue
CELL_TYPE_BLANK
break
case
CELL_TYPE_BOOLEAN
retval
CellValue
CELL_TYPE_BOOLEAN
setBooleanValue
getBooleanCellValue
break
case
CELL_TYPE_ERROR
retval
CellValue
CELL_TYPE_ERROR
setErrorValue
getErrorCellValue
break
case
CELL_TYPE_FORMULA
retval
getCellValueForEval
internalEvaluate
cell
row
sheet
workbook
break
case
CELL_TYPE_NUMERIC
retval
CellValue
CELL_TYPE_NUMERIC
setNumberValue
getNumericCellValue
break
case
CELL_TYPE_STRING
retval
CellValue
CELL_TYPE_STRING
setRichTextStringValue
getRichStringCellValue
break
return
retval
evaluateInCell
HSSFCell
cell
HSSFCell
if
cell
block
switch
getCellType
case
CELL_TYPE_FORMULA
CellValue
cv
getCellValueForEval
internalEvaluate
cell
row
sheet
workbook
switch
getCellType
case
CELL_TYPE_BOOLEAN
setCellValue
getBooleanValue
break
case
CELL_TYPE_ERROR
setCellValue
getErrorValue
break
case
CELL_TYPE_NUMERIC
setCellType
CELL_TYPE_NUMERIC
setCellValue
getNumberValue
break
case
CELL_TYPE_STRING
setCellValue
getRichTextStringValue
break
case
CELL_TYPE_BLANK
break
case
CELL_TYPE_FORMULA
break
return
cell
getCellValueForEval
CellValue
eval
ValueEval
CellValue
retval
if
eval
block
if
eval
NumberEval
block
NumberEval
ne
NumberEval
eval
retval
CellValue
CELL_TYPE_NUMERIC
setNumberValue
getNumberValue
if
eval
BoolEval
block
BoolEval
be
BoolEval
eval
retval
CellValue
CELL_TYPE_BOOLEAN
setBooleanValue
getBooleanValue
if
eval
StringEval
block
StringEval
ne
StringEval
eval
retval
CellValue
CELL_TYPE_STRING
setStringValue
getStringValue
if
eval
BlankEval
block
retval
CellValue
CELL_TYPE_BLANK
block
retval
CellValue
CELL_TYPE_ERROR
return
retval
internalEvaluate
ValueEval
srcCell
HSSFCell
srcRow
HSSFRow
sheet
HSSFSheet
workbook
HSSFWorkbook
int
srcRowNum
getRowNum
short
srcColNum
getCellNum
FormulaParser
parser
FormulaParser
getCellFormula
getWorkbook
parse
Ptg
ptgs
getRPNPtg
Stack
stack
Stack
for
forControl
int
i
iSize
length
i
iSize
i
block
if
ptgs
i
ControlPtg
block
continue
if
ptgs
i
MemErrPtg
block
continue
if
ptgs
i
MissingArgPtg
block
continue
if
ptgs
i
NamePtg
block
continue
if
ptgs
i
NameXPtg
block
continue
if
ptgs
i
UnknownPtg
block
continue
if
ptgs
i
OperationPtg
block
OperationPtg
optg
OperationPtg
ptgs
i
if
optg
ParenthesisPtg
block
continue
if
optg
AttrPtg
block
continue
if
optg
UnionPtg
block
continue
OperationEval
operation
OperationEval
getOperationEvalForPtg
optg
int
numops
getNumberOfOperands
Eval
ops
Eval
numops
for
forControl
int
j
numops
j
j
block
Eval
p
Eval
pop
ops
j
p
Eval
opresult
evaluate
ops
srcRowNum
srcColNum
push
opresult
if
ptgs
i
ReferencePtg
block
ReferencePtg
ptg
ReferencePtg
ptgs
i
short
colnum
getColumn
short
rownum
getRow
HSSFRow
row
getRow
rownum
HSSFCell
cell
row
getCell
colnum
pushRef2DEval
ptg
stack
cell
row
sheet
workbook
if
ptgs
i
Ref3DPtg
block
Ref3DPtg
ptg
Ref3DPtg
ptgs
i
short
colnum
getColumn
short
rownum
getRow
Workbook
wb
getWorkbook
HSSFSheet
xsheet
getSheetAt
getSheetIndexFromExternSheetIndex
getExternSheetIndex
HSSFRow
row
getRow
rownum
HSSFCell
cell
row
getCell
colnum
pushRef3DEval
ptg
stack
cell
row
xsheet
workbook
if
ptgs
i
AreaPtg
block
AreaPtg
ap
AreaPtg
ptgs
i
short
row0
getFirstRow
short
col0
getFirstColumn
short
row1
getLastRow
short
col1
getLastColumn
ValueEval
values
ValueEval
row1
row0
col1
col0
for
forControl
short
x
row0
sheet
x
row1
x
block
HSSFRow
row
getRow
x
for
forControl
short
y
col0
row
y
col1
y
block
values
x
row0
col1
col0
y
col0
getEvalForCell
getCell
y
row
sheet
workbook
AreaEval
ae
Area2DEval
ap
values
push
ae
if
ptgs
i
Area3DPtg
block
Area3DPtg
a3dp
Area3DPtg
ptgs
i
short
row0
getFirstRow
short
col0
getFirstColumn
short
row1
getLastRow
short
col1
getLastColumn
HSSFSheet
xsheet
getSheetAt
getExternSheetIndex
ValueEval
values
ValueEval
row1
row0
col1
col0
for
forControl
short
x
row0
sheet
x
row1
x
block
HSSFRow
row
getRow
x
for
forControl
short
y
col0
row
y
col1
y
block
values
x
row0
col1
col0
y
col0
getEvalForCell
getCell
y
row
xsheet
workbook
AreaEval
ae
Area3DEval
a3dp
values
push
ae
block
Eval
ptgEval
getEvalForPtg
ptgs
i
push
ptgEval
ValueEval
value
ValueEval
pop
if
value
RefEval
block
RefEval
rv
RefEval
value
value
getInnerValueEval
if
value
AreaEval
block
AreaEval
ae
AreaEval
value
if
isRow
value
getValueAt
getFirstRow
srcColNum
if
isColumn
value
getValueAt
srcRowNum
getFirstColumn
value
VALUE_INVALID
return
value
getOperationEvalForPtg
Eval
ptg
OperationPtg
Eval
retval
Class
clazz
Class
get
getClass
try
Constructor
constructor
getConstructor
OPERATION_CONSTRUCTOR_CLASS_ARRAY
retval
OperationEval
newInstance
Ptg
ptg
catchClause
e
throw
RuntimeException
e
return
retval
getEvalForPtg
Eval
ptg
Ptg
Eval
retval
Class
clazz
Class
get
getClass
try
if
ptg
Area3DPtg
block
Constructor
constructor
getConstructor
AREA3D_CONSTRUCTOR_CLASS_ARRAY
retval
OperationEval
newInstance
Ptg
ptg
if
ptg
AreaPtg
block
Constructor
constructor
getConstructor
AREA3D_CONSTRUCTOR_CLASS_ARRAY
retval
OperationEval
newInstance
Ptg
ptg
if
ptg
ReferencePtg
block
Constructor
constructor
getConstructor
REFERENCE_CONSTRUCTOR_CLASS_ARRAY
retval
OperationEval
newInstance
Ptg
ptg
if
ptg
Ref3DPtg
block
Constructor
constructor
getConstructor
REF3D_CONSTRUCTOR_CLASS_ARRAY
retval
OperationEval
newInstance
Ptg
ptg
block
if
ptg
IntPtg
ptg
NumberPtg
ptg
StringPtg
ptg
BoolPtg
block
Constructor
constructor
getConstructor
VALUE_CONTRUCTOR_CLASS_ARRAY
retval
ValueEval
newInstance
Ptg
ptg
catchClause
e
throw
RuntimeException
e
return
retval
getEvalForCell
ValueEval
cell
HSSFCell
row
HSSFRow
sheet
HSSFSheet
workbook
HSSFWorkbook
ValueEval
retval
INSTANCE
if
cell
block
switch
getCellType
case
CELL_TYPE_NUMERIC
retval
NumberEval
getNumericCellValue
break
case
CELL_TYPE_STRING
retval
StringEval
getRichStringCellValue
getString
break
case
CELL_TYPE_FORMULA
retval
internalEvaluate
cell
row
sheet
workbook
break
case
CELL_TYPE_BOOLEAN
retval
getBooleanCellValue
TRUE
FALSE
break
case
CELL_TYPE_BLANK
retval
INSTANCE
break
case
CELL_TYPE_ERROR
retval
UNKNOWN_ERROR
break
return
retval
pushRef2DEval
ptg
ReferencePtg
stack
Stack
cell
HSSFCell
row
HSSFRow
sheet
HSSFSheet
workbook
HSSFWorkbook
if
cell
switch
getCellType
case
CELL_TYPE_NUMERIC
push
Ref2DEval
ptg
NumberEval
getNumericCellValue
break
case
CELL_TYPE_STRING
push
Ref2DEval
ptg
StringEval
getRichStringCellValue
getString
break
case
CELL_TYPE_FORMULA
push
Ref2DEval
ptg
internalEvaluate
cell
row
sheet
workbook
break
case
CELL_TYPE_BOOLEAN
push
Ref2DEval
ptg
getBooleanCellValue
TRUE
FALSE
break
case
CELL_TYPE_BLANK
push
Ref2DEval
ptg
INSTANCE
break
case
CELL_TYPE_ERROR
push
Ref2DEval
ptg
UNKNOWN_ERROR
break
block
push
Ref2DEval
ptg
INSTANCE
pushRef3DEval
ptg
Ref3DPtg
stack
Stack
cell
HSSFCell
row
HSSFRow
sheet
HSSFSheet
workbook
HSSFWorkbook
if
cell
switch
getCellType
case
CELL_TYPE_NUMERIC
push
Ref3DEval
ptg
NumberEval
getNumericCellValue
break
case
CELL_TYPE_STRING
push
Ref3DEval
ptg
StringEval
getRichStringCellValue
getString
break
case
CELL_TYPE_FORMULA
push
Ref3DEval
ptg
internalEvaluate
cell
row
sheet
workbook
break
case
CELL_TYPE_BOOLEAN
push
Ref3DEval
ptg
getBooleanCellValue
TRUE
FALSE
break
case
CELL_TYPE_BLANK
push
Ref3DEval
ptg
INSTANCE
break
case
CELL_TYPE_ERROR
push
Ref3DEval
ptg
UNKNOWN_ERROR
break
block
push
Ref3DEval
ptg
INSTANCE
CellValue
int
cellType
HSSFRichTextString
richTextStringValue
double
numberValue
boolean
booleanValue
byte
errorValue
CellValue
cellType
int
cellType
cellType
getBooleanValue
boolean
return
booleanValue
setBooleanValue
booleanValue
boolean
booleanValue
booleanValue
getNumberValue
double
return
numberValue
setNumberValue
numberValue
double
numberValue
numberValue
getStringValue
String
return
getString
setStringValue
stringValue
String
richTextStringValue
HSSFRichTextString
stringValue
getCellType
int
return
cellType
getErrorValue
byte
return
errorValue
setErrorValue
errorValue
byte
errorValue
errorValue
getRichTextStringValue
HSSFRichTextString
return
richTextStringValue
setRichTextStringValue
richTextStringValue
HSSFRichTextString
richTextStringValue
richTextStringValue
inspectPtgs
formula
String
FormulaParser
fp
FormulaParser
formula
getWorkbook
parse
Ptg
ptgs
getRPNPtg
println
for
forControl
int
i
iSize
length
i
iSize
i
block
println
println
ptgs
i
if
ptgs
i
OperationPtg
block
println
OperationPtg
ptgs
i
println
println
