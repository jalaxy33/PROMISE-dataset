TextRun
TextHeaderAtom
_headerAtom
TextBytesAtom
_byteAtom
TextCharsAtom
_charAtom
StyleTextPropAtom
_styleAtom
boolean
_isUnicode
RichTextRun
_rtRuns
SlideShow
slideShow
Sheet
sheet
TextRun
tha
TextHeaderAtom
tca
TextCharsAtom
sta
StyleTextPropAtom
tha
tca
sta
TextRun
tha
TextHeaderAtom
tba
TextBytesAtom
sta
StyleTextPropAtom
tha
tba
sta
TextRun
tha
TextHeaderAtom
tba
TextBytesAtom
tca
TextCharsAtom
sta
StyleTextPropAtom
_headerAtom
tha
_styleAtom
sta
if
tba
block
_byteAtom
tba
_isUnicode
block
_charAtom
tca
_isUnicode
String
runRawText
getText
LinkedList
pStyles
LinkedList
LinkedList
cStyles
LinkedList
if
_styleAtom
block
setParentTextSize
length
pStyles
getParagraphStyles
cStyles
getCharacterStyles
if
size
size
block
_rtRuns
RichTextRun
_rtRuns
RichTextRun
length
block
Vector
rtrs
Vector
int
pos
int
curP
int
curC
int
pLenRemain
int
cLenRemain
while
pos
length
curP
size
curC
size
block
TextPropCollection
pProps
TextPropCollection
get
curP
TextPropCollection
cProps
TextPropCollection
get
curC
int
pLen
getCharactersCovered
int
cLen
getCharactersCovered
boolean
freshSet
if
pLenRemain
cLenRemain
block
freshSet
if
pLenRemain
block
pLenRemain
pLen
if
cLenRemain
block
cLenRemain
cLen
int
runLen
boolean
pShared
boolean
cShared
if
pLen
cLen
freshSet
block
runLen
cLen
pShared
cShared
curP
curC
pLenRemain
cLenRemain
block
if
pLenRemain
pLen
block
pShared
if
pLenRemain
cLenRemain
block
cShared
runLen
pLenRemain
curP
curC
pLenRemain
cLenRemain
if
pLenRemain
cLenRemain
block
cShared
runLen
pLenRemain
curP
cLenRemain
pLenRemain
pLenRemain
block
cShared
runLen
cLenRemain
curC
pLenRemain
cLenRemain
cLenRemain
if
cLenRemain
cLen
block
cShared
if
pLenRemain
cLenRemain
block
pShared
runLen
cLenRemain
curP
curC
pLenRemain
cLenRemain
if
cLenRemain
pLenRemain
block
pShared
runLen
cLenRemain
curC
pLenRemain
cLenRemain
cLenRemain
block
pShared
runLen
pLenRemain
curP
cLenRemain
pLenRemain
pLenRemain
block
if
pLenRemain
cLenRemain
block
pShared
cShared
runLen
pLenRemain
curP
cLenRemain
pLenRemain
pLenRemain
block
pShared
cShared
runLen
cLenRemain
curC
pLenRemain
cLenRemain
cLenRemain
int
prevPos
pos
pos
runLen
if
pos
length
block
runLen
RichTextRun
rtr
RichTextRun
prevPos
runLen
pProps
cProps
pShared
cShared
add
rtr
_rtRuns
RichTextRun
size
copyInto
_rtRuns
storeText
s
String
if
endsWith
block
s
substring
length
if
_isUnicode
block
setText
s
block
boolean
hasMultibyte
hasMultibyte
s
if
hasMultibyte
block
byte
text
byte
length
putCompressedUnicode
s
text
setText
text
block
_charAtom
TextCharsAtom
setText
s
RecordContainer
parent
getParentRecord
Record
cr
getChildRecords
for
forControl
int
i
i
length
i
block
if
cr
i
equals
_byteAtom
block
cr
i
_charAtom
break
_byteAtom
_isUnicode
changeTextInRichTextRun
run
RichTextRun
s
String
int
runID
for
forControl
int
i
i
length
i
block
if
equals
_rtRuns
i
block
runID
i
if
runID
block
throw
IllegalArgumentException
ensureStyleAtomPresent
TextPropCollection
pCol
_getRawParagraphStyle
TextPropCollection
cCol
_getRawCharacterStyle
int
newSize
length
if
runID
length
block
newSize
if
_isParagraphStyleShared
block
updateTextSize
getCharactersCovered
getLength
length
block
updateTextSize
newSize
if
_isCharacterStyleShared
block
updateTextSize
getCharactersCovered
getLength
length
block
updateTextSize
newSize
StringBuffer
newText
StringBuffer
for
forControl
int
i
i
length
i
block
int
newStartPos
length
if
i
runID
block
append
_rtRuns
i
getRawText
block
append
s
if
i
runID
block
block
_rtRuns
i
updateStartPosition
newStartPos
storeText
toString
setText
s
String
storeText
s
RichTextRun
fst
_rtRuns
for
forControl
int
i
i
length
i
block
_rtRuns
i
_rtRuns
RichTextRun
_rtRuns
fst
if
_styleAtom
block
LinkedList
pStyles
getParagraphStyles
while
size
block
removeLast
LinkedList
cStyles
getCharacterStyles
while
size
block
removeLast
_rtRuns
setText
s
block
_rtRuns
RichTextRun
length
ensureStyleAtomPresent
if
_styleAtom
block
return
_styleAtom
StyleTextPropAtom
getRawText
length
RecordContainer
runAtomsParent
getParentRecord
Record
addAfter
_byteAtom
if
_byteAtom
block
addAfter
_charAtom
addChildAfter
_styleAtom
addAfter
if
length
block
throw
IllegalStateException
_rtRuns
supplyTextProps
TextPropCollection
getParagraphStyles
get
TextPropCollection
getCharacterStyles
get
getText
String
String
rawText
getRawText
String
text
replace
return
text
getRawText
String
if
_isUnicode
block
return
getText
block
return
getText
getRichTextRuns
RichTextRun
return
_rtRuns
getRunType
int
return
getTextType
setRunType
type
int
setTextType
type
supplySlideShow
ss
SlideShow
slideShow
ss
if
_rtRuns
block
for
forControl
int
i
i
length
i
block
_rtRuns
i
supplySlideShow
slideShow
setSheet
sheet
Sheet
sheet
sheet
getSheet
Sheet
return
sheet
