TestWrite
String
POI_FS
int
BYTE_ORDER
int
FORMAT
int
OS_VERSION
int
SECTION_COUNT
boolean
IS_SUMMARY_INFORMATION
boolean
IS_DOCUMENT_SUMMARY_INFORMATION
String
IMPROPER_DEFAULT_CHARSET_MESSAGE
getDefaultCharsetName
POIFile
poiFiles
TestWrite
name
String
name
setUp
setLogUnsupportedTypes
testNoFormatID
String
dataDirName
getProperty
File
dataDir
File
dataDirName
File
filename
File
dataDir
POI_FS
deleteOnExit
OutputStream
out
FileOutputStream
filename
POIFSFileSystem
poiFs
POIFSFileSystem
MutablePropertySet
ps
MutablePropertySet
clearSections
addSection
MutableSection
try
ByteArrayOutputStream
psStream
ByteArrayOutputStream
write
psStream
close
byte
streamData
toByteArray
createDocument
ByteArrayInputStream
streamData
DEFAULT_STREAM_NAME
writeFilesystem
out
close
fail
catchClause
ex
assertTrue
ex
NoFormatIDException
close
testWriteEmptyPropertySet
File
dataDir
File
getProperty
File
filename
File
dataDir
POI_FS
deleteOnExit
OutputStream
out
FileOutputStream
filename
POIFSFileSystem
poiFs
POIFSFileSystem
MutablePropertySet
ps
MutablePropertySet
MutableSection
s
MutableSection
getSections
get
setFormatID
SUMMARY_INFORMATION_ID
ByteArrayOutputStream
psStream
ByteArrayOutputStream
write
psStream
close
byte
streamData
toByteArray
createDocument
ByteArrayInputStream
streamData
DEFAULT_STREAM_NAME
writeFilesystem
out
close
POIFSReader
r
POIFSReader
registerListener
MyPOIFSReaderListener
DEFAULT_STREAM_NAME
read
FileInputStream
filename
testWriteSimplePropertySet
String
AUTHOR
String
TITLE
File
dataDir
File
getProperty
File
filename
File
dataDir
POI_FS
deleteOnExit
OutputStream
out
FileOutputStream
filename
POIFSFileSystem
poiFs
POIFSFileSystem
MutablePropertySet
ps
MutablePropertySet
MutableSection
si
MutableSection
setFormatID
SUMMARY_INFORMATION_ID
getSections
set
si
MutableProperty
p
MutableProperty
setID
PID_AUTHOR
setType
VT_LPWSTR
setValue
AUTHOR
setProperty
p
setProperty
PID_TITLE
VT_LPSTR
TITLE
createDocument
toInputStream
DEFAULT_STREAM_NAME
writeFilesystem
out
close
PropertySet
psa
PropertySet
POIFSReader
r
POIFSReader
registerListener
POIFSReaderListener
processPOIFSReaderEvent
event
POIFSReaderEvent
try
psa
create
getStream
catchClause
ex
fail
toString
ex
DEFAULT_STREAM_NAME
read
FileInputStream
filename
assertNotNull
psa
assertTrue
psa
isSummaryInformation
Section
s
Section
psa
Object
p1
getProperty
PID_AUTHOR
Object
p2
getProperty
PID_TITLE
assertEquals
AUTHOR
p1
assertEquals
TITLE
p2
testWriteTwoSections
String
STREAM_NAME
String
SECTION1
String
SECTION2
File
dataDir
File
getProperty
File
filename
File
dataDir
POI_FS
deleteOnExit
OutputStream
out
FileOutputStream
filename
POIFSFileSystem
poiFs
POIFSFileSystem
MutablePropertySet
ps
MutablePropertySet
clearSections
ClassID
formatID
ClassID
setBytes
byte
MutableSection
s1
MutableSection
setFormatID
formatID
setProperty
SECTION1
addSection
s1
MutableSection
s2
MutableSection
setFormatID
formatID
setProperty
SECTION2
addSection
s2
createDocument
toInputStream
STREAM_NAME
writeFilesystem
out
close
PropertySet
psa
PropertySet
POIFSReader
r
POIFSReader
registerListener
POIFSReaderListener
processPOIFSReaderEvent
event
POIFSReaderEvent
try
psa
create
getStream
catchClause
ex
printStackTrace
throw
RuntimeException
toString
STREAM_NAME
read
FileInputStream
filename
assertNotNull
psa
Section
s
Section
psa
assertEquals
getFormatID
formatID
Object
p
getProperty
assertEquals
SECTION1
p
s
Section
psa
p
getProperty
assertEquals
SECTION2
p
MyPOIFSReaderListener
processPOIFSReaderEvent
event
POIFSReaderEvent
try
create
getStream
catchClause
ex
fail
toString
ex
POIFSReaderListener
int
CODEPAGE_DEFAULT
int
CODEPAGE_1252
int
CODEPAGE_UTF8
CP_UTF8
int
CODEPAGE_UTF16
CP_UTF16
testVariantTypes
Throwable
t
int
codepage
CODEPAGE_DEFAULT
if
hasProperDefaultCharset
block
println
IMPROPER_DEFAULT_CHARSET_MESSAGE
return
try
check
VT_EMPTY
codepage
check
VT_BOOL
Boolean
codepage
check
VT_BOOL
Boolean
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_CF
byte
codepage
check
VT_I4
Integer
codepage
check
VT_I8
Long
codepage
check
VT_R8
Double
codepage
check
VT_I4
Integer
codepage
check
VT_I8
Long
codepage
check
VT_R8
Double
codepage
check
VT_FILETIME
Date
codepage
check
VT_I4
Integer
MAX_VALUE
codepage
check
VT_I4
Integer
MIN_VALUE
codepage
check
VT_I8
Long
MAX_VALUE
codepage
check
VT_I8
Long
MIN_VALUE
codepage
check
VT_R8
Double
MAX_VALUE
codepage
check
VT_R8
Double
MIN_VALUE
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
check
VT_LPWSTR
codepage
catchClause
ex
t
ex
catchClause
ex
t
ex
if
t
fail
toString
t
testCodepages
Throwable
thr
int
validCodepages
int
CODEPAGE_DEFAULT
CODEPAGE_UTF8
CODEPAGE_UTF16
CODEPAGE_1252
for
forControl
int
i
i
length
i
block
int
cp
validCodepages
i
if
cp
hasProperDefaultCharset
block
println
IMPROPER_DEFAULT_CHARSET_MESSAGE
continue
long
t
cp
CODEPAGE_UTF16
VT_LPWSTR
VT_LPSTR
try
check
t
cp
check
t
cp
check
t
cp
check
t
cp
check
t
cp
check
t
cp
check
t
cp
check
t
cp
if
cp
CP_UTF16
cp
CP_UTF8
check
t
cp
catchClause
ex
thr
ex
catchClause
ex
thr
ex
if
thr
fail
toString
thr
cp
int
invalidCodepages
int
for
forControl
int
i
i
length
i
block
int
cp
invalidCodepages
i
long
type
cp
CODEPAGE_UTF16
VT_LPWSTR
VT_LPSTR
try
check
type
cp
check
type
cp
check
type
cp
check
type
cp
check
type
cp
check
type
cp
check
type
cp
check
type
cp
fail
cp
catchClause
ex
catchClause
ex
thr
ex
catchClause
ex
thr
ex
if
thr
fail
toString
thr
testUnicodeWrite8Bit
String
TITLE
MutablePropertySet
mps
MutablePropertySet
MutableSection
ms
MutableSection
getSections
get
setFormatID
SUMMARY_INFORMATION_ID
MutableProperty
p
MutableProperty
setID
PID_TITLE
setType
VT_LPSTR
setValue
TITLE
setProperty
p
Throwable
t
try
ByteArrayOutputStream
out
ByteArrayOutputStream
write
out
close
byte
bytes
toByteArray
PropertySet
psr
PropertySet
bytes
assertTrue
isSummaryInformation
Section
sr
Section
getSections
get
String
title
String
getProperty
PID_TITLE
assertEquals
TITLE
title
catchClause
e
t
e
catchClause
e
t
e
catchClause
e
t
e
if
t
fail
getMessage
check
variantType
long
value
Object
codepage
int
ByteArrayOutputStream
out
ByteArrayOutputStream
write
out
variantType
value
codepage
close
byte
b
toByteArray
Object
objRead
read
b
length
INT_SIZE
variantType
codepage
if
objRead
byte
block
int
diff
diff
byte
value
byte
objRead
if
diff
fail
diff
if
value
equals
objRead
block
fail
value
objRead
codepage
codepage
getProperty
assertEquals
value
objRead
diff
int
a
byte
b
byte
int
min
min
length
length
for
forControl
int
i
i
min
i
if
a
i
b
i
return
i
if
length
length
return
min
return
testRecreate
File
dataDir
File
getProperty
File
fileList
listFiles
FileFilter
accept
boolean
f
File
return
getName
startsWith
for
forControl
int
i
i
length
i
testRecreate
fileList
i
testRecreate
f
File
println
f
try
POIFile
psf1
readPropertySets
f
File
copy
createTempFile
getName
deleteOnExit
OutputStream
out
FileOutputStream
copy
POIFSFileSystem
poiFs
POIFSFileSystem
for
forControl
int
i
i
length
i
block
InputStream
in
ByteArrayInputStream
psf1
i
getBytes
PropertySet
psIn
create
in
MutablePropertySet
psOut
MutablePropertySet
psIn
ByteArrayOutputStream
psStream
ByteArrayOutputStream
write
psStream
close
byte
streamData
toByteArray
createDocument
ByteArrayInputStream
streamData
psf1
i
getName
writeFilesystem
out
close
POIFile
psf2
readPropertySets
copy
for
forControl
int
i
i
length
i
block
byte
bytes1
psf1
i
getBytes
byte
bytes2
psf2
i
getBytes
InputStream
in1
ByteArrayInputStream
bytes1
InputStream
in2
ByteArrayInputStream
bytes2
PropertySet
ps1
create
in1
PropertySet
ps2
create
in2
assertEquals
getName
ps1
ps2
catchClause
ex
handle
ex
testDictionary
try
File
copy
createTempFile
deleteOnExit
OutputStream
out
FileOutputStream
copy
POIFSFileSystem
poiFs
POIFSFileSystem
MutablePropertySet
ps1
MutablePropertySet
MutableSection
s
MutableSection
getSections
get
Map
m
HashMap
put
Long
put
Long
put
Long
setDictionary
m
setFormatID
DOCUMENT_SUMMARY_INFORMATION_ID
int
codepage
CP_UNICODE
setProperty
PID_CODEPAGE
VT_I2
Integer
codepage
createDocument
toInputStream
writeFilesystem
out
close
POIFile
psf
readPropertySets
copy
assertEquals
length
byte
bytes
psf
getBytes
InputStream
in
ByteArrayInputStream
bytes
PropertySet
ps2
create
in
assertTrue
isDocumentSummaryInformation
assertEquals
ps1
ps2
catchClause
ex
handle
ex
testDictionaryWithInvalidCodepage
try
File
copy
createTempFile
deleteOnExit
OutputStream
out
FileOutputStream
copy
POIFSFileSystem
poiFs
POIFSFileSystem
MutablePropertySet
ps1
MutablePropertySet
MutableSection
s
MutableSection
getSections
get
Map
m
HashMap
put
Long
put
Long
put
Long
setDictionary
m
setFormatID
DOCUMENT_SUMMARY_INFORMATION_ID
int
codepage
setProperty
PID_CODEPAGE
VT_I2
Integer
codepage
createDocument
toInputStream
writeFilesystem
out
close
fail
catchClause
ex
assertTrue
catchClause
ex
handle
ex
handle
ex
Exception
StringWriter
sw
StringWriter
PrintWriter
pw
PrintWriter
sw
Throwable
t
ex
while
t
block
printStackTrace
pw
if
t
HPSFRuntimeException
t
HPSFRuntimeException
t
t
if
t
println
close
try
close
catchClause
ex2
printStackTrace
fail
toString
getDefaultCharsetName
String
String
charSetName
getProperty
Charset
charSet
forName
charSetName
return
displayName
hasProperDefaultCharset
boolean
String
charSetName
getProperty
Charset
charSet
forName
charSetName
return
newEncoder
canEncode
main
args
String
setProperty
run
TestWrite
TestCase
