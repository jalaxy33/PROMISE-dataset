POIFSFileSystem
PropertyTable
_property_table
List
_documents
DirectoryNode
_root
POIFSFileSystem
_property_table
PropertyTable
_documents
ArrayList
_root
POIFSFileSystem
stream
InputStream
HeaderBlockReader
header_block_reader
HeaderBlockReader
stream
RawDataBlockList
data_blocks
RawDataBlockList
stream
BlockAllocationTableReader
getBATCount
getBATArray
getXBATCount
getXBATIndex
data_blocks
PropertyTable
properties
PropertyTable
getPropertyStart
data_blocks
processProperties
getSmallDocumentBlocks
data_blocks
getRoot
getSBATStart
data_blocks
getRoot
getChildren
createDocument
DocumentEntry
stream
InputStream
name
String
return
getRoot
createDocument
name
stream
createDocument
DocumentEntry
name
String
size
int
writer
POIFSWriterListener
return
getRoot
createDocument
name
size
writer
createDirectory
DirectoryEntry
name
String
return
getRoot
createDirectory
name
writeFilesystem
stream
OutputStream
preWrite
SmallBlockTableWriter
sbtw
SmallBlockTableWriter
_documents
getRoot
BlockAllocationTableWriter
bat
BlockAllocationTableWriter
List
bm_objects
ArrayList
addAll
_documents
add
_property_table
add
sbtw
add
getSBAT
Iterator
iter
iterator
while
hasNext
block
BATManaged
bmo
BATManaged
next
int
block_count
countBlocks
if
block_count
block
setStartBlock
allocateSpace
block_count
block
int
batStartBlock
createBlocks
HeaderBlockWriter
header_block_writer
HeaderBlockWriter
BATBlock
xbat_blocks
setBATBlocks
countBlocks
batStartBlock
setPropertyStart
getStartBlock
setSBATStart
getSBAT
getStartBlock
setSBATBlockCount
getSBATBlockCount
List
writers
ArrayList
add
header_block_writer
addAll
_documents
add
_property_table
add
sbtw
add
getSBAT
add
bat
for
forControl
int
j
j
length
j
block
add
xbat_blocks
j
iter
iterator
while
hasNext
block
BlockWritable
writer
BlockWritable
next
writeBlocks
stream
main
args
String
if
length
block
println
exit
FileInputStream
istream
FileInputStream
args
FileOutputStream
ostream
FileOutputStream
args
writeFilesystem
ostream
POIFSFileSystem
istream
close
close
getRoot
DirectoryEntry
if
_root
block
_root
DirectoryNode
getRoot
return
_root
createDocumentInputStream
DocumentInputStream
documentName
String
Entry
document
getRoot
getEntry
documentName
if
isDocumentEntry
block
throw
IOException
documentName
return
DocumentInputStream
DocumentEntry
document
addDocument
document
POIFSDocument
add
document
addProperty
getDocumentProperty
addDirectory
directory
DirectoryProperty
addProperty
directory
remove
entry
EntryNode
removeProperty
getProperty
if
isDocumentEntry
block
remove
DocumentNode
entry
processProperties
small_blocks
BlockList
big_blocks
BlockList
properties
Iterator
dir
DirectoryNode
while
hasNext
block
Property
property
Property
next
String
name
getName
DirectoryNode
parent
dir
DirectoryNode
getRoot
dir
if
isDirectory
block
DirectoryNode
new_dir
DirectoryNode
createDirectory
name
setStorageClsid
getStorageClsid
processProperties
small_blocks
big_blocks
DirectoryProperty
property
new_dir
block
int
startBlock
getStartBlock
int
size
getSize
POIFSDocument
document
if
shouldUseSmallBlocks
block
document
POIFSDocument
name
fetchBlocks
startBlock
size
block
document
POIFSDocument
name
fetchBlocks
startBlock
size
createDocument
document
getViewableArray
Object
if
preferArray
block
return
POIFSViewable
getRoot
block
return
Object
getViewableIterator
Iterator
if
preferArray
block
return
POIFSViewable
getRoot
block
return
iterator
preferArray
boolean
return
POIFSViewable
getRoot
getShortDescription
String
return
POIFSViewable
