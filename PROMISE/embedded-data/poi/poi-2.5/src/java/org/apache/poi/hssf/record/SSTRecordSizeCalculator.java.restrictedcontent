SSTRecordSizeCalculator
UnicodeString
unistr
int
stringReminant
int
unipos
boolean
isRemainingString
int
totalBytesWritten
boolean
finished
boolean
firstRecord
int
totalWritten
int
recordSize
List
recordLengths
ArrayList
int
pos
Map
strings
SSTRecordSizeCalculator
strings
Map
strings
strings
getRecordSize
int
initVars
int
retval
int
totalStringSpaceRequired
calculateUnicodeSize
strings
if
totalStringSpaceRequired
MAX_DATA_SPACE
block
retval
sizeOverContinuation
totalStringSpaceRequired
block
retval
SST_RECORD_OVERHEAD
totalStringSpaceRequired
add
Integer
totalStringSpaceRequired
return
retval
getRecordLengths
List
return
recordLengths
sizeOverContinuation
int
totalStringSpaceRequired
int
int
retval
while
finished
block
recordSize
pos
if
firstRecord
block
addMaxLengthRecordSize
block
pos
int
toBeWritten
totalStringSpaceRequired
totalBytesWritten
isRemainingString
int
size
min
MAX_RECORD_SIZE
STD_RECORD_OVERHEAD
toBeWritten
if
size
toBeWritten
block
finished
recordSize
size
STD_RECORD_OVERHEAD
add
Integer
size
pos
if
isRemainingString
block
calcReminant
calcRemainingStrings
totalWritten
recordSize
retval
totalWritten
return
retval
addMaxLengthRecordSize
recordSize
MAX_RECORD_SIZE
pos
firstRecord
add
Integer
recordSize
STD_RECORD_OVERHEAD
calcRemainingStrings
for
forControl
unipos
size
unipos
block
int
available
MAX_RECORD_SIZE
pos
Integer
intunipos
Integer
unipos
unistr
UnicodeString
get
intunipos
if
getRecordSize
available
block
totalBytesWritten
getRecordSize
pos
getRecordSize
block
if
available
STRING_MINIMAL_OVERHEAD
block
int
toBeWritten
maxBrokenLength
available
totalBytesWritten
toBeWritten
stringReminant
getRecordSize
toBeWritten
BYTE_SIZE
if
available
toBeWritten
block
int
shortrecord
recordSize
available
toBeWritten
set
size
Integer
shortrecord
STD_RECORD_OVERHEAD
recordSize
shortrecord
isRemainingString
unipos
block
int
shortrecord
recordSize
available
set
size
Integer
shortrecord
STD_RECORD_OVERHEAD
recordSize
shortrecord
break
calcReminant
int
available
MAX_RECORD_SIZE
pos
if
stringReminant
available
block
totalBytesWritten
stringReminant
pos
stringReminant
isRemainingString
block
int
toBeWritten
maxBrokenLength
available
if
available
toBeWritten
block
int
shortrecord
recordSize
available
toBeWritten
set
size
Integer
shortrecord
STD_RECORD_OVERHEAD
recordSize
shortrecord
totalBytesWritten
toBeWritten
pos
toBeWritten
stringReminant
toBeWritten
isRemainingString
initVars
unistr
stringReminant
unipos
isRemainingString
totalBytesWritten
finished
firstRecord
totalWritten
