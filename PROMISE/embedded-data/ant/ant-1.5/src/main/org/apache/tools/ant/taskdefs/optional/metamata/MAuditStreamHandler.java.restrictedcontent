MAuditStreamHandler
MAudit
task
BufferedReader
br
OutputStream
xmlOut
OutputStream
errStream
Thread
errThread
Hashtable
auditedFiles
Hashtable
Date
program_start
MAuditStreamHandler
task
MAudit
xmlOut
OutputStream
task
task
xmlOut
xmlOut
setProcessInputStream
os
OutputStream
setProcessErrorStream
is
InputStream
errStream
LogOutputStream
task
MSG_ERR
errThread
createPump
is
errStream
setProcessOutputStream
is
InputStream
br
BufferedReader
InputStreamReader
is
start
program_start
Date
start
parseOutput
br
stop
try
join
catchClause
e
try
flush
catchClause
e
Document
doc
getDocumentBuilder
newDocument
Element
rootElement
createElement
Enumeration
keys
keys
Hashtable
filemapping
getFileMapping
Date
now
Date
setAttribute
format
now
ISO8601_DATETIME_PATTERN
setAttribute
valueOf
getTime
getTime
setAttribute
format
now
ISO8601_DATETIME_PATTERN
setAttribute
valueOf
size
setAttribute
valueOf
size
int
errors
while
hasMoreElements
block
String
filepath
String
nextElement
Vector
v
Vector
get
filepath
String
fullclassname
String
get
filepath
if
fullclassname
block
getProject
log
filepath
MSG_WARN
continue
int
pos
lastIndexOf
String
pkg
pos
substring
pos
String
clazzname
pos
fullclassname
substring
pos
Element
clazz
createElement
setAttribute
pkg
setAttribute
clazzname
int
violationCount
size
setAttribute
valueOf
violationCount
errors
violationCount
for
forControl
int
i
i
violationCount
i
block
MAuditParser
Violation
violation
MAuditParser
Violation
elementAt
i
Element
error
createElement
setAttribute
line
setAttribute
error
appendChild
error
appendChild
clazz
setAttribute
valueOf
errors
DOMElementWriter
domWriter
DOMElementWriter
try
write
rootElement
xmlOut
catchClause
e
throw
BuildException
e
getDocumentBuilder
DocumentBuilder
try
return
newInstance
newDocumentBuilder
catchClause
exc
throw
ExceptionInInitializerError
exc
createPump
Thread
is
InputStream
os
OutputStream
Thread
result
Thread
StreamPumper
is
os
setDaemon
return
result
parseOutput
br
BufferedReader
String
line
MAuditParser
parser
MAuditParser
while
line
readLine
block
MAuditParser
Violation
violation
parseLine
line
if
violation
block
addViolation
file
violation
block
log
line
MSG_INFO
addViolation
file
String
entry
MAuditParser
Violation
Vector
violations
Vector
get
file
if
violations
block
violations
Vector
put
file
violations
addElement
entry
ExecuteStreamHandler
