Depend
ClassFileInfo
File
absoluteFile
String
className
File
sourceFile
boolean
isUserWarned
Path
srcPath
Path
destPath
File
cache
String
srcPathList
Hashtable
affectedClassMap
Hashtable
classFileInfoMap
Hashtable
classpathDependencies
Hashtable
outOfDateClasses
boolean
closure
boolean
dump
Path
dependClasspath
String
CACHE_FILE_NAME
String
CLASSNAME_PREPEND
setClasspath
classpath
Path
if
dependClasspath
block
dependClasspath
classpath
block
append
classpath
getClasspath
Path
return
dependClasspath
createClasspath
Path
if
dependClasspath
block
dependClasspath
Path
getProject
return
createPath
setClasspathRef
r
Reference
createClasspath
setRefid
r
readCachedDependencies
Hashtable
depFile
File
Hashtable
dependencyMap
Hashtable
BufferedReader
in
try
in
BufferedReader
FileReader
depFile
String
line
Vector
dependencyList
String
className
int
prependLength
length
while
line
readLine
block
if
startsWith
CLASSNAME_PREPEND
block
dependencyList
Vector
className
substring
prependLength
put
className
dependencyList
block
addElement
line
if
in
block
close
return
dependencyMap
writeCachedDependencies
dependencyMap
Hashtable
if
cache
block
PrintWriter
pw
try
mkdirs
File
depFile
File
cache
CACHE_FILE_NAME
pw
PrintWriter
FileWriter
depFile
Enumeration
e
keys
while
hasMoreElements
block
String
className
String
nextElement
println
CLASSNAME_PREPEND
className
Vector
dependencyList
Vector
get
className
int
size
size
for
forControl
int
x
x
size
x
block
println
elementAt
x
if
pw
block
close
getCheckClassPath
Path
if
dependClasspath
block
return
String
destPathElements
list
String
classpathElements
list
String
checkPath
for
forControl
int
i
i
length
i
block
String
element
classpathElements
i
boolean
inDestPath
for
forControl
int
j
j
length
inDestPath
j
block
inDestPath
destPathElements
j
equals
element
if
inDestPath
block
if
length
block
checkPath
element
block
checkPath
element
if
length
block
return
return
Path
getProject
checkPath
determineDependencies
affectedClassMap
Hashtable
classFileInfoMap
Hashtable
boolean
cacheDirty
Hashtable
dependencyMap
Hashtable
File
cacheFile
boolean
cacheFileExists
long
cacheLastModified
MAX_VALUE
if
cache
block
cacheFile
File
cache
CACHE_FILE_NAME
cacheFileExists
exists
cacheLastModified
lastModified
if
cacheFileExists
block
dependencyMap
readCachedDependencies
cacheFile
Enumeration
classfileEnum
getClassFiles
elements
destPath
while
hasMoreElements
block
ClassFileInfo
info
ClassFileInfo
nextElement
log
className
MSG_DEBUG
put
className
info
Vector
dependencyList
if
cache
block
if
cacheFileExists
cacheLastModified
lastModified
block
dependencyList
Vector
get
className
if
dependencyList
block
DependencyAnalyzer
analyzer
AntAnalyzer
addRootClass
className
addClassPath
destPath
setClosure
dependencyList
Vector
Enumeration
depEnum
getClassDependencies
while
hasMoreElements
block
addElement
nextElement
if
dependencyList
block
cacheDirty
put
className
dependencyList
Enumeration
depEnum
elements
while
hasMoreElements
block
String
dependentClass
String
nextElement
Hashtable
affectedClasses
Hashtable
get
dependentClass
if
affectedClasses
block
affectedClasses
Hashtable
put
dependentClass
affectedClasses
put
className
info
classpathDependencies
Path
checkPath
getCheckClassPath
if
checkPath
block
classpathDependencies
Hashtable
AntClassLoader
loader
getProject
createClassLoader
checkPath
Hashtable
classpathFileCache
Hashtable
Object
nullFileMarker
Object
for
forControl
Enumeration
e
keys
hasMoreElements
block
String
className
String
nextElement
Vector
dependencyList
Vector
get
className
Hashtable
dependencies
Hashtable
put
className
dependencies
Enumeration
e2
elements
while
hasMoreElements
block
String
dependency
String
nextElement
Object
classpathFileObject
get
dependency
if
classpathFileObject
block
classpathFileObject
nullFileMarker
if
startsWith
startsWith
block
URL
classURL
getResource
replace
if
classURL
block
if
getProtocol
equals
block
String
jarFilePath
getFile
if
startsWith
block
int
classMarker
indexOf
jarFilePath
substring
classMarker
classpathFileObject
File
jarFilePath
if
getProtocol
equals
block
String
classFilePath
getFile
classpathFileObject
File
classFilePath
log
className
classpathFileObject
dependency
MSG_DEBUG
put
dependency
classpathFileObject
if
classpathFileObject
classpathFileObject
nullFileMarker
block
File
jarFile
File
classpathFileObject
put
jarFile
jarFile
if
cache
cacheDirty
block
writeCachedDependencies
dependencyMap
deleteAllAffectedFiles
int
int
count
for
forControl
Enumeration
e
elements
hasMoreElements
block
String
className
String
nextElement
count
deleteAffectedFiles
className
ClassFileInfo
classInfo
ClassFileInfo
get
className
if
classInfo
exists
block
delete
count
return
count
deleteAffectedFiles
int
className
String
int
count
Hashtable
affectedClasses
Hashtable
get
className
if
affectedClasses
block
return
count
for
forControl
Enumeration
e
keys
hasMoreElements
block
String
affectedClass
String
nextElement
ClassFileInfo
affectedClassInfo
ClassFileInfo
get
affectedClass
if
exists
block
continue
if
sourceFile
block
if
isUserWarned
block
log
affectedClass
getPath
className
MSG_WARN
isUserWarned
continue
log
getPath
className
MSG_VERBOSE
delete
count
if
closure
block
count
deleteAffectedFiles
affectedClass
block
if
indexOf
block
continue
String
topLevelClassName
substring
indexOf
log
topLevelClassName
MSG_VERBOSE
ClassFileInfo
topLevelClassInfo
ClassFileInfo
get
topLevelClassName
if
topLevelClassInfo
exists
block
log
getPath
MSG_VERBOSE
delete
count
if
closure
block
count
deleteAffectedFiles
topLevelClassName
return
count
dumpDependencies
log
size
MSG_DEBUG
Enumeration
classEnum
keys
while
hasMoreElements
block
String
className
String
nextElement
log
className
MSG_DEBUG
Hashtable
affectedClasses
Hashtable
get
className
Enumeration
affectedClassEnum
keys
while
hasMoreElements
block
String
affectedClass
String
nextElement
ClassFileInfo
info
ClassFileInfo
get
affectedClass
log
affectedClass
getPath
MSG_DEBUG
if
classpathDependencies
block
log
MSG_DEBUG
Enumeration
classpathEnum
keys
while
hasMoreElements
block
String
className
String
nextElement
log
className
MSG_DEBUG
Hashtable
dependencies
Hashtable
get
className
Enumeration
classpathFileEnum
elements
while
hasMoreElements
block
File
classpathFile
File
nextElement
log
getPath
MSG_DEBUG
determineOutOfDateClasses
outOfDateClasses
Hashtable
for
forControl
int
i
i
length
i
block
File
srcDir
File
getProject
resolveFile
srcPathList
i
if
exists
block
DirectoryScanner
ds
getDirectoryScanner
srcDir
String
files
getIncludedFiles
scanDir
srcDir
files
if
classpathDependencies
block
return
Enumeration
classpathDepsEnum
keys
while
hasMoreElements
block
String
className
String
nextElement
if
containsKey
className
block
continue
ClassFileInfo
info
ClassFileInfo
get
className
if
info
block
Hashtable
dependencies
Hashtable
get
className
for
forControl
Enumeration
e2
elements
hasMoreElements
block
File
classpathFile
File
nextElement
if
lastModified
lastModified
block
log
className
classpathFile
MSG_DEBUG
put
className
className
break
execute
try
long
start
currentTimeMillis
if
srcPath
block
throw
BuildException
getLocation
srcPathList
list
if
length
block
throw
BuildException
getLocation
if
destPath
block
destPath
srcPath
if
cache
exists
isDirectory
block
throw
BuildException
if
cache
exists
block
mkdirs
determineDependencies
if
dump
block
dumpDependencies
determineOutOfDateClasses
int
count
deleteAllAffectedFiles
long
duration
currentTimeMillis
start
log
count
duration
catchClause
e
throw
BuildException
e
scanDir
srcDir
File
files
String
for
forControl
int
i
i
length
i
block
File
srcFile
File
srcDir
files
i
if
files
i
endsWith
block
String
filePath
getPath
String
className
substring
getPath
length
length
length
className
convertSlashName
className
ClassFileInfo
info
ClassFileInfo
get
className
if
info
block
put
className
className
block
if
lastModified
lastModified
block
put
className
className
getClassFiles
Vector
classLocations
Path
String
classLocationsList
list
Vector
classFileList
Vector
for
forControl
int
i
i
length
i
block
File
dir
File
classLocationsList
i
if
isDirectory
block
addClassFiles
classFileList
dir
dir
return
classFileList
findSourceFile
File
classname
String
String
sourceFilename
classname
int
innerIndex
indexOf
if
innerIndex
block
sourceFilename
substring
innerIndex
for
forControl
int
i
i
length
i
block
File
sourceFile
File
srcPathList
i
sourceFilename
if
exists
block
return
sourceFile
return
addClassFiles
classFileList
Vector
dir
File
root
File
String
filesInDir
list
if
filesInDir
block
return
int
length
length
int
rootLength
getPath
length
for
forControl
int
i
i
length
i
block
File
file
File
dir
filesInDir
i
if
isDirectory
block
addClassFiles
classFileList
file
root
if
getName
endsWith
block
ClassFileInfo
info
ClassFileInfo
absoluteFile
file
String
relativeName
getPath
substring
rootLength
getPath
length
className
convertSlashName
relativeName
sourceFile
findSourceFile
relativeName
addElement
info
setSrcdir
srcPath
Path
srcPath
srcPath
setDestDir
destPath
Path
destPath
destPath
setCache
cache
File
cache
cache
setClosure
closure
boolean
closure
closure
setDump
dump
boolean
dump
dump
MatchingTask
