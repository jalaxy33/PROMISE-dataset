GenericDeploymentTool
String
META_DIR
String
EJB_DD
EjbJar
Config
config
File
destDir
Path
classpath
String
genericJarSuffix
Task
task
ClassLoader
classpathLoader
List
addedfiles
DescriptorHandler
handler
setDestdir
inDir
File
destDir
inDir
getDestDir
File
return
destDir
setTask
task
Task
task
task
getTask
Task
return
task
getConfig
EjbJar
Config
return
config
usingBaseJarName
boolean
return
baseJarName
setGenericJarSuffix
inString
String
genericJarSuffix
inString
createClasspath
Path
if
classpath
block
classpath
Path
getProject
return
createPath
setClasspath
classpath
Path
classpath
classpath
getCombinedClasspath
Path
Path
combinedPath
classpath
if
classpath
block
if
combinedPath
block
combinedPath
classpath
block
append
classpath
return
combinedPath
log
message
String
level
int
getTask
log
message
level
getLocation
Location
return
getTask
getLocation
configure
config
EjbJar
Config
config
config
classpathLoader
addFileToJar
jStream
JarOutputStream
inputFile
File
logicalFilename
String
FileInputStream
iStream
try
if
contains
logicalFilename
block
iStream
FileInputStream
inputFile
ZipEntry
zipEntry
ZipEntry
replace
putNextEntry
zipEntry
byte
byteBuffer
byte
int
count
do
count
block
write
byteBuffer
count
count
read
byteBuffer
length
add
logicalFilename
catchClause
ioe
log
logicalFilename
getPath
getClass
getName
getMessage
MSG_WARN
if
iStream
block
try
close
catchClause
closeException
getDescriptorHandler
DescriptorHandler
srcDir
File
DescriptorHandler
handler
DescriptorHandler
getTask
srcDir
registerKnownDTDs
handler
for
forControl
Iterator
i
getConfig
dtdLocations
iterator
hasNext
block
EjbJar
DTDLocation
dtdLocation
EjbJar
DTDLocation
next
registerDTD
getPublicId
getLocation
return
handler
registerKnownDTDs
handler
DescriptorHandler
processDescriptor
descriptorFileName
String
saxParser
SAXParser
checkConfiguration
descriptorFileName
saxParser
try
handler
getDescriptorHandler
srcDir
Hashtable
ejbFiles
parseEjbFiles
descriptorFileName
saxParser
addSupportClasses
ejbFiles
String
baseName
getJarBaseName
descriptorFileName
String
ddPrefix
getVendorDDPrefix
baseName
descriptorFileName
put
META_DIR
EJB_DD
File
descriptorDir
descriptorFileName
addVendorFiles
ejbFiles
ddPrefix
checkAndAddInherited
ejbFiles
if
flatDestDir
length
block
int
startName
lastIndexOf
separator
if
startName
block
startName
int
endName
length
baseName
substring
startName
endName
File
jarFile
getVendorOutputJarFile
baseName
if
needToRebuild
ejbFiles
jarFile
block
log
getName
valueOf
size
MSG_INFO
String
publicId
getPublicId
writeJar
baseName
jarFile
ejbFiles
publicId
block
log
toString
MSG_VERBOSE
catchClause
se
String
msg
toString
getMessage
throw
BuildException
msg
se
catchClause
ioe
String
msg
toString
getMessage
throw
BuildException
msg
ioe
checkConfiguration
descriptorFileName
String
saxParser
SAXParser
parseEjbFiles
Hashtable
descriptorFileName
String
saxParser
SAXParser
FileInputStream
descriptorStream
Hashtable
ejbFiles
try
descriptorStream
FileInputStream
File
descriptorDir
descriptorFileName
parse
InputSource
descriptorStream
handler
ejbFiles
getFiles
if
descriptorStream
block
try
close
catchClause
closeException
return
ejbFiles
addSupportClasses
ejbFiles
Hashtable
Project
project
getProject
for
forControl
Iterator
i
iterator
hasNext
block
FileSet
supportFileSet
FileSet
next
File
supportBaseDir
getDir
project
DirectoryScanner
supportScanner
getDirectoryScanner
project
scan
String
supportFiles
getIncludedFiles
for
forControl
int
j
j
length
j
block
put
supportFiles
j
File
supportBaseDir
supportFiles
j
getJarBaseName
String
descriptorFileName
String
String
baseName
if
getValue
equals
BASEJARNAME
block
String
canonicalDescriptor
replace
int
index
lastIndexOf
if
index
block
baseName
substring
index
baseName
baseJarName
if
getValue
equals
DESCRIPTOR
block
int
lastSeparatorIndex
lastIndexOf
separator
int
endBaseName
if
lastSeparatorIndex
block
endBaseName
indexOf
baseNameTerminator
lastSeparatorIndex
block
endBaseName
indexOf
baseNameTerminator
if
endBaseName
block
baseName
substring
endBaseName
baseName
substring
endBaseName
if
getValue
equals
DIRECTORY
block
int
lastSeparatorIndex
lastIndexOf
separator
String
dirName
substring
lastSeparatorIndex
int
dirSeparatorIndex
lastIndexOf
separator
if
dirSeparatorIndex
block
dirName
substring
dirSeparatorIndex
baseName
dirName
if
getValue
equals
EJB_NAME
block
baseName
getEjbName
return
baseName
getVendorDDPrefix
String
baseName
String
descriptorFileName
String
String
ddPrefix
if
getValue
equals
DESCRIPTOR
block
ddPrefix
baseName
baseNameTerminator
if
getValue
equals
BASEJARNAME
getValue
equals
EJB_NAME
getValue
equals
DIRECTORY
block
String
canonicalDescriptor
replace
int
index
lastIndexOf
if
index
block
ddPrefix
block
ddPrefix
substring
index
return
ddPrefix
addVendorFiles
ejbFiles
Hashtable
ddPrefix
String
getVendorOutputJarFile
File
baseName
String
return
File
destDir
baseName
genericJarSuffix
needToRebuild
boolean
ejbFiles
Hashtable
jarFile
File
if
exists
block
long
lastBuild
lastModified
if
manifest
exists
lastModified
lastBuild
block
log
manifest
MSG_VERBOSE
return
Iterator
fileIter
values
iterator
while
hasNext
block
File
currentFile
File
next
if
lastBuild
lastModified
block
log
getPath
MSG_VERBOSE
return
return
return
getPublicId
String
return
getPublicId
writeJar
baseName
String
jarfile
File
files
Hashtable
publicId
String
JarOutputStream
jarStream
try
addedfiles
ArrayList
if
exists
block
delete
getParentFile
mkdirs
createNewFile
InputStream
in
Manifest
manifest
try
if
manifest
block
in
FileInputStream
manifest
if
in
block
throw
BuildException
manifest
getLocation
block
String
defaultManifest
in
getClass
getResourceAsStream
defaultManifest
if
in
block
throw
BuildException
defaultManifest
getLocation
manifest
Manifest
in
catchClause
e
throw
BuildException
e
getLocation
if
in
block
close
jarStream
JarOutputStream
FileOutputStream
jarfile
manifest
setMethod
DEFLATED
for
forControl
Iterator
entryIterator
keySet
iterator
hasNext
block
String
entryName
String
next
File
entryFile
File
get
entryName
log
entryName
MSG_VERBOSE
addFileToJar
jarStream
entryFile
entryName
InnerClassFilenameFilter
flt
InnerClassFilenameFilter
getName
File
entryDir
getParentFile
String
innerfiles
list
flt
for
forControl
int
i
n
length
i
n
i
block
int
entryIndex
lastIndexOf
getName
if
entryIndex
block
entryName
innerfiles
i
block
entryName
substring
entryIndex
separatorChar
innerfiles
i
entryFile
File
srcDir
entryName
log
entryName
MSG_VERBOSE
addFileToJar
jarStream
entryFile
entryName
catchClause
ioe
String
msg
toString
getMessage
throw
BuildException
msg
ioe
if
jarStream
block
try
close
catchClause
closeException
checkAndAddInherited
checkEntries
Hashtable
Hashtable
copiedHash
Hashtable
clone
for
forControl
Iterator
entryIterator
keySet
iterator
hasNext
block
String
entryName
String
next
File
entryFile
File
get
entryName
if
endsWith
block
String
classname
substring
replace
separatorChar
lastIndexOf
ClassLoader
loader
getClassLoaderForBuild
try
Class
c
loadClass
classname
if
isPrimitive
block
if
isInterface
block
log
getName
MSG_VERBOSE
Class
interfaces
getInterfaces
for
forControl
int
i
i
length
i
block
log
interfaces
i
getName
MSG_VERBOSE
addInterface
interfaces
i
checkEntries
block
log
getName
MSG_VERBOSE
Class
s
getSuperclass
addSuperClass
getSuperclass
checkEntries
catchClause
cnfe
log
classname
MSG_WARN
catchClause
ncdfe
log
classname
MSG_WARN
addInterface
theInterface
Class
checkEntries
Hashtable
if
getName
startsWith
block
File
interfaceFile
File
getAbsolutePath
separatorChar
getName
replace
separatorChar
if
exists
isFile
block
put
getName
replace
separatorChar
interfaceFile
Class
superInterfaces
getInterfaces
for
forControl
int
i
i
length
i
block
addInterface
superInterfaces
i
checkEntries
addSuperClass
superClass
Class
checkEntries
Hashtable
if
getName
startsWith
block
File
superClassFile
File
getAbsolutePath
separatorChar
getName
replace
separatorChar
if
exists
isFile
block
put
getName
replace
separatorChar
superClassFile
Class
superInterfaces
getInterfaces
for
forControl
int
i
i
length
i
block
addInterface
superInterfaces
i
checkEntries
addSuperClass
getSuperclass
checkEntries
getClassLoaderForBuild
ClassLoader
if
classpathLoader
block
return
classpathLoader
Path
combinedClasspath
getCombinedClasspath
if
combinedClasspath
block
classpathLoader
getClass
getClassLoader
block
classpathLoader
AntClassLoader
getTask
getProject
combinedClasspath
return
classpathLoader
validateConfigured
if
destDir
isDirectory
block
String
msg
throw
BuildException
msg
getLocation
EJBDeploymentTool
