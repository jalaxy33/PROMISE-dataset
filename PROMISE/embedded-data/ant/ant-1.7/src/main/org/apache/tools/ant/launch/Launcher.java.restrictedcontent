Launcher
String
ANTHOME_PROPERTY
String
ANTLIBDIR_PROPERTY
String
ANT_PRIVATEDIR
String
ANT_PRIVATELIB
String
USER_LIBDIR
ANT_PRIVATEDIR
separatorChar
ANT_PRIVATELIB
String
MAIN_CLASS
String
USER_HOMEDIR
String
JAVA_CLASS_PATH
int
EXIT_CODE_ERROR
main
args
String
int
exitCode
try
Launcher
launcher
Launcher
exitCode
run
args
catchClause
e
exitCode
EXIT_CODE_ERROR
println
getMessage
catchClause
t
exitCode
EXIT_CODE_ERROR
printStackTrace
err
if
exitCode
block
exit
exitCode
addPath
path
String
getJars
boolean
libPathURLs
List
StringTokenizer
tokenizer
StringTokenizer
path
pathSeparator
while
hasMoreElements
block
String
elementName
nextToken
File
element
File
elementName
if
indexOf
exists
block
continue
if
getJars
isDirectory
block
URL
dirURLs
getLocationURLs
element
for
forControl
int
j
j
length
j
block
add
dirURLs
j
add
fileToURL
element
run
int
args
String
String
antHomeProperty
getProperty
ANTHOME_PROPERTY
File
antHome
File
sourceJar
getClassSource
getClass
File
jarDir
getParentFile
String
mainClassname
MAIN_CLASS
if
antHomeProperty
block
antHome
File
antHomeProperty
if
antHome
exists
block
antHome
getParentFile
setProperty
ANTHOME_PROPERTY
getAbsolutePath
if
exists
block
throw
LaunchException
List
libPaths
ArrayList
String
cpString
List
argList
ArrayList
String
newArgs
boolean
noUserLib
boolean
noClassPath
for
forControl
int
i
i
length
i
block
if
args
i
equals
block
if
i
length
block
throw
LaunchException
add
args
i
if
args
i
equals
block
if
i
length
block
throw
LaunchException
if
cpString
block
throw
LaunchException
cpString
args
i
if
args
i
equals
args
i
equals
block
noUserLib
if
args
i
equals
args
i
equals
block
noClassPath
if
args
i
equals
block
if
i
length
block
throw
LaunchException
mainClassname
args
i
block
add
args
i
if
size
length
block
newArgs
args
block
newArgs
String
toArray
String
size
URL
libURLs
getLibPathURLs
noClassPath
cpString
libPaths
URL
systemURLs
getSystemURLs
jarDir
URL
userURLs
noUserLib
URL
getUserURLs
URL
jars
getJarArray
libURLs
userURLs
systemURLs
getToolsJar
StringBuffer
baseClassPath
StringBuffer
getProperty
JAVA_CLASS_PATH
if
charAt
length
pathSeparatorChar
block
setLength
length
for
forControl
int
i
i
length
i
block
append
pathSeparatorChar
append
fromURI
jars
i
toString
setProperty
JAVA_CLASS_PATH
toString
URLClassLoader
loader
URLClassLoader
jars
currentThread
setContextClassLoader
loader
Class
mainClass
int
exitCode
try
mainClass
loadClass
mainClassname
AntMain
main
AntMain
newInstance
startAnt
newArgs
catchClause
ex
println
mainClassname
File
mainJar
getClassSource
mainClass
println
mainJar
exitCode
EXIT_CODE_ERROR
catchClause
t
printStackTrace
err
exitCode
EXIT_CODE_ERROR
return
exitCode
getLibPathURLs
URL
cpString
String
libPaths
List
List
libPathURLs
ArrayList
if
cpString
block
addPath
cpString
libPathURLs
for
forControl
Iterator
i
iterator
hasNext
block
String
libPath
String
next
addPath
libPath
libPathURLs
return
URL
toArray
URL
size
getSystemURLs
URL
antLauncherDir
File
File
antLibDir
String
antLibDirProperty
getProperty
ANTLIBDIR_PROPERTY
if
antLibDirProperty
block
antLibDir
File
antLibDirProperty
if
antLibDir
exists
block
antLibDir
antLauncherDir
setProperty
ANTLIBDIR_PROPERTY
getAbsolutePath
return
getLocationURLs
antLibDir
getUserURLs
URL
File
userLibDir
File
getProperty
USER_HOMEDIR
USER_LIBDIR
return
getLocationURLs
userLibDir
getJarArray
URL
libJars
URL
userJars
URL
systemJars
URL
toolsJar
File
int
numJars
length
length
length
if
toolsJar
block
numJars
URL
jars
URL
numJars
arraycopy
libJars
jars
length
arraycopy
userJars
jars
length
length
arraycopy
systemJars
jars
length
length
length
if
toolsJar
block
jars
length
fileToURL
toolsJar
return
jars
