BaseCipher
CipherInformation
cipherInformation
KeyStoreInformation
keystoreInformation
Log
log
getLog
BaseCipher
Cipher
cipher
KeyStoreWrapper
keyStoreWrapper
Key
key
BaseCipher
cipherInformation
CipherInformation
keystoreInformation
KeyStoreInformation
cipherInformation
cipherInformation
keystoreInformation
keystoreInformation
if
keystoreInformation
TrustKeyStoreInformation
block
keyStoreWrapper
TrustKeyStoreWrapper
TrustKeyStoreWrapper
keyStoreWrapper
block
keyStoreWrapper
IdentityKeyStoreWrapper
IdentityKeyStoreInformation
identityKeyStore
IdentityKeyStoreInformation
keystoreInformation
SecretInformation
secretInformation
getKeyPasswordProvider
if
secretInformation
block
IdentityKeyStoreWrapper
keyStoreWrapper
init
BaseCipher
cipherInformation
CipherInformation
keyStoreWrapper
KeyStoreWrapper
keyStoreWrapper
keyStoreWrapper
cipherInformation
cipherInformation
init
BaseCipher
cipherInformation
CipherInformation
key
Key
key
key
cipherInformation
cipherInformation
init
init
String
algorithm
getAlgorithm
CipherOperationMode
opMode
getCipherOperationMode
if
key
block
key
getKey
opMode
if
isDebugEnabled
block
debug
algorithm
opMode
try
String
provider
getProvider
if
provider
equals
provider
block
try
cipher
getInstance
algorithm
trim
catchClause
e
throw
SecureVaultException
provider
log
block
cipher
getInstance
algorithm
if
opMode
ENCRYPT
block
init
ENCRYPT_MODE
key
if
opMode
DECRYPT
block
init
DECRYPT_MODE
key
block
throw
SecureVaultException
opMode
log
catchClause
e
throw
SecureVaultException
algorithm
opMode
e
log
catchClause
e
throw
SecureVaultException
algorithm
opMode
e
log
catchClause
e
throw
SecureVaultException
e
log
getCipherInformation
CipherInformation
return
cipherInformation
getKeyStoreInformation
KeyStoreInformation
return
keystoreInformation
getKey
Key
operationMode
CipherOperationMode
doCipherOperation
byte
inputStream
byte
InputStream
sourceStream
ByteArrayInputStream
inputStream
if
getInType
block
try
sourceStream
decode
sourceStream
getInType
catchClause
e
throw
SecureVaultException
e
log
ByteArrayOutputStream
baos
ByteArrayOutputStream
CipherOutputStream
out
CipherOutputStream
baos
cipher
byte
buffer
byte
int
length
try
while
length
read
buffer
block
write
buffer
length
catchClause
e
throw
SecureVaultException
e
log
try
close
flush
close
catchClause
ignored
if
getOutType
block
return
encode
baos
getOutType
block
return
toByteArray
encrypt
byte
plainText
byte
return
doCipherOperation
plainText
decrypt
byte
cipherText
byte
return
doCipherOperation
cipherText
EncryptionProvider
DecryptionProvider
