CipherTool
String
SOURCE_IN_LINED
String
SOURCE_FILE
String
PASSPHRASE
String
KEY_STORE
String
STORE_TYPE
String
STORE_PASS
String
KEY_PASS
String
ALIAS
String
KEY_FILE
String
ALGORITHM
String
OP_MODE
String
CIPHER_TYPE
String
TARGET_FILE
String
OUT_TYPE
String
IN_TYPE
String
TRUSTED
Log
log
getLog
CipherTool
CipherTool
main
args
String
Options
options
getOptions
CommandLineParser
parser
GnuParser
try
CommandLine
cmd
parse
options
args
CipherInformation
cipherInformation
getCipherInformation
cmd
String
source
getArgument
cmd
SOURCE_IN_LINED
assertEmpty
source
SOURCE_IN_LINED
Key
key
findKey
cmd
cipherInformation
boolean
isEncrypt
getCipherOperationMode
ENCRYPT
EncryptionProvider
encryptionProvider
DecryptionProvider
decryptionProvider
if
key
block
if
isEncrypt
block
encryptionProvider
createCipher
cipherInformation
key
block
decryptionProvider
createCipher
cipherInformation
key
block
boolean
isTrusted
isArgumentPresent
cmd
TRUSTED
KeyStoreWrapper
keyStoreWrapper
if
isTrusted
block
keyStoreWrapper
TrustKeyStoreWrapper
TrustKeyStoreWrapper
keyStoreWrapper
block
keyStoreWrapper
IdentityKeyStoreWrapper
String
keyPass
getArgument
cmd
KEY_PASS
assertEmpty
keyPass
KEY_PASS
IdentityKeyStoreWrapper
keyStoreWrapper
if
isEncrypt
block
encryptionProvider
createCipher
cipherInformation
keyStoreWrapper
block
decryptionProvider
createCipher
cipherInformation
keyStoreWrapper
PrintStream
out
out
if
isEncrypt
block
println
String
encrypt
getBytes
block
println
String
decrypt
getBytes
catchClause
e
handleException
e
getArgument
String
cmd
CommandLine
argName
String
defaultValue
String
if
cmd
block
handleException
if
argName
equals
argName
block
if
isDebugEnabled
block
debug
return
defaultValue
if
hasOption
argName
block
return
getOptionValue
argName
return
defaultValue
isArgumentPresent
boolean
cmd
CommandLine
argName
String
if
cmd
block
handleException
if
argName
equals
argName
block
if
isDebugEnabled
block
debug
return
return
hasOption
argName
getCipherInformation
CipherInformation
cmd
CommandLine
CipherInformation
information
CipherInformation
setAlgorithm
getArgument
cmd
ALGORITHM
DEFAULT_ALGORITHM
setCipherOperationMode
valueOf
getArgument
toUpperCase
cmd
OP_MODE
toString
String
encInType
getArgument
cmd
IN_TYPE
if
encInType
block
setInType
valueOf
toUpperCase
String
encOutType
getArgument
cmd
OUT_TYPE
if
encOutType
block
setOutType
valueOf
toUpperCase
setType
getArgument
cmd
CIPHER_TYPE
return
information
getIdentityKeyStoreInformation
IdentityKeyStoreInformation
cmd
CommandLine
IdentityKeyStoreInformation
information
IdentityKeyStoreInformation
String
alias
getArgument
cmd
ALIAS
assertEmpty
alias
ALIAS
setAlias
alias
String
keyStore
getArgument
cmd
KEY_STORE
assertEmpty
keyStore
KEY_STORE
setLocation
keyStore
setStoreType
getArgument
cmd
STORE_TYPE
toString
String
storePass
getArgument
cmd
STORE_PASS
assertEmpty
storePass
STORE_PASS
SecretInformation
secretInformation
SecretInformation
setAliasSecret
storePass
setKeyStorePasswordProvider
secretInformation
return
information
getTrustKeyStoreInformation
TrustKeyStoreInformation
cmd
CommandLine
TrustKeyStoreInformation
information
TrustKeyStoreInformation
setAlias
getArgument
cmd
ALIAS
String
keyStore
getArgument
cmd
KEY_STORE
assertEmpty
keyStore
KEY_STORE
setLocation
keyStore
setStoreType
getArgument
cmd
STORE_TYPE
toString
String
storePass
getArgument
cmd
STORE_PASS
assertEmpty
storePass
STORE_PASS
SecretInformation
secretInformation
SecretInformation
setAliasSecret
storePass
setKeyStorePasswordProvider
secretInformation
return
information
getOptions
Options
Options
options
Options
Option
source
Option
SOURCE_IN_LINED
Option
sourceFile
Option
SOURCE_FILE
Option
passphrase
Option
PASSPHRASE
Option
keyStore
Option
KEY_STORE
Option
storeType
Option
STORE_TYPE
Option
storePassword
Option
STORE_PASS
Option
keyPassword
Option
KEY_PASS
Option
alias
Option
ALIAS
Option
trusted
Option
TRUSTED
Option
keyFile
Option
KEY_FILE
Option
cipherType
Option
CIPHER_TYPE
Option
opMode
Option
OP_MODE
Option
algorithm
Option
ALGORITHM
Option
targetFile
Option
TARGET_FILE
Option
outType
Option
OUT_TYPE
Option
intType
Option
IN_TYPE
addOption
source
addOption
sourceFile
addOption
passphrase
addOption
keyStore
addOption
storeType
addOption
storePassword
addOption
keyPassword
addOption
alias
addOption
trusted
addOption
keyFile
addOption
algorithm
addOption
cipherType
addOption
opMode
addOption
targetFile
addOption
outType
addOption
intType
return
options
getKey
Key
filePath
String
if
filePath
equals
filePath
block
handleException
File
keyFile
File
filePath
if
exists
block
handleException
filePath
ObjectInputStream
in
try
in
ObjectInputStream
FileInputStream
keyFile
Object
object
readObject
if
object
Key
block
return
Key
object
catchClause
e
handleException
filePath
e
catchClause
e
handleException
filePath
e
if
in
block
try
close
catchClause
ignored
return
findKey
Key
cmd
CommandLine
cipherInformation
CipherInformation
String
passPhrase
getArgument
cmd
PASSPHRASE
Key
key
if
passPhrase
block
key
SecretKeySpec
getBytes
getAlgorithm
block
String
keyFile
getArgument
cmd
KEY_FILE
if
keyFile
block
key
getKey
keyFile
return
key
handleException
msg
String
e
Exception
error
msg
e
throw
SecureVaultException
msg
e
handleException
msg
String
error
msg
throw
SecureVaultException
msg
assertEmpty
value
String
key
String
if
value
equals
value
block
handleException
key
