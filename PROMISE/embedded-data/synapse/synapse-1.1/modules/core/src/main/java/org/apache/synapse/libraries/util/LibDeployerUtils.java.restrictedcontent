LibDeployerUtils
String
APP_UNZIP_DIR
String
javaTempDir
getProperty
APP_UNZIP_DIR
endsWith
separator
javaTempDir
SYNAPSE_LIBS
javaTempDir
separator
SYNAPSE_LIBS
createDir
APP_UNZIP_DIR
Log
log
getLog
LibDeployerUtils
createSynapseLibrary
Library
libPath
String
createDir
APP_UNZIP_DIR
String
libFilePath
formatPath
libPath
String
extractPath
extractSynapseLib
libFilePath
SynapseLibrary
synapseLib
populateDependencies
extractPath
ARTIFACTS_XML
try
ClassLoader
libLoader
getClassLoader
getClassLoader
LibDeployerUtils
extractPath
setLibClassLoader
libLoader
catchClause
e
throw
SynapseArtifactDeploymentException
libFilePath
e
searchAndResolveDependencies
extractPath
synapseLib
return
synapseLib
populateDependencies
SynapseLibrary
libXmlPath
String
File
f
File
libXmlPath
if
exists
block
throw
SynapseException
libXmlPath
InputStream
xmlInputStream
try
xmlInputStream
FileInputStream
f
OMElement
documentElement
createOMBuilder
getDocumentElement
xmlInputStream
if
documentElement
block
throw
SynapseArtifactDeploymentException
Iterator
artifactItr
getChildrenWithLocalName
ARTIFACT
SynapseLibrary
mainSynLibArtifact
mainSynLibArtifact
createSynapseLibraryWithDeps
OMElement
next
if
mainSynLibArtifact
block
throw
SynapseArtifactDeploymentException
return
mainSynLibArtifact
catchClause
e
throw
SynapseArtifactDeploymentException
libXmlPath
e
catchClause
e
throw
SynapseArtifactDeploymentException
e
if
xmlInputStream
block
try
close
catchClause
e
error
e
createSynapseLibraryWithDeps
SynapseLibrary
artifactEle
OMElement
if
artifactEle
block
return
SynapseLibrary
synLib
SynapseLibrary
readAttribute
artifactEle
NAME
readAttribute
artifactEle
PACKAGE_ATTR
setDescription
readChildText
artifactEle
DESCRIPTION_ELEMENT
Iterator
itr
getChildrenWithLocalName
DEPENDENCY
while
hasNext
block
OMElement
depElement
OMElement
next
LibraryArtifact
Dependency
dep
LibraryArtifact
Dependency
readAttribute
depElement
ARTIFACT
addDependency
dep
return
synLib
searchAndResolveDependencies
rootDirPath
String
library
SynapseLibrary
List
LibraryArtifact
libraryArtifacts
ArrayList
LibraryArtifact
File
extractedDir
File
rootDirPath
File
allFiles
listFiles
if
allFiles
block
return
for
File
artifactDirectory
allFiles
block
if
isDirectory
block
continue
String
directoryPath
formatPath
getAbsolutePath
String
artifactXmlPath
directoryPath
separator
ARTIFACT_XML
File
f
File
artifactXmlPath
if
exists
block
continue
LibraryArtifact
artifact
InputStream
xmlInputStream
try
xmlInputStream
FileInputStream
f
artifact
buildArtifact
library
xmlInputStream
directoryPath
catchClause
e
warn
getName
artifactXmlPath
e
catchClause
e
warn
getName
artifactXmlPath
e
if
xmlInputStream
block
try
close
catchClause
e
error
e
if
artifact
block
warn
directoryPath
getQName
continue
add
artifact
boolean
isDepsResolved
resolveDependencies
libraryArtifacts
if
isDepsResolved
block
throw
SynapseArtifactDeploymentException
toString
buildArtifact
LibraryArtifact
library
SynapseLibrary
artifactXmlStream
InputStream
directoryPath
String
LibraryArtifact
artifact
try
OMElement
artElement
createOMBuilder
getDocumentElement
artifactXmlStream
if
equals
getLocalName
block
artifact
populateLibraryArtifact
artElement
directoryPath
library
block
error
getQName
return
catchClause
e
throw
SynapseArtifactDeploymentException
directoryPath
e
if
artifact
getName
block
error
getQName
return
return
artifact
populateLibraryArtifact
LibraryArtifact
artifactEle
OMElement
artifactPath
String
parent
LibraryArtifact
library
SynapseLibrary
if
artifactEle
artifactPath
block
return
LibraryArtifact
artifact
LibraryArtifact
readAttribute
artifactEle
NAME
setParent
parent
setType
readAttribute
artifactEle
TYPE
setPath
artifactPath
setDescription
readChildText
artifactEle
DESCRIPTION_ELEMENT
addArtifactDescription
artifact
OMElement
subArtifactsElement
getFirstChildWithName
QName
SUB_ARTIFACTS
if
subArtifactsElement
block
Iterator
subArtItr
getChildrenWithLocalName
ARTIFACT
while
hasNext
block
LibraryArtifact
subArtifact
populateLibraryArtifact
OMElement
next
artifactPath
artifact
library
addSubArtifact
subArtifact
Iterator
fileItr
getChildrenWithLocalName
FILE
while
hasNext
block
OMElement
fileElement
OMElement
next
setupFile
getText
return
artifact
loadLibArtifacts
synImport
SynapseImport
library
Library
if
getLibName
equals
getQName
getLocalPart
getLibPackage
equals
getPackage
block
loadLibrary
getLibArtifact
T
librarySet
Map
String
Library
key
String
type
Class
T
for
Library
synapseLibrary
values
block
try
T
artifact
T
getArtifact
key
if
artifact
block
return
artifact
catchClause
e
return
getQualifiedName
String
synImport
SynapseImport
return
toString
QName
getLibPackage
getLibName
readAttribute
String
element
OMElement
attName
String
if
element
block
return
OMAttribute
temp
getAttribute
QName
attName
if
temp
block
return
getAttributeValue
return
readChildText
String
element
OMElement
ln
String
return
readChildText
element
ln
readChildText
String
element
OMElement
ln
String
ns
String
if
element
block
return
OMElement
temp
getFirstChildWithName
QName
ns
ln
if
temp
block
return
getText
return
extractSynapseLib
String
libPath
String
libPath
formatPath
libPath
String
fileName
substring
lastIndexOf
String
dest
APP_UNZIP_DIR
separator
currentTimeMillis
fileName
separator
createDir
dest
try
extract
libPath
dest
catchClause
e
throw
SynapseException
fileName
e
return
dest
formatPath
String
path
String
path
replaceAll
return
replace
extract
sourcePath
String
destPath
String
Enumeration
entries
ZipFile
zipFile
zipFile
ZipFile
sourcePath
entries
entries
while
hasMoreElements
block
ZipEntry
entry
ZipEntry
nextElement
if
getName
startsWith
block
continue
if
isDirectory
block
continue
File
dest
File
destPath
getName
getParentFile
mkdirs
copyInputStream
getInputStream
entry
BufferedOutputStream
FileOutputStream
dest
close
createDir
path
String
File
temp
File
path
if
exists
mkdir
block
error
path
copyInputStream
in
InputStream
out
OutputStream
byte
buffer
byte
int
len
while
len
read
buffer
block
write
buffer
len
close
close
main
args
String
resolveDependencies
SynapseLibrary
