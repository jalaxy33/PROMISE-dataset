WeightedRoundRobin
Log
log
getLog
WeightedRoundRobin
EndpointState
endpointStates
List
Endpoint
endpoints
Endpoint
loadBalanceEndpoint
int
endpointCursor
int
DEFAULT_WEIGHT
String
LOADBALANCE_WEIGHT
String
LOADBALANCE_ThEADLOCAL
boolean
isThreadLocal
AlgorithmThreadLocal
threadedAlgorithm
ReadWriteLock
lock
ReentrantReadWriteLock
WeightedRoundRobinViewMBean
view
setApplicationMembers
members
List
Member
throw
UnsupportedOperationException
setEndpoints
endpoints
List
Endpoint
endpoints
endpoints
setLoadBalanceEndpoint
endpoint
Endpoint
loadBalanceEndpoint
endpoint
getNextEndpoint
Endpoint
synapseMessageContext
MessageContext
algorithmContext
AlgorithmContext
Lock
readLock
readLock
lock
try
if
isThreadLocal
block
synchronized
EndpointState
state
endpointStates
endpointCursor
if
getCurrentWeight
block
reset
if
endpointCursor
length
block
endpointCursor
block
endpointCursor
state
endpointStates
endpointCursor
decrementCurrentWeight
return
get
getEndpointPosition
block
if
threadedAlgorithm
block
Algorithm
algo
get
int
position
getNextEndpoint
return
get
position
block
String
msg
error
msg
throw
SynapseException
msg
unlock
getNextApplicationMember
Member
algorithmContext
AlgorithmContext
throw
UnsupportedOperationException
reset
algorithmContext
AlgorithmContext
for
EndpointState
state
endpointStates
block
reset
endpointCursor
getName
String
return
getName
WeightedRoundRobin
clone
LoadbalanceAlgorithm
return
init
se
SynapseEnvironment
if
endpoints
block
String
msg
error
msg
throw
SynapseException
msg
endpointStates
EndpointState
size
for
forControl
int
i
i
size
i
block
Endpoint
endpoint
get
i
if
endpoint
PropertyInclude
block
EndpointState
state
EndpointState
i
DEFAULT_WEIGHT
endpointStates
i
state
block
MediatorProperty
property
PropertyInclude
endpoint
EndpointState
state
if
property
block
int
weight
parseInt
getValue
if
weight
block
String
msg
error
msg
throw
SynapseException
msg
state
EndpointState
i
weight
block
state
EndpointState
i
DEFAULT_WEIGHT
endpointStates
i
state
if
loadBalanceEndpoint
PropertyInclude
block
MediatorProperty
threadLocalProperty
PropertyInclude
loadBalanceEndpoint
if
threadLocalProperty
getValue
equals
block
isThreadLocal
view
WeightedRoundRobinView
getInstance
registerMBean
view
getName
getName
destroy
AlgorithmThreadLocal
initialValue
Algorithm
return
Algorithm
endpointStates
ThreadLocal
Algorithm
Algorithm
EndpointState
threadLocalEndpointStates
int
threadLocalEndpointCursor
Algorithm
states
EndpointState
threadLocalEndpointStates
EndpointState
length
for
forControl
int
i
i
length
i
block
threadLocalEndpointStates
i
EndpointState
states
i
getEndpointPosition
states
i
getWeight
getNextEndpoint
int
EndpointState
state
threadLocalEndpointStates
threadLocalEndpointCursor
if
getCurrentWeight
block
reset
if
threadLocalEndpointCursor
length
block
threadLocalEndpointCursor
block
threadLocalEndpointCursor
state
threadLocalEndpointStates
threadLocalEndpointCursor
decrementCurrentWeight
return
getEndpointPosition
EndpointState
int
endpointPosition
int
weight
int
currentWeight
EndpointState
endpointPosition
int
weight
int
endpointPosition
endpointPosition
weight
weight
currentWeight
weight
getEndpointPosition
int
return
endpointPosition
getWeight
int
return
weight
getCurrentWeight
int
return
currentWeight
decrementCurrentWeight
currentWeight
reset
currentWeight
weight
calculate
sort
endpointStates
Comparator
EndpointState
compare
int
o1
EndpointState
o2
EndpointState
return
getWeight
getWeight
changeWeight
pos
int
weight
int
Lock
writeLock
writeLock
lock
try
EndpointState
state
for
EndpointState
s
endpointStates
block
if
getEndpointPosition
pos
block
state
s
if
state
block
throw
SynapseException
weight
weight
calculate
reset
unlock
getCurrentWeights
int
int
weights
int
length
for
forControl
int
i
i
length
i
block
weights
i
for
EndpointState
state
endpointStates
block
if
getEndpointPosition
length
getEndpointPosition
block
weights
getEndpointPosition
getWeight
return
weights
LoadbalanceAlgorithm
ManagedLifecycle
