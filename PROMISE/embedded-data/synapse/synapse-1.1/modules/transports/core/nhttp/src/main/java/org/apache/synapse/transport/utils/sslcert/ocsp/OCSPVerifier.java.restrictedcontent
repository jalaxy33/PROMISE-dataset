OCSPVerifier
Log
log
getLog
OCSPVerifier
OCSPCache
cache
OCSPVerifier
cache
OCSPCache
cache
cache
checkRevocationStatus
RevocationStatus
peerCert
X509Certificate
issuerCert
X509Certificate
if
cache
block
SingleResp
resp
getCacheValue
getSerialNumber
if
resp
block
RevocationStatus
status
getRevocationStatus
resp
debug
return
status
OCSPReq
request
generateOCSPRequest
issuerCert
getSerialNumber
List
String
locations
getAIALocations
peerCert
for
String
serviceUrl
locations
block
SingleResp
responses
try
OCSPResp
ocspResponse
getOCSPResponse
serviceUrl
request
if
SUCCESSFUL
getStatus
block
continue
BasicOCSPResp
basicResponse
BasicOCSPResp
getResponseObject
responses
basicResponse
getResponses
catchClause
e
continue
if
responses
length
block
SingleResp
resp
responses
RevocationStatus
status
getRevocationStatus
resp
if
cache
setCacheValue
getSerialNumber
resp
request
serviceUrl
return
status
throw
CertificateVerificationException
getRevocationStatus
RevocationStatus
resp
SingleResp
Object
status
getCertStatus
if
status
GOOD
block
return
GOOD
if
status
org
bouncycastle
ocsp
RevokedStatus
block
return
REVOKED
if
status
org
bouncycastle
ocsp
UnknownStatus
block
return
UNKNOWN
throw
CertificateVerificationException
getOCSPResponse
OCSPResp
serviceUrl
String
request
OCSPReq
try
byte
array
getEncoded
if
startsWith
block
HttpURLConnection
con
URL
url
URL
serviceUrl
con
HttpURLConnection
openConnection
setRequestProperty
setRequestProperty
setDoOutput
OutputStream
out
getOutputStream
DataOutputStream
dataOut
DataOutputStream
BufferedOutputStream
out
write
array
flush
close
if
getResponseCode
block
throw
CertificateVerificationException
getResponseCode
InputStream
in
InputStream
getContent
return
OCSPResp
in
block
throw
CertificateVerificationException
catchClause
e
throw
CertificateVerificationException
serviceUrl
e
generateOCSPRequest
OCSPReq
issuerCert
X509Certificate
serialNumber
BigInteger
addProvider
org
bouncycastle
jce
provider
BouncyCastleProvider
try
CertificateID
id
CertificateID
HASH_SHA1
issuerCert
serialNumber
OCSPReqGenerator
generator
OCSPReqGenerator
addRequest
id
BigInteger
nonce
valueOf
currentTimeMillis
Vector
ASN1ObjectIdentifier
objectIdentifiers
Vector
ASN1ObjectIdentifier
Vector
X509Extension
values
Vector
X509Extension
add
id_pkix_ocsp_nonce
add
X509Extension
DEROctetString
toByteArray
setRequestExtensions
X509Extensions
objectIdentifiers
values
return
generate
catchClause
e
throw
CertificateVerificationException
e
getAIALocations
List
String
cert
X509Certificate
byte
aiaExtensionValue
getExtensionValue
getId
if
aiaExtensionValue
block
throw
CertificateVerificationException
ASN1InputStream
asn1In
ASN1InputStream
aiaExtensionValue
AuthorityInformationAccess
authorityInformationAccess
try
DEROctetString
aiaDEROctetString
DEROctetString
readObject
ASN1InputStream
asn1InOctets
ASN1InputStream
getOctets
ASN1Sequence
aiaASN1Sequence
ASN1Sequence
readObject
authorityInformationAccess
getInstance
aiaASN1Sequence
catchClause
e
throw
CertificateVerificationException
e
List
String
ocspUrlList
ArrayList
String
AccessDescription
accessDescriptions
getAccessDescriptions
for
AccessDescription
accessDescription
accessDescriptions
block
GeneralName
gn
getAccessLocation
if
getTagNo
uniformResourceIdentifier
block
DERIA5String
str
getInstance
getName
String
accessLocation
getString
add
accessLocation
if
isEmpty
block
throw
CertificateVerificationException
return
ocspUrlList
RevocationVerifier
