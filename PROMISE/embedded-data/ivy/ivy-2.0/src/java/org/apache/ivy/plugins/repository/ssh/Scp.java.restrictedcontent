Scp
int
MODE_LENGTH
int
SEND_FILE_BUFFER_LENGTH
int
SEND_BYTES_BUFFER_LENGTH
int
MIN_TLINE_LENGTH
int
CLINE_SPACE_INDEX2
int
CLINE_SPACE_INDEX1
int
MIN_C_LINE_LENGTH
int
DEFAULT_LINE_BUFFER_LENGTH
int
BUFFER_SIZE
int
MAX_SCP_LINE_LENGTH
Session
session
FileInfo
String
filename
long
length
long
lastModified
setFilename
filename
String
filename
filename
getFilename
String
return
filename
setLength
length
long
length
length
getLength
long
return
length
setLastModified
lastModified
long
lastModified
lastModified
getLastModified
long
return
lastModified
Scp
session
Session
if
session
block
throw
IllegalArgumentException
session
session
readResponse
is
InputStream
int
c
read
if
c
block
return
if
c
block
throw
RemoteScpException
if
c
c
block
throw
RemoteScpException
if
c
block
throw
RemoteScpException
String
err
receiveLine
is
throw
RemoteScpException
err
receiveLine
String
is
InputStream
StringBuffer
sb
StringBuffer
DEFAULT_LINE_BUFFER_LENGTH
while
block
if
length
MAX_SCP_LINE_LENGTH
block
throw
RemoteScpException
int
c
read
if
c
block
throw
RemoteScpException
if
c
block
break
append
char
c
return
toString
parseCLine
line
String
fileInfo
FileInfo
long
len
if
length
MIN_C_LINE_LENGTH
block
throw
RemoteScpException
if
charAt
CLINE_SPACE_INDEX1
charAt
CLINE_SPACE_INDEX2
block
throw
RemoteScpException
int
lengthNameSep
indexOf
CLINE_SPACE_INDEX2
if
lengthNameSep
block
throw
RemoteScpException
String
lengthSubstring
substring
CLINE_SPACE_INDEX2
lengthNameSep
String
nameSubstring
substring
lengthNameSep
if
length
length
block
throw
RemoteScpException
if
CLINE_SPACE_INDEX2
length
length
length
block
throw
RemoteScpException
try
len
parseLong
lengthSubstring
catchClause
e
throw
RemoteScpException
if
len
block
throw
RemoteScpException
setLength
len
setFilename
nameSubstring
parseTLine
line
String
fileInfo
FileInfo
long
modtime
long
firstMsec
long
atime
long
secondMsec
if
length
MIN_TLINE_LENGTH
block
throw
RemoteScpException
int
firstMsecBegin
indexOf
if
firstMsecBegin
firstMsecBegin
length
block
throw
RemoteScpException
int
atimeBegin
indexOf
firstMsecBegin
if
atimeBegin
atimeBegin
length
block
throw
RemoteScpException
int
secondMsecBegin
indexOf
atimeBegin
if
secondMsecBegin
secondMsecBegin
length
block
throw
RemoteScpException
try
modtime
parseLong
substring
firstMsecBegin
firstMsec
parseLong
substring
firstMsecBegin
atimeBegin
atime
parseLong
substring
atimeBegin
secondMsecBegin
secondMsec
parseLong
substring
secondMsecBegin
catchClause
e
throw
RemoteScpException
if
modtime
firstMsec
atime
secondMsec
block
throw
RemoteScpException
setLastModified
modtime
sendFile
channel
Channel
localFile
String
remoteName
String
mode
String
byte
buffer
byte
BUFFER_SIZE
OutputStream
os
BufferedOutputStream
getOutputStream
SEND_FILE_BUFFER_LENGTH
InputStream
is
BufferedInputStream
getInputStream
SEND_BYTES_BUFFER_LENGTH
try
if
isConnected
block
start
block
connect
catchClause
e1
throw
IOException
initCause
e1
IOException
readResponse
is
File
f
File
localFile
long
remain
length
String
cMode
mode
if
cMode
block
cMode
String
cline
cMode
remain
remoteName
write
getBytes
flush
readResponse
is
FileInputStream
fis
try
fis
FileInputStream
f
while
remain
block
int
trans
if
remain
length
block
trans
length
block
trans
int
remain
if
read
buffer
trans
trans
block
throw
IOException
localFile
write
buffer
trans
remain
trans
close
catchClause
e
if
fis
block
close
throw
e
write
flush
readResponse
is
write
getBytes
flush
receiveStream
FileInfo
channel
Channel
file
String
targetStream
OutputStream
byte
buffer
byte
BUFFER_SIZE
OutputStream
os
getOutputStream
InputStream
is
getInputStream
try
if
isConnected
block
start
block
connect
catchClause
e1
throw
IOException
initCause
e1
IOException
write
flush
FileInfo
fileInfo
FileInfo
while
block
int
c
read
if
c
block
throw
RemoteScpException
String
line
receiveLine
is
if
c
block
parseTLine
line
fileInfo
write
flush
continue
if
c
c
block
throw
RemoteScpException
line
if
c
block
parseCLine
line
fileInfo
break
throw
RemoteScpException
char
c
line
if
targetStream
block
write
flush
try
long
remain
getLength
while
remain
block
int
trans
if
remain
length
block
trans
length
block
trans
int
remain
int
thisTimeReceived
read
buffer
trans
if
thisTimeReceived
block
throw
IOException
write
buffer
thisTimeReceived
remain
thisTimeReceived
close
catchClause
e
if
targetStream
block
close
throw
e
readResponse
is
write
flush
return
fileInfo
getExecChannel
ChannelExec
ChannelExec
channel
channel
ChannelExec
openChannel
return
channel
put
localFile
String
remoteTargetDir
String
remoteTargetName
String
mode
String
ChannelExec
channel
if
localFile
remoteTargetName
block
throw
IllegalArgumentException
if
mode
block
if
length
MODE_LENGTH
block
throw
IllegalArgumentException
for
forControl
int
i
i
length
i
block
if
isDigit
charAt
i
block
throw
IllegalArgumentException
String
cmd
if
mode
block
cmd
cmd
if
remoteTargetDir
length
block
cmd
cmd
remoteTargetDir
try
channel
getExecChannel
setCommand
cmd
sendFile
channel
localFile
remoteTargetName
mode
disconnect
catchClause
e
if
channel
block
disconnect
throw
IOException
initCause
e
IOException
getMessage
get
remoteFile
String
localTarget
String
File
f
File
localTarget
FileOutputStream
fop
FileOutputStream
f
get
remoteFile
fop
get
remoteFile
String
localTarget
OutputStream
ChannelExec
channel
if
remoteFile
localTarget
block
throw
IllegalArgumentException
String
cmd
remoteFile
try
channel
getExecChannel
setCommand
cmd
receiveStream
channel
remoteFile
localTarget
disconnect
catchClause
e
if
channel
block
disconnect
throw
IOException
initCause
e
IOException
getMessage
getFileinfo
FileInfo
remoteFile
String
ChannelExec
channel
FileInfo
fileInfo
if
remoteFile
block
throw
IllegalArgumentException
String
cmd
remoteFile
try
channel
getExecChannel
setCommand
cmd
fileInfo
receiveStream
channel
remoteFile
disconnect
catchClause
e
throw
IOException
initCause
e
IOException
getMessage
if
channel
block
disconnect
return
fileInfo
