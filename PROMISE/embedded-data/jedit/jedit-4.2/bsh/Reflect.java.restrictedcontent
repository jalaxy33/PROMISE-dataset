Reflect
invokeObjectMethod
Object
object
Object
methodName
String
args
Object
interpreter
Interpreter
callstack
CallStack
callerInfo
SimpleNode
if
object
This
isExposedThisMethod
methodName
return
This
object
block
try
BshClassManager
bcm
interpreter
getClassManager
Class
clas
getClass
Method
method
resolveExpectedJavaMethod
bcm
clas
object
methodName
args
return
invokeOnMethod
method
object
args
catchClause
e
throw
toEvalError
callerInfo
callstack
invokeStaticMethod
Object
bcm
BshClassManager
clas
Class
methodName
String
args
Object
debug
Method
method
resolveExpectedJavaMethod
bcm
clas
methodName
args
return
invokeOnMethod
method
args
invokeOnMethod
Object
method
Method
object
Object
args
Object
if
args
args
Object
if
DEBUG
block
debug
method
for
forControl
int
i
i
length
i
debug
i
args
i
args
i
getClass
Object
tmpArgs
Object
length
Class
types
getParameterTypes
try
for
forControl
int
i
i
length
i
tmpArgs
i
getAssignableForm
args
i
types
i
catchClause
e
throw
InterpreterError
e
tmpArgs
unwrap
tmpArgs
if
DEBUG
block
debug
method
for
forControl
int
i
i
length
i
debug
i
tmpArgs
i
tmpArgs
i
getClass
try
Object
returnValue
invoke
object
tmpArgs
if
returnValue
returnValue
NULL
Class
returnType
getReturnType
return
wrap
returnValue
returnType
catchClause
e
throw
ReflectError
methodString
getName
getParameterTypes
getDeclaringClass
e
getIndex
Object
array
Object
index
int
if
DEBUG
debug
array
index
try
Object
val
get
array
index
return
wrap
val
getClass
getComponentType
catchClause
e1
throw
UtilTargetError
e1
catchClause
e
throw
ReflectError
e
setIndex
array
Object
index
int
val
Object
try
val
unwrap
val
set
array
index
val
catchClause
e2
throw
UtilTargetError
e2
catchClause
e1
throw
UtilTargetError
ArrayStoreException
toString
catchClause
e
throw
ReflectError
e
getStaticField
Object
clas
Class
fieldName
String
return
getFieldValue
clas
fieldName
getObjectField
Object
object
Object
fieldName
String
if
object
This
return
This
object
block
try
return
getFieldValue
getClass
object
fieldName
catchClause
e
if
hasObjectPropertyGetter
getClass
fieldName
return
getObjectProperty
object
fieldName
throw
e
getLHSStaticField
LHS
clas
Class
fieldName
String
Field
f
resolveExpectedJavaField
clas
fieldName
return
LHS
f
getLHSObjectField
LHS
object
Object
fieldName
String
if
object
This
block
boolean
recurse
return
LHS
This
object
fieldName
recurse
try
Field
f
resolveExpectedJavaField
getClass
fieldName
return
LHS
object
f
catchClause
e
if
hasObjectPropertySetter
getClass
fieldName
return
LHS
object
fieldName
throw
e
getFieldValue
Object
clas
Class
object
Object
fieldName
String
onlyStatic
boolean
try
Field
f
resolveExpectedJavaField
clas
fieldName
onlyStatic
Object
value
get
object
Class
returnType
getType
return
wrap
value
returnType
catchClause
e
throw
ReflectError
fieldName
catchClause
e
throw
ReflectError
fieldName
resolveJavaField
Field
clas
Class
fieldName
String
onlyStatic
boolean
try
return
resolveExpectedJavaField
clas
fieldName
onlyStatic
catchClause
e
return
resolveExpectedJavaField
Field
clas
Class
fieldName
String
onlyStatic
boolean
Field
f
try
if
haveAccessibility
f
findAccessibleField
clas
fieldName
f
getField
fieldName
catchClause
e
throw
ReflectError
fieldName
if
onlyStatic
isStatic
getModifiers
throw
UtilEvalError
fieldName
getName
return
f
findAccessibleField
Field
clas
Class
fieldName
String
Field
field
try
field
getField
fieldName
RMSetAccessible
field
return
field
catchClause
e
while
clas
block
try
field
getDeclaredField
fieldName
RMSetAccessible
field
return
field
catchClause
e
clas
getSuperclass
throw
NoSuchFieldException
fieldName
resolveExpectedJavaMethod
Method
bcm
BshClassManager
clas
Class
object
Object
name
String
args
Object
onlyStatic
boolean
Method
method
resolveJavaMethod
bcm
clas
object
name
args
onlyStatic
if
method
return
method
Class
types
getTypes
args
throw
ReflectError
onlyStatic
methodString
name
types
getName
resolveJavaMethod
Method
bcm
BshClassManager
clas
Class
object
Object
name
String
args
Object
onlyStatic
boolean
if
object
NULL
throw
UtilTargetError
NullPointerException
name
Class
types
getTypes
args
return
resolveJavaMethod
bcm
clas
name
types
onlyStatic
resolveJavaMethod
Method
bcm
BshClassManager
clas
Class
name
String
types
Class
onlyStatic
boolean
if
clas
throw
InterpreterError
Method
method
if
bcm
debug
block
method
getResolvedMethod
clas
name
types
onlyStatic
if
method
return
method
if
DEBUG
debug
methodString
name
types
getName
try
method
findAccessibleMethod
clas
name
types
catchClause
e
if
method
length
block
Vector
mv
Vector
Class
c
clas
while
c
block
Method
m
getDeclaredMethods
for
forControl
int
i
i
length
i
add
m
i
c
getSuperclass
Method
methods
Method
size
copyInto
methods
boolean
publicOnly
haveAccessibility
method
findMostSpecificMethod
name
types
methods
publicOnly
if
method
isPublic
getModifiers
block
try
RMSetAccessible
method
catchClause
e
if
method
onlyStatic
isStatic
getModifiers
throw
UtilEvalError
methodString
getName
getParameterTypes
getName
if
method
bcm
cacheResolvedMethod
clas
types
method
return
method
findAccessibleMethod
Method
clas
Class
name
String
types
Class
Method
meth
Method
inaccessibleVersion
Vector
classQ
Vector
addElement
clas
Method
found
while
size
block
Class
c
Class
firstElement
removeElementAt
if
isPublic
getModifiers
haveAccessibility
block
try
meth
getDeclaredMethod
name
types
if
isPublic
getModifiers
isPublic
getModifiers
haveAccessibility
RMSetAccessible
meth
block
found
meth
break
block
inaccessibleVersion
meth
catchClause
e
if
isInterface
block
Class
superclass
getSuperclass
if
superclass
addElement
Object
superclass
Class
intfs
getInterfaces
for
forControl
int
i
i
length
i
addElement
Object
intfs
i
if
found
return
found
if
inaccessibleVersion
throw
UtilEvalError
inaccessibleVersion
return
constructObject
Object
clas
Class
args
Object
if
isInterface
throw
ReflectError
clas
Object
obj
Class
types
getTypes
args
Constructor
con
Constructor
constructors
getDeclaredConstructors
if
DEBUG
debug
clas
con
findMostSpecificConstructor
types
constructors
if
con
block
if
length
throw
ReflectError
clas
throw
ReflectError
methodString
getName
types
getName
if
isPublic
getModifiers
haveAccessibility
try
RMSetAccessible
con
catchClause
e
args
unwrap
args
try
obj
newInstance
args
catchClause
e
throw
ReflectError
catchClause
e
throw
ReflectError
catchClause
e
throw
ReflectError
if
obj
throw
ReflectError
return
obj
findMostSpecificMethod
Method
name
String
idealMatch
Class
methods
Method
publicOnly
boolean
Vector
sigs
Vector
Vector
meths
Vector
for
forControl
int
i
i
length
i
block
if
publicOnly
isPublic
methods
i
getModifiers
continue
if
methods
i
getName
equals
name
block
addElement
methods
i
addElement
methods
i
getParameterTypes
Class
candidates
Class
size
copyInto
candidates
if
DEBUG
debug
name
int
match
findMostSpecificSignature
idealMatch
candidates
if
match
return
return
Method
elementAt
match
findMostSpecificConstructor
Constructor
idealMatch
Class
constructors
Constructor
int
match
findMostSpecificConstructorIndex
idealMatch
constructors
if
match
return
return
constructors
match
findMostSpecificConstructorIndex
int
idealMatch
Class
constructors
Constructor
Class
candidates
Class
length
for
forControl
int
i
i
length
i
candidates
i
constructors
i
getParameterTypes
return
findMostSpecificSignature
idealMatch
candidates
findMostSpecificSignature
int
idealMatch
Class
candidates
Class
Class
bestMatch
int
bestMatchIndex
for
forControl
int
i
i
length
i
block
Class
targetMatch
candidates
i
if
isSignatureAssignable
idealMatch
targetMatch
bestMatch
isSignatureAssignable
targetMatch
bestMatch
block
bestMatch
targetMatch
bestMatchIndex
i
if
bestMatch
return
bestMatchIndex
return
accessorName
String
getorset
String
propName
String
return
getorset
valueOf
toUpperCase
charAt
substring
hasObjectPropertyGetter
boolean
clas
Class
propName
String
String
getterName
accessorName
propName
try
getMethod
getterName
Class
return
catchClause
e
getterName
accessorName
propName
try
Method
m
getMethod
getterName
Class
return
getReturnType
TYPE
catchClause
e
return
hasObjectPropertySetter
boolean
clas
Class
propName
String
String
setterName
accessorName
propName
Class
sig
Class
clas
Method
methods
getMethods
for
forControl
int
i
i
length
i
if
methods
i
getName
equals
setterName
return
return
getObjectProperty
Object
obj
Object
propName
String
Object
args
Object
debug
Method
method
Exception
e1
e2
try
String
accessorName
accessorName
propName
method
resolveExpectedJavaMethod
getClass
obj
accessorName
args
catchClause
e
e1
e
if
method
try
String
accessorName
accessorName
propName
method
resolveExpectedJavaMethod
getClass
obj
accessorName
args
if
getReturnType
TYPE
method
catchClause
e
e2
e
if
method
throw
ReflectError
e1
e2
e2
try
return
invokeOnMethod
method
obj
args
catchClause
e
throw
UtilEvalError
getTargetException
setObjectProperty
obj
Object
propName
String
value
Object
String
accessorName
accessorName
propName
Object
args
Object
value
debug
try
Method
method
resolveExpectedJavaMethod
getClass
obj
accessorName
args
invokeOnMethod
method
obj
args
catchClause
e
throw
UtilEvalError
getTargetException
normalizeClassName
String
type
Class
if
isArray
return
getName
StringBuffer
className
StringBuffer
try
append
getArrayBaseType
getName
type
for
forControl
int
i
i
getArrayDimensions
type
i
append
catchClause
e
return
toString
getArrayDimensions
int
arrayClass
Class
if
isArray
return
return
getName
lastIndexOf
getArrayBaseType
Class
arrayClass
Class
if
isArray
throw
ReflectError
return
getComponentType
invokeCompiledCommand
Object
commandClass
Class
args
Object
interpreter
Interpreter
callstack
CallStack
Object
invokeArgs
Object
length
invokeArgs
interpreter
invokeArgs
callstack
arraycopy
args
invokeArgs
length
BshClassManager
bcm
getClassManager
try
return
invokeStaticMethod
bcm
commandClass
invokeArgs
catchClause
e
throw
UtilEvalError
getTargetException
catchClause
e
throw
UtilEvalError
e
