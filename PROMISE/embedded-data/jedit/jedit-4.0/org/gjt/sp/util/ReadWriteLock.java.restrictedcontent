ReadWriteLock
readLock
if
activeReaders
allowRead
block
activeReaders
return
waitingReaders
while
allowRead
block
try
wait
catchClause
e
waitingReaders
log
ERROR
e
return
waitingReaders
activeReaders
addElement
currentThread
readUnlock
if
activeReaders
throw
InternalError
activeReaders
notifyAll
writeLock
if
writerThread
block
if
currentThread
writerThread
block
lockCount
return
if
allowWrite
block
claimWriteLock
return
waitingWriters
while
allowWrite
block
try
wait
catchClause
e
waitingWriters
log
ERROR
e
return
waitingWriters
claimWriteLock
writeUnlock
if
activeWriters
lockCount
throw
InternalError
if
currentThread
writerThread
throw
InternalError
if
lockCount
block
activeWriters
writerThread
notifyAll
isWriteLocked
boolean
return
activeWriters
int
activeReaders
int
activeWriters
int
waitingReaders
int
waitingWriters
Vector
readers
Vector
Thread
writerThread
int
lockCount
allowRead
boolean
return
currentThread
writerThread
waitingWriters
activeWriters
allowWrite
boolean
return
activeReaders
activeWriters
claimWriteLock
activeWriters
writerThread
currentThread
lockCount
