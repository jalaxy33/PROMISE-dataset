FoldVisibilityManager
FoldVisibilityManager
buffer
Buffer
offsetMgr
OffsetManager
textArea
JEditTextArea
buffer
buffer
offsetMgr
offsetMgr
textArea
textArea
isNarrowed
boolean
return
narrowed
getVirtualLineCount
int
return
getVirtualLineCount
index
isLineVisible
boolean
line
int
if
line
line
getLineCount
throw
ArrayIndexOutOfBoundsException
line
try
readLock
return
isLineVisible
line
index
readUnlock
getFirstVisibleLine
int
try
readLock
for
forControl
int
i
i
getLineCount
i
block
if
isLineVisible
i
index
return
i
readUnlock
return
getLastVisibleLine
int
try
readLock
for
forControl
int
i
getLineCount
i
i
block
if
isLineVisible
i
index
return
i
readUnlock
return
getNextVisibleLine
int
line
int
if
line
line
getLineCount
throw
ArrayIndexOutOfBoundsException
line
try
readLock
if
line
getLineCount
return
for
forControl
int
i
line
i
getLineCount
i
block
if
isLineVisible
i
index
return
i
return
readUnlock
getPrevVisibleLine
int
line
int
if
line
line
getLineCount
throw
ArrayIndexOutOfBoundsException
line
try
readLock
if
line
return
for
forControl
int
i
line
i
i
block
if
isLineVisible
i
index
return
i
return
readUnlock
physicalToVirtual
int
line
int
try
readLock
if
line
throw
ArrayIndexOutOfBoundsException
line
if
line
getLineCount
block
throw
ArrayIndexOutOfBoundsException
line
getLineCount
if
getVirtualLineCount
getLineCount
return
line
while
isLineVisible
line
index
line
line
if
line
isLineVisible
line
index
block
return
if
lastPhysical
line
block
if
lastVirtual
lastVirtual
getVirtualLineCount
index
block
throw
ArrayIndexOutOfBoundsException
lastVirtual
if
line
lastPhysical
lastPhysical
block
for
forControl
block
if
lastPhysical
line
break
if
isLineVisible
lastPhysical
index
lastVirtual
if
lastPhysical
getLineCount
break
lastPhysical
if
lastVirtual
lastVirtual
getVirtualLineCount
index
block
throw
ArrayIndexOutOfBoundsException
lastVirtual
if
line
lastPhysical
lastPhysical
line
line
block
for
forControl
block
if
lastPhysical
line
break
if
isLineVisible
lastPhysical
index
lastVirtual
if
lastPhysical
break
lastPhysical
if
lastVirtual
lastVirtual
getVirtualLineCount
index
block
throw
ArrayIndexOutOfBoundsException
lastVirtual
block
lastPhysical
while
isLineVisible
lastPhysical
index
lastPhysical
lastVirtual
for
forControl
block
if
lastPhysical
line
break
if
isLineVisible
lastPhysical
index
lastVirtual
if
lastPhysical
getLineCount
break
lastPhysical
if
lastVirtual
lastVirtual
getVirtualLineCount
index
block
throw
ArrayIndexOutOfBoundsException
lastVirtual
return
lastVirtual
readUnlock
virtualToPhysical
int
line
int
try
readLock
if
line
throw
ArrayIndexOutOfBoundsException
line
if
line
getVirtualLineCount
index
block
throw
ArrayIndexOutOfBoundsException
line
getVirtualLineCount
index
if
getVirtualLineCount
getLineCount
return
line
if
lastVirtual
line
block
if
lastPhysical
lastPhysical
getLineCount
block
throw
ArrayIndexOutOfBoundsException
lastPhysical
if
line
lastVirtual
lastVirtual
block
for
forControl
block
if
isLineVisible
lastPhysical
index
block
if
lastVirtual
line
break
lastVirtual
if
lastPhysical
getLineCount
break
lastPhysical
if
lastPhysical
lastPhysical
getLineCount
block
throw
ArrayIndexOutOfBoundsException
lastPhysical
if
line
lastVirtual
lastVirtual
line
line
block
for
forControl
block
if
isLineVisible
lastPhysical
index
block
if
lastVirtual
line
break
lastVirtual
if
lastPhysical
break
lastPhysical
if
lastPhysical
lastPhysical
getLineCount
block
throw
ArrayIndexOutOfBoundsException
lastPhysical
block
lastPhysical
while
isLineVisible
lastPhysical
index
lastPhysical
lastVirtual
for
forControl
block
if
isLineVisible
lastPhysical
index
block
if
lastVirtual
line
break
lastVirtual
if
lastPhysical
getLineCount
break
lastPhysical
if
lastPhysical
lastPhysical
getLineCount
block
throw
ArrayIndexOutOfBoundsException
lastPhysical
return
lastPhysical
readUnlock
collapseFold
line
int
int
lineCount
getLineCount
int
start
int
end
lineCount
try
writeLock
if
line
line
getLineCount
isFoldStart
line
isLineVisible
line
index
block
line
int
initialFoldLevel
getFoldLevel
line
if
line
lineCount
getFoldLevel
line
initialFoldLevel
block
start
line
for
forControl
int
i
line
i
lineCount
i
block
if
getFoldLevel
i
initialFoldLevel
block
end
i
break
block
boolean
ok
for
forControl
int
i
line
i
i
block
if
getFoldLevel
i
initialFoldLevel
block
start
i
ok
break
if
ok
block
return
for
forControl
int
i
line
i
lineCount
i
block
if
getFoldLevel
i
initialFoldLevel
block
end
i
break
int
delta
end
start
for
forControl
int
i
start
i
end
i
block
if
isLineVisible
i
index
setLineVisible
i
index
delta
if
delta
block
return
setVirtualLineCount
index
getVirtualLineCount
index
delta
writeUnlock
foldStructureChanged
int
virtualLine
physicalToVirtual
start
if
getFirstLine
virtualLine
setFirstLine
virtualLine
getElectricScroll
expandFold
int
line
int
fully
boolean
int
returnValue
int
lineCount
getLineCount
int
start
int
end
lineCount
int
delta
try
writeLock
int
initialFoldLevel
getFoldLevel
line
if
line
lineCount
isLineVisible
line
index
isLineVisible
line
index
getFoldLevel
line
initialFoldLevel
block
start
line
for
forControl
int
i
line
i
lineCount
i
block
if
getFoldLevel
i
initialFoldLevel
block
end
i
break
block
boolean
ok
for
forControl
int
i
line
i
i
block
if
isLineVisible
i
index
getFoldLevel
i
initialFoldLevel
block
start
i
ok
break
if
ok
block
return
for
forControl
int
i
line
i
lineCount
i
block
if
isLineVisible
i
index
getFoldLevel
i
initialFoldLevel
i
getLastVisibleLine
block
end
i
break
initialFoldLevel
getFoldLevel
start
for
forControl
int
i
start
i
end
i
block
getFoldLevel
i
for
forControl
int
i
start
i
end
i
block
if
getFoldLevel
i
initialFoldLevel
block
if
returnValue
i
isFoldStart
i
block
returnValue
i
if
isLineVisible
i
index
fully
block
delta
setLineVisible
i
index
if
isLineVisible
i
index
block
delta
setLineVisible
i
index
setVirtualLineCount
index
getVirtualLineCount
index
delta
if
fully
isLineVisible
line
index
block
expandFold
line
return
returnValue
writeUnlock
foldStructureChanged
int
virtualLine
physicalToVirtual
start
int
firstLine
getFirstLine
int
visibleLines
getVisibleLines
if
virtualLine
delta
firstLine
visibleLines
delta
visibleLines
block
setFirstLine
virtualLine
delta
visibleLines
return
returnValue
expandAllFolds
try
writeLock
narrowed
if
getVirtualLineCount
index
getLineCount
return
setVirtualLineCount
index
getLineCount
for
forControl
int
i
i
getLineCount
i
block
setLineVisible
i
index
foldStructureChanged
writeUnlock
expandFolds
digit
char
if
digit
digit
block
getDefaultToolkit
beep
return
expandFolds
int
digit
expandFolds
foldLevel
int
try
writeLock
narrowed
setVirtualLineCount
index
getLineCount
int
newVirtualLineCount
foldLevel
foldLevel
getIndentSize
boolean
seenVisibleLine
for
forControl
int
i
i
getLineCount
i
block
if
seenVisibleLine
getFoldLevel
i
foldLevel
block
seenVisibleLine
setLineVisible
i
index
newVirtualLineCount
setLineVisible
i
index
setVirtualLineCount
index
newVirtualLineCount
writeUnlock
foldStructureChanged
narrow
start
int
end
int
if
start
end
start
end
getLineCount
throw
ArrayIndexOutOfBoundsException
start
end
if
start
getLineCount
isLineVisible
start
index
expandFold
start
int
virtualLineCount
getVirtualLineCount
index
for
forControl
int
i
i
start
i
block
if
isLineVisible
i
index
block
virtualLineCount
setLineVisible
i
index
for
forControl
int
i
end
i
getLineCount
i
block
if
isLineVisible
i
index
block
virtualLineCount
setLineVisible
i
index
setVirtualLineCount
index
virtualLineCount
narrowed
foldStructureChanged
getView
getStatus
setMessageAndClear
getProperty
textArea
_grab
index
int
index
index
lastPhysical
lastVirtual
_release
index
_getIndex
int
return
index
_invalidate
startLine
int
if
lastPhysical
startLine
lastPhysical
lastVirtual
foldStructureChanged
lastPhysical
lastVirtual
foldStructureChanged
Buffer
buffer
OffsetManager
offsetMgr
JEditTextArea
textArea
int
index
int
lastPhysical
int
lastVirtual
boolean
narrowed
