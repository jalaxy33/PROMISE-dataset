StorageCoreController
STORAGECONTROLLER
Log
LOG
getLog
StorageCoreController
IndexSearcher
searcher
Directory
storageDir
StorageModifier
modifier
ReferenceCounter
StorageQuery
storageQuery
StorageBuffer
currentBuffer
AtomicBoolean
isClosed
AtomicBoolean
ReentrantLock
storageControllerLock
ReentrantLock
Condition
closeCondition
int
DEFAULT_STORAGE_BUFFER_SIZE
int
DEFAULT_STORAGE_PERSIST_FACTOR
String
RECOVERDIRECTORY
String
STORAGELOG
IDGenerator
idGenerator
ConcurrentStorageLock
storageLock
int
indexOptimizeInterval
String
storageDirectory
boolean
keepRecoveredFiles
boolean
recover
int
storageBufferSize
int
storagePersistFactor
RecoverController
recoverController
initialize
synchronized
StorageCoreController
try
idGenerator
IDGenerator
catchClause
e
throw
StorageException
e
boolean
createNewStorage
if
storageDir
block
File
storeDir
File
storageDirectory
File
storageLog
File
getAbsolutePath
getProperty
STORAGELOG
try
if
isDirectory
exists
block
if
createLuceneStorageLog
storeDir
block
storageDir
getDirectory
storeDir
createNewStorage
throw
StorageException
storageDirectory
storageDir
getDirectory
storeDir
catchClause
e
delete
throw
StorageException
e
storageBufferSize
storageBufferSize
DEFAULT_STORAGE_BUFFER_SIZE
DEFAULT_STORAGE_BUFFER_SIZE
storageBufferSize
storagePersistFactor
storagePersistFactor
DEFAULT_STORAGE_PERSIST_FACTOR
DEFAULT_STORAGE_PERSIST_FACTOR
storagePersistFactor
createNewStorage
currentBuffer
StorageBuffer
storageBufferSize
try
modifier
createStorageModifier
createNewStorage
searcher
IndexSearcher
storageDir
catchClause
e
throw
StorageException
getMessage
e
if
createNewStorage
createAdminAccount
if
recover
return
try
tryRecover
catchClause
e
fatal
e
throw
StorageException
getMessage
e
recoverController
createRecoverController
try
recoverController
initialize
catchClause
e
fatal
e
throw
StorageException
getMessage
e
tryRecover
if
recover
return
info
recoverController
createRecoverController
recoverController
initialize
recoverController
recoverEntries
modifier
recoverController
destroy
createRecoverController
RecoverController
doRecover
boolean
keepfiles
boolean
String
recoverDirectory
if
storageDirectory
endsWith
storageDirectory
endsWith
recoverDirectory
storageDirectory
substring
storageDirectory
length
getProperty
RECOVERDIRECTORY
recoverDirectory
storageDirectory
getProperty
RECOVERDIRECTORY
File
recoverDirectoryFile
File
recoverDirectory
return
RecoverController
recoverDirectoryFile
doRecover
keepfiles
StorageCoreController
closeCondition
storageControllerLock
newCondition
storageLock
getConcurrentStorageLock
createStorageModifier
StorageModifier
create
boolean
IndexModifier
indexModifier
IndexModifier
storageDir
StandardAnalyzer
create
return
StorageModifier
indexModifier
currentBuffer
storagePersistFactor
indexOptimizeInterval
getStorageModifier
StorageModifier
return
modifier
getStorageQuery
ReferenceCounter
StorageQuery
if
isClosed
get
throw
IllegalStateException
storageControllerLock
lock
try
if
isClosed
get
throw
IllegalStateException
if
storageQuery
block
storageQuery
getNewStorageQueryHolder
StorageQuery
currentBuffer
searcher
if
isInfoEnabled
info
storageQuery
increamentReference
return
storageQuery
try
closeCondition
signalAll
catchClause
e
storageControllerLock
unlock
getNewStorageQueryHolder
ReferenceCounter
StorageQuery
query
StorageQuery
ReferenceCounter
StorageQuery
holder
ReferenceCounter
StorageQuery
query
close
try
if
isInfoEnabled
info
resource
close
catchClause
e
warn
getMessage
e
increamentReference
return
holder
registerNewStorageQuery
if
isClosed
get
throw
IllegalStateException
storageControllerLock
lock
try
if
isClosed
get
throw
IllegalStateException
if
isInfoEnabled
info
if
storageQuery
storageQuery
decrementRef
searcher
IndexSearcher
storageDir
storageQuery
currentBuffer
StorageBuffer
storageBufferSize
try
closeCondition
signalAll
catchClause
e
storageControllerLock
unlock
releaseNewStorageBuffer
StorageBuffer
if
isClosed
get
throw
IllegalStateException
storageControllerLock
lock
try
if
isClosed
get
throw
IllegalStateException
return
currentBuffer
try
closeCondition
signalAll
catchClause
e
storageControllerLock
unlock
createIndexModifier
IndexModifier
if
isClosed
get
throw
IllegalStateException
storageControllerLock
lock
try
if
isClosed
get
throw
IllegalStateException
if
isInfoEnabled
info
return
IndexModifier
storageDir
StandardAnalyzer
try
closeCondition
signalAll
catchClause
e
storageControllerLock
unlock
close
if
isClosed
get
throw
IllegalStateException
storageControllerLock
lock
try
if
isClosed
get
throw
IllegalStateException
isClosed
set
while
storageControllerLock
getQueueLength
try
closeCondition
await
catchClause
e
if
isInfoEnabled
info
if
storageQuery
storageQuery
decrementRef
if
recoverController
recoverController
destroy
storageLock
close
modifier
close
idGenerator
stopIDGenerator
storageControllerLock
unlock
forceWrite
if
isClosed
get
throw
IllegalStateException
modifier
forceWrite
createLuceneStorageLog
boolean
directory
File
if
isDirectory
exists
block
if
createNewFile
throw
StorageException
directory
File
file
File
getAbsolutePath
getProperty
STORAGELOG
return
createNewFile
releaseId
String
try
return
idGenerator
getUID
catchClause
e
throw
StorageException
e
destroy
try
close
catchClause
e
error
getMessage
e
getDirectory
Directory
return
storageDir
getStorage
Storage
try
return
StorageImplementation
catchClause
e
StorageException
ex
StorageException
getMessage
e
setStackTrace
getStackTrace
throw
ex
createAdminAccount
GDataAccount
adminAccount
createAdminAccount
StorageAccountWrapper
wrapper
StorageAccountWrapper
adminAccount
getStorageModifier
createAccount
wrapper
getLock
ConcurrentStorageLock
return
storageLock
getBufferSize
int
return
storageBufferSize
setBufferSize
storageBufferSize
int
storageBufferSize
storageBufferSize
getPersistFactor
int
return
storagePersistFactor
setPersistFactor
storagePersistFactor
int
storagePersistFactor
storagePersistFactor
getIndexOptimizeInterval
int
return
indexOptimizeInterval
setOptimizeInterval
indexOptimizeInterval
int
indexOptimizeInterval
indexOptimizeInterval
isKeepRecoveredFiles
boolean
return
keepRecoveredFiles
setKeepRecoveredFiles
keepRecoveredFiles
boolean
keepRecoveredFiles
keepRecoveredFiles
isRecover
boolean
return
recover
setRecover
recover
boolean
recover
recover
setStorageDir
storageDir
Directory
storageDir
storageDir
setDirectory
storageDirectory
String
storageDirectory
storageDirectory
writeRecoverEntry
wrapper
StorageEntryWrapper
if
recoverController
recoverController
isRecovering
recoverController
storageModified
wrapper
registerNewRecoverWriter
if
recoverController
recoverController
isRecovering
return
recoverController
destroy
recoverController
createRecoverController
recoverController
initialize
StorageController
