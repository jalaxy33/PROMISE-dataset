BlowfishAuthenticationController
AUTHENTICATIONCONTROLLER
Log
LOG
getLog
BlowfishAuthenticationController
String
ALG
String
TOKEN_LIMITER
String
ENCODING
Cipher
deCrypt
Cipher
enCrypt
int
minuteOffset
long
milisecondOffset
BASE64Encoder
encoder
BASE64Encoder
BASE64Decoder
decoder
BASE64Decoder
ReentrantLock
lock
ReentrantLock
String
key
initialize
if
key
throw
IllegalArgumentException
if
key
length
key
length
throw
IllegalArgumentException
try
Provider
sunJce
com
sun
crypto
provider
SunJCE
addProvider
sunJce
KeyGenerator
kgen
getInstance
ALG
init
byte
raw
key
getBytes
SecretKeySpec
skeySpec
SecretKeySpec
raw
ALG
deCrypt
getInstance
ALG
enCrypt
getInstance
ALG
deCrypt
init
DECRYPT_MODE
skeySpec
enCrypt
init
ENCRYPT_MODE
skeySpec
catchClause
e
throw
AuthenticatorException
getMessage
e
calculateTimeOffset
authenticatAccount
String
account
GDataAccount
requestIp
String
try
String
passIp
substring
lastIndexOf
String
role
toString
getRolesAsInt
return
calculateAuthToken
passIp
role
getName
catchClause
e
throw
AuthenticatorException
getMessage
e
authenticateToken
boolean
token
String
requestIp
String
role
AccountRole
accountName
String
if
isInfoEnabled
info
token
requestIp
if
token
requestIp
return
String
passIp
substring
lastIndexOf
String
authString
try
authString
deCryptAuthToken
token
catchClause
e
throw
AuthenticatorException
getMessage
e
if
authString
return
try
StringTokenizer
tokenizer
StringTokenizer
authString
TOKEN_LIMITER
if
nextToken
equals
passIp
return
String
tempAccountName
nextToken
int
intRole
parseInt
nextToken
if
tempAccountName
equals
accountName
isInRole
intRole
role
return
long
timeout
parseLong
nextToken
return
timeout
milisecondOffset
currentTimeMillis
catchClause
e
error
getMessage
e
return
calculateTimeOffset
milisecondOffset
minuteOffset
calculateAuthToken
String
ipAddress
String
role
String
accountName
String
StringBuilder
builder
StringBuilder
append
append
TOKEN_LIMITER
ipAddress
append
append
TOKEN_LIMITER
accountName
append
append
TOKEN_LIMITER
role
append
currentTimeMillis
lock
lock
try
byte
toencode
toString
getBytes
ENCODING
byte
result
enCrypt
doFinal
toencode
return
encoder
encode
result
lock
unlock
deCryptAuthToken
String
authToken
String
lock
lock
try
byte
input
decoder
decodeBuffer
authToken
byte
result
deCrypt
doFinal
input
return
String
result
ENCODING
lock
unlock
getLoginTimeout
int
return
minuteOffset
setLoginTimeout
minuteOffset
int
minuteOffset
minuteOffset
calculateTimeOffset
getKey
String
return
key
setKey
key
String
key
key
destroy
AuthenticationController
