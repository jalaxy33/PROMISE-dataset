StorageModifier
Log
LOG
getLog
StorageModifier
List
Term
deletedDocumentQueue
List
Term
deletedForUpdateDocumentQueue
Map
String
Document
documentMap
List
Document
forceWriteDocuments
List
Term
forceWriteTerms
int
persistFactor
int
modifiedCounter
int
DEFAULT_PERSIST_FACTOR
StorageBuffer
buffer
IndexModifier
modifier
Lock
lock
ReentrantLock
AtomicBoolean
isClosed
AtomicBoolean
int
DEFAULT_OPTIMIZE_INTERVAL
int
optimizeInterval
int
optimizeCounter
StorageCoreController
controller
StorageModifier
controller
StorageCoreController
modifier
IndexModifier
buffer
StorageBuffer
persitsFactor
int
optimizeInterval
int
deletedDocumentQueue
LinkedList
Term
deletedForUpdateDocumentQueue
LinkedList
Term
documentMap
HashMap
String
Document
persitsFactor
forceWriteDocuments
ArrayList
Document
forceWriteTerms
ArrayList
Term
buffer
buffer
controller
controller
persistFactor
persitsFactor
persitsFactor
DEFAULT_PERSIST_FACTOR
modifier
modifier
optimizeInterval
optimizeInterval
DEFAULT_OPTIMIZE_INTERVAL
DEFAULT_OPTIMIZE_INTERVAL
optimizeInterval
updateEntry
wrapper
StorageEntryWrapper
if
getOperation
UPDATE
throw
StorageException
lock
lock
try
Term
tempTerm
Term
FIELD_ENTRY_ID
getEntryId
documentMap
put
getEntryId
getLuceneDocument
deletedForUpdateDocumentQueue
add
tempTerm
storageModified
if
modifiedCounter
try
controller
writeRecoverEntry
wrapper
buffer
addEntry
wrapper
catchClause
e
documentMap
remove
getEntryId
deletedForUpdateDocumentQueue
remove
tempTerm
lock
unlock
insertEntry
wrapper
StorageEntryWrapper
if
getOperation
INSERT
throw
StorageException
lock
lock
try
documentMap
put
getEntryId
getLuceneDocument
storageModified
if
modifiedCounter
try
controller
writeRecoverEntry
wrapper
buffer
addEntry
wrapper
catchClause
e
documentMap
remove
getEntryId
lock
unlock
deleteEntry
wrapper
StorageEntryWrapper
if
getOperation
DELETE
throw
StorageException
lock
lock
try
Term
tempTerm
Term
FIELD_ENTRY_ID
getEntryId
deletedDocumentQueue
add
tempTerm
storageModified
if
modifiedCounter
try
controller
writeRecoverEntry
wrapper
buffer
addDeleted
getEntryId
getFeedId
catchClause
e
deletedDocumentQueue
remove
tempTerm
lock
unlock
createFeed
wrapper
StorageFeedWrapper
lock
lock
try
forceWriteDocuments
add
getLuceneDocument
storageModified
lock
unlock
createAccount
account
StorageAccountWrapper
lock
lock
try
forceWriteDocuments
add
getLuceneDocument
storageModified
lock
unlock
deleteAccount
accountName
String
lock
lock
try
forceWriteTerms
add
Term
FIELD_ACCOUNTNAME
accountName
storageModified
lock
unlock
updateAccount
user
StorageAccountWrapper
lock
lock
try
forceWriteTerms
add
Term
FIELD_ACCOUNTNAME
getUser
getName
forceWriteDocuments
add
getLuceneDocument
storageModified
lock
unlock
updateFeed
wrapper
StorageFeedWrapper
lock
lock
try
forceWriteTerms
add
Term
FIELD_FEED_ID
getFeed
getId
forceWriteDocuments
add
getLuceneDocument
storageModified
lock
unlock
deleteFeed
feedId
String
lock
lock
try
deletedDocumentQueue
add
Term
FIELD_FEED_REFERENCE
feedId
forceWriteTerms
add
Term
FIELD_FEED_ID
feedId
storageModified
lock
unlock
storageModified
if
isClosed
get
throw
IllegalStateException
try
if
isClosed
get
throw
IllegalStateException
incrementCounter
if
persistFactor
modifiedCounter
forceWriteDocuments
size
forceWriteTerms
size
return
if
isInfoEnabled
info
modifiedCounter
writePersistentIndex
optimizeCounter
optimizeInterval
requestNewIndexModifier
modifiedCounter
catchClause
e
error
e
throw
StorageException
getMessage
e
forceWrite
if
isClosed
get
throw
IllegalStateException
lock
lock
try
if
isInfoEnabled
info
modifiedCounter
writePersistentIndex
requestNewIndexModifier
modifiedCounter
lock
unlock
requestNewIndexModifier
controller
registerNewRecoverWriter
controller
registerNewStorageQuery
buffer
controller
releaseNewStorageBuffer
modifier
controller
createIndexModifier
writePersistentIndex
optimize
boolean
try
for
Term
entryIdTerm
deletedForUpdateDocumentQueue
block
modifier
deleteDocuments
entryIdTerm
for
Term
term
forceWriteTerms
block
modifier
deleteDocuments
term
Collection
Document
documents
documentMap
values
for
Document
doc
documents
block
modifier
addDocument
doc
for
Document
docs
forceWriteDocuments
block
modifier
addDocument
docs
for
Term
entryIdTerm
deletedDocumentQueue
block
modifier
deleteDocuments
entryIdTerm
modifier
flush
if
optimize
block
if
isInfoEnabled
info
optimizeInterval
modifier
optimize
if
optimize
optimizeCounter
modifier
close
deletedForUpdateDocumentQueue
clear
deletedDocumentQueue
clear
documentMap
clear
forceWriteDocuments
clear
forceWriteTerms
clear
close
if
isClosed
get
throw
IllegalStateException
lock
lock
try
if
isClosed
get
throw
IllegalStateException
isClosed
set
if
isInfoEnabled
info
modifiedCounter
writePersistentIndex
modifiedCounter
lock
unlock
incrementCounter
optimizeCounter
modifiedCounter
