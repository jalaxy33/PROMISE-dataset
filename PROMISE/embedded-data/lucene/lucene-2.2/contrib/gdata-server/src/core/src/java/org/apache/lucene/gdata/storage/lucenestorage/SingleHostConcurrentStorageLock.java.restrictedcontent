SingleHostConcurrentStorageLock
ConcurrentStorageLock
INSTANCE
Map
String
Thread
locks
Map
Thread
String
threads
ReentrantReadWriteLock
synLock
ReentrantReadWriteLock
Lock
readLock
synLock
readLock
Lock
writeLock
synLock
writeLock
AtomicBoolean
isClosed
AtomicBoolean
SingleHostConcurrentStorageLock
locks
HashMap
String
Thread
threads
HashMap
Thread
String
getConcurrentStorageLock
ConcurrentStorageLock
if
INSTANCE
INSTANCE
SingleHostConcurrentStorageLock
return
INSTANCE
setLock
boolean
key
String
writeLock
lock
try
if
isClosed
get
throw
IllegalStateException
Thread
t
currentThread
if
threads
containsKey
t
throw
ConcurrencyException
if
locks
containsKey
key
block
return
locks
put
key
t
threads
put
t
key
return
writeLock
unlock
releaseLock
boolean
key
String
writeLock
lock
try
if
isClosed
get
throw
IllegalStateException
Thread
t
currentThread
if
threads
containsKey
t
return
if
locks
containsKey
key
return
if
t
locks
get
key
throw
ConcurrencyException
locks
remove
key
threads
remove
t
return
writeLock
unlock
releaseThreadLocks
boolean
writeLock
lock
try
if
isClosed
get
throw
IllegalStateException
Thread
t
currentThread
if
threads
containsKey
t
return
String
key
threads
get
t
threads
remove
t
if
locks
containsKey
key
return
locks
remove
key
return
writeLock
unlock
isKeyLocked
boolean
key
String
readLock
lock
try
if
isClosed
get
throw
IllegalStateException
return
locks
containsKey
key
readLock
unlock
close
writeLock
lock
try
if
isClosed
get
throw
IllegalStateException
isClosed
set
locks
clear
threads
clear
INSTANCE
SingleHostConcurrentStorageLock
writeLock
unlock
forceClear
writeLock
lock
try
if
isClosed
get
throw
IllegalStateException
locks
clear
threads
clear
writeLock
unlock
ConcurrencyException
long
serialVersionUID
ConcurrencyException
message
String
message
RuntimeException
ConcurrentStorageLock
