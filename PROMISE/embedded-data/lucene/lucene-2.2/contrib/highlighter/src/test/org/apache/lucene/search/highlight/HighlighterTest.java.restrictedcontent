HighlighterTest
IndexReader
reader
String
FIELD_NAME
Query
query
RAMDirectory
ramDir
Searcher
searcher
Hits
hits
int
numHighlights
Analyzer
analyzer
StandardAnalyzer
String
texts
HighlighterTest
arg0
String
arg0
testSimpleHighlighter
doSearching
Highlighter
highlighter
Highlighter
QueryScorer
query
setTextFragmenter
SimpleFragmenter
int
maxNumFragmentsRequired
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
result
getBestFragments
tokenStream
text
maxNumFragmentsRequired
println
result
testGetBestFragmentsSimpleQuery
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetFuzzyFragments
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetWildCardFragments
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetMidWildCardFragments
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetRangeFragments
String
queryString
FIELD_NAME
QueryParser
parser
QueryParser
FIELD_NAME
StandardAnalyzer
setUseOldRangeQuery
query
parse
queryString
doSearching
query
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetBestFragmentsPhrase
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetBestFragmentsSpan
SpanQuery
clauses
SpanTermQuery
Term
SpanTermQuery
Term
SpanNearQuery
snq
SpanNearQuery
clauses
doSearching
snq
doStandardHighlights
assertTrue
numHighlights
numHighlights
testOffByOne
TermQuery
query
TermQuery
Term
Highlighter
hg
Highlighter
SimpleHTMLFormatter
QueryScorer
query
setTextFragmenter
NullFragmenter
String
match
match
getBestFragment
StandardAnalyzer
assertEquals
match
testGetBestFragmentsFilteredQuery
RangeFilter
rf
RangeFilter
SpanQuery
clauses
SpanTermQuery
Term
SpanTermQuery
Term
SpanNearQuery
snq
SpanNearQuery
clauses
FilteredQuery
fq
FilteredQuery
snq
rf
doSearching
fq
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetBestFragmentsFilteredPhraseQuery
RangeFilter
rf
RangeFilter
PhraseQuery
pq
PhraseQuery
add
Term
add
Term
FilteredQuery
fq
FilteredQuery
pq
rf
doSearching
fq
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetBestFragmentsMultiTerm
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetBestFragmentsWithOr
doSearching
doStandardHighlights
assertTrue
numHighlights
numHighlights
testGetBestSingleFragment
doSearching
Highlighter
highlighter
Highlighter
QueryScorer
query
setTextFragmenter
SimpleFragmenter
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
result
getBestFragment
tokenStream
text
println
result
assertTrue
numHighlights
numHighlights
numHighlights
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
getBestFragment
analyzer
FIELD_NAME
text
assertTrue
numHighlights
numHighlights
numHighlights
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
getBestFragments
analyzer
FIELD_NAME
text
assertTrue
numHighlights
numHighlights
testGetBestSingleFragmentWithWeights
WeightedTerm
wTerms
WeightedTerm
wTerms
WeightedTerm
wTerms
WeightedTerm
Highlighter
highlighter
Highlighter
QueryScorer
wTerms
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
texts
setTextFragmenter
SimpleFragmenter
String
result
getBestFragment
trim
tokenStream
texts
assertTrue
result
equals
result
wTerms
setWeight
tokenStream
tokenStream
FIELD_NAME
StringReader
texts
highlighter
Highlighter
QueryScorer
wTerms
setTextFragmenter
SimpleFragmenter
result
getBestFragment
trim
tokenStream
texts
assertTrue
result
equals
result
testOverlapAnalyzer
HashMap
synonyms
HashMap
put
Analyzer
analyzer
SynonymAnalyzer
synonyms
String
srchkey
String
s
QueryParser
parser
QueryParser
analyzer
Query
query
parse
srchkey
Highlighter
highlighter
Highlighter
QueryScorer
query
TokenStream
tokenStream
tokenStream
StringReader
s
String
result
getBestFragments
tokenStream
s
String
expectedResult
assertTrue
equals
result
testGetSimpleHighlight
doSearching
Highlighter
highlighter
Highlighter
QueryScorer
query
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
result
getBestFragment
tokenStream
text
println
result
assertTrue
numHighlights
numHighlights
testGetTextFragments
doSearching
Highlighter
highlighter
Highlighter
QueryScorer
query
setTextFragmenter
SimpleFragmenter
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
stringResults
getBestFragments
tokenStream
text
tokenStream
tokenStream
FIELD_NAME
StringReader
text
TextFragment
fragmentResults
getBestTextFragments
tokenStream
text
assertTrue
length
length
length
length
for
forControl
int
j
j
length
j
block
println
fragmentResults
j
assertTrue
fragmentResults
j
fragmentResults
j
toString
equals
stringResults
j
testMaxSizeHighlight
doSearching
Highlighter
highlighter
Highlighter
QueryScorer
query
setMaxDocBytesToAnalyze
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
texts
getBestFragment
tokenStream
texts
assertTrue
numHighlights
numHighlights
testMaxSizeHighlightTruncates
String
goodWord
String
stopWords
TermQuery
query
TermQuery
Term
goodWord
SimpleHTMLFormatter
fm
SimpleHTMLFormatter
Highlighter
hg
Highlighter
fm
QueryScorer
query
setTextFragmenter
NullFragmenter
String
match
StringBuffer
sb
StringBuffer
append
goodWord
for
forControl
int
i
i
i
block
append
append
stopWords
setMaxDocBytesToAnalyze
match
getBestFragment
StandardAnalyzer
stopWords
toString
assertTrue
length
getMaxDocBytesToAnalyze
append
append
goodWord
match
getBestFragment
StandardAnalyzer
stopWords
toString
assertTrue
length
getMaxDocBytesToAnalyze
testUnRewrittenQuery
searcher
IndexSearcher
ramDir
Analyzer
analyzer
StandardAnalyzer
QueryParser
parser
QueryParser
FIELD_NAME
analyzer
Query
query
parse
println
Hits
hits
search
query
Highlighter
highlighter
Highlighter
QueryScorer
query
setTextFragmenter
SimpleFragmenter
int
maxNumFragmentsRequired
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
highlightedText
getBestFragments
tokenStream
text
maxNumFragmentsRequired
println
highlightedText
assertTrue
numHighlights
numHighlights
testNoFragments
doSearching
Highlighter
highlighter
Highlighter
QueryScorer
query
for
forControl
int
i
i
length
i
block
String
text
texts
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
result
getBestFragment
tokenStream
text
assertNull
result
testEncoding
String
rawDocContent
Highlighter
highlighter
Highlighter
SimpleHTMLEncoder
Scorer
startFragment
newFragment
TextFragment
getTokenScore
float
token
Token
return
getFragmentScore
float
return
setTextFragmenter
SimpleFragmenter
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
rawDocContent
String
encodedSnippet
getBestFragments
tokenStream
rawDocContent
String
xhtml
encodedSnippet
DocumentBuilderFactory
dbf
newInstance
DocumentBuilder
db
newDocumentBuilder
org
w3c
dom
Document
doc
parse
ByteArrayInputStream
getBytes
Element
root
getDocumentElement
NodeList
nodes
getElementsByTagName
Element
body
Element
item
nodes
getElementsByTagName
Element
h2
Element
item
String
decodedSnippet
getFirstChild
getNodeValue
assertEquals
rawDocContent
decodedSnippet
testMultiSearcher
RAMDirectory
ramDir1
RAMDirectory
IndexWriter
writer1
IndexWriter
ramDir1
StandardAnalyzer
Document
d
Document
Field
f
Field
FIELD_NAME
YES
TOKENIZED
add
f
addDocument
d
optimize
close
IndexReader
reader1
open
ramDir1
RAMDirectory
ramDir2
RAMDirectory
IndexWriter
writer2
IndexWriter
ramDir2
StandardAnalyzer
d
Document
f
Field
FIELD_NAME
YES
TOKENIZED
add
f
addDocument
d
optimize
close
IndexReader
reader2
open
ramDir2
IndexSearcher
searchers
IndexSearcher
searchers
IndexSearcher
ramDir1
searchers
IndexSearcher
ramDir2
MultiSearcher
multiSearcher
MultiSearcher
searchers
QueryParser
parser
QueryParser
FIELD_NAME
StandardAnalyzer
query
parse
println
toString
FIELD_NAME
hits
search
query
Query
expandedQueries
Query
expandedQueries
rewrite
reader1
expandedQueries
rewrite
reader2
query
combine
expandedQueries
Highlighter
highlighter
Highlighter
QueryScorer
query
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
highlightedText
getBestFragment
tokenStream
text
println
highlightedText
assertTrue
numHighlights
numHighlights
testFieldSpecificHighlighting
String
docMainText
QueryParser
parser
QueryParser
FIELD_NAME
analyzer
Query
query
parse
QueryScorer
fieldSpecificScorer
QueryScorer
query
Highlighter
fieldSpecificHighlighter
Highlighter
SimpleHTMLFormatter
fieldSpecificScorer
setTextFragmenter
NullFragmenter
String
result
getBestFragment
analyzer
FIELD_NAME
docMainText
assertEquals
result
QueryScorer
fieldInSpecificScorer
QueryScorer
query
Highlighter
fieldInSpecificHighlighter
Highlighter
SimpleHTMLFormatter
fieldInSpecificScorer
setTextFragmenter
NullFragmenter
result
getBestFragment
analyzer
FIELD_NAME
docMainText
assertEquals
result
close
getTS2
TokenStream
return
TokenStream
Iterator
iter
List
lst
lst
ArrayList
Token
t
t
Token
add
t
t
Token
add
t
t
Token
setPositionIncrement
add
t
t
Token
add
t
t
Token
add
t
iter
iterator
next
Token
return
hasNext
Token
next
getTS2a
TokenStream
return
TokenStream
Iterator
iter
List
lst
lst
ArrayList
Token
t
t
Token
add
t
t
Token
setPositionIncrement
add
t
t
Token
add
t
t
Token
add
t
t
Token
add
t
iter
iterator
next
Token
return
hasNext
Token
next
testOverlapAnalyzer2
String
s
Query
query
Highlighter
highlighter
String
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2a
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2a
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2a
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2a
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2a
s
assertEquals
result
query
parse
QueryParser
WhitespaceAnalyzer
highlighter
Highlighter
QueryScorer
query
result
getBestFragments
getTS2a
s
assertEquals
result
highlightTerm
String
originalText
String
group
TokenGroup
if
getTotalScore
block
return
originalText
numHighlights
return
originalText
doSearching
queryString
String
QueryParser
parser
QueryParser
FIELD_NAME
StandardAnalyzer
query
parse
queryString
doSearching
query
doSearching
unReWrittenQuery
Query
searcher
IndexSearcher
ramDir
query
rewrite
reader
println
toString
FIELD_NAME
hits
search
query
doStandardHighlights
Highlighter
highlighter
Highlighter
QueryScorer
query
setTextFragmenter
SimpleFragmenter
for
forControl
int
i
i
length
i
block
String
text
doc
get
FIELD_NAME
i
int
maxNumFragmentsRequired
String
fragmentSeparator
TokenStream
tokenStream
tokenStream
FIELD_NAME
StringReader
text
String
result
getBestFragments
tokenStream
text
maxNumFragmentsRequired
fragmentSeparator
println
result
setUp
ramDir
RAMDirectory
IndexWriter
writer
IndexWriter
ramDir
StandardAnalyzer
for
forControl
int
i
i
length
i
block
addDoc
writer
texts
i
optimize
close
reader
open
ramDir
numHighlights
addDoc
writer
IndexWriter
text
String
Document
d
Document
Field
f
Field
FIELD_NAME
text
YES
TOKENIZED
add
f
addDocument
d
tearDown
tearDown
TestCase
Formatter
SynonymAnalyzer
Map
synonyms
SynonymAnalyzer
synonyms
Map
synonyms
synonyms
tokenStream
TokenStream
arg0
String
arg1
Reader
return
SynonymTokenizer
LowerCaseTokenizer
arg1
synonyms
Analyzer
SynonymTokenizer
TokenStream
realStream
Token
currentRealToken
Map
synonyms
StringTokenizer
st
SynonymTokenizer
realStream
TokenStream
synonyms
Map
realStream
realStream
synonyms
synonyms
next
Token
if
currentRealToken
block
Token
nextRealToken
next
if
nextRealToken
block
return
String
expansions
String
get
termText
if
expansions
block
return
nextRealToken
st
StringTokenizer
expansions
if
hasMoreTokens
block
currentRealToken
nextRealToken
return
currentRealToken
block
String
nextExpandedValue
nextToken
Token
expandedToken
Token
nextExpandedValue
startOffset
endOffset
setPositionIncrement
if
hasMoreTokens
block
currentRealToken
st
return
expandedToken
TokenStream
