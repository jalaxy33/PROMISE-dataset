MultiLevelSkipListWriter
int
numberOfSkipLevels
int
skipInterval
RAMOutputStream
skipBuffer
MultiLevelSkipListWriter
skipInterval
int
maxSkipLevels
int
df
int
skipInterval
skipInterval
numberOfSkipLevels
df
int
floor
log
df
log
skipInterval
if
numberOfSkipLevels
maxSkipLevels
block
numberOfSkipLevels
maxSkipLevels
init
skipBuffer
RAMOutputStream
numberOfSkipLevels
for
forControl
int
i
i
numberOfSkipLevels
i
block
skipBuffer
i
RAMOutputStream
resetSkip
if
skipBuffer
block
init
block
for
forControl
int
i
i
length
i
block
skipBuffer
i
reset
writeSkipData
level
int
skipBuffer
IndexOutput
bufferSkip
df
int
int
numLevels
for
forControl
numLevels
df
skipInterval
numLevels
numberOfSkipLevels
df
skipInterval
block
numLevels
long
childPointer
for
forControl
int
level
level
numLevels
level
block
writeSkipData
level
skipBuffer
level
long
newChildPointer
skipBuffer
level
getFilePointer
if
level
block
skipBuffer
level
writeVLong
childPointer
childPointer
newChildPointer
writeSkip
long
output
IndexOutput
long
skipPointer
getFilePointer
if
skipBuffer
length
return
skipPointer
for
forControl
int
level
numberOfSkipLevels
level
level
block
long
length
skipBuffer
level
getFilePointer
if
length
block
writeVLong
length
skipBuffer
level
writeTo
output
skipBuffer
writeTo
output
return
skipPointer
