SegmentInfo
int
NO
int
YES
int
CHECK_DIR
int
WITHOUT_GEN
String
name
int
docCount
Directory
dir
boolean
preLockless
long
delGen
long
normGen
byte
isCompoundFile
boolean
hasSingleNormFile
List
files
SegmentInfo
name
String
docCount
int
dir
Directory
name
name
docCount
docCount
dir
dir
delGen
NO
isCompoundFile
CHECK_DIR
preLockless
hasSingleNormFile
SegmentInfo
name
String
docCount
int
dir
Directory
isCompoundFile
boolean
hasSingleNormFile
boolean
name
docCount
dir
isCompoundFile
byte
isCompoundFile
YES
NO
hasSingleNormFile
hasSingleNormFile
preLockless
reset
src
SegmentInfo
files
name
name
docCount
docCount
dir
dir
preLockless
preLockless
delGen
delGen
if
normGen
block
normGen
block
normGen
long
length
arraycopy
normGen
normGen
length
isCompoundFile
isCompoundFile
hasSingleNormFile
hasSingleNormFile
SegmentInfo
dir
Directory
format
int
input
IndexInput
dir
dir
name
readString
docCount
readInt
if
format
FORMAT_LOCKLESS
block
delGen
readLong
if
format
FORMAT_SINGLE_NORM_FILE
block
hasSingleNormFile
readByte
block
hasSingleNormFile
int
numNormGen
readInt
if
numNormGen
NO
block
normGen
block
normGen
long
numNormGen
for
forControl
int
j
j
numNormGen
j
block
normGen
j
readLong
isCompoundFile
readByte
preLockless
isCompoundFile
CHECK_DIR
block
delGen
CHECK_DIR
normGen
isCompoundFile
CHECK_DIR
preLockless
hasSingleNormFile
setNumFields
numFields
int
if
normGen
block
normGen
long
numFields
if
preLockless
block
block
for
forControl
int
i
i
numFields
i
block
normGen
i
NO
hasDeletions
boolean
if
delGen
NO
block
return
if
delGen
YES
block
return
block
return
fileExists
getDelFileName
advanceDelGen
if
delGen
NO
block
delGen
YES
block
delGen
files
clearDelGen
delGen
NO
files
clone
Object
SegmentInfo
si
SegmentInfo
name
docCount
dir
isCompoundFile
isCompoundFile
delGen
delGen
preLockless
preLockless
hasSingleNormFile
hasSingleNormFile
if
normGen
block
normGen
long
clone
return
si
getDelFileName
String
if
delGen
NO
block
return
block
return
fileNameFromGeneration
name
DELETES_EXTENSION
delGen
hasSeparateNorms
boolean
fieldNumber
int
if
normGen
preLockless
normGen
normGen
fieldNumber
CHECK_DIR
block
String
fileName
name
fieldNumber
return
fileExists
fileName
if
normGen
normGen
fieldNumber
NO
block
return
block
return
hasSeparateNorms
boolean
if
normGen
block
if
preLockless
block
return
block
String
result
list
if
result
throw
IOException
dir
String
pattern
pattern
name
int
patternLength
length
for
forControl
int
i
i
length
i
block
if
result
i
startsWith
pattern
isDigit
result
i
charAt
patternLength
return
return
block
for
forControl
int
i
i
length
i
block
if
normGen
i
YES
block
return
for
forControl
int
i
i
length
i
block
if
normGen
i
CHECK_DIR
block
if
hasSeparateNorms
i
block
return
return
advanceNormGen
fieldIndex
int
if
normGen
fieldIndex
NO
block
normGen
fieldIndex
YES
block
normGen
fieldIndex
files
getNormFileName
String
number
int
String
prefix
long
gen
if
normGen
block
gen
CHECK_DIR
block
gen
normGen
number
if
hasSeparateNorms
number
block
prefix
return
fileNameFromGeneration
name
prefix
number
gen
if
hasSingleNormFile
block
prefix
NORMS_EXTENSION
return
fileNameFromGeneration
name
prefix
WITHOUT_GEN
prefix
return
fileNameFromGeneration
name
prefix
number
WITHOUT_GEN
setUseCompoundFile
isCompoundFile
boolean
if
isCompoundFile
block
isCompoundFile
YES
block
isCompoundFile
NO
files
getUseCompoundFile
boolean
if
isCompoundFile
NO
block
return
if
isCompoundFile
YES
block
return
block
return
fileExists
name
COMPOUND_FILE_EXTENSION
write
output
IndexOutput
writeString
name
writeInt
docCount
writeLong
delGen
writeByte
byte
hasSingleNormFile
if
normGen
block
writeInt
NO
block
writeInt
length
for
forControl
int
j
j
length
j
block
writeLong
normGen
j
writeByte
isCompoundFile
files
List
if
files
block
return
files
files
ArrayList
boolean
useCompoundFile
getUseCompoundFile
if
useCompoundFile
block
add
name
COMPOUND_FILE_EXTENSION
block
for
forControl
int
i
i
length
i
block
String
ext
INDEX_EXTENSIONS_IN_COMPOUND_FILE
i
String
fileName
name
ext
if
fileExists
fileName
block
add
fileName
String
delFileName
fileNameFromGeneration
name
DELETES_EXTENSION
delGen
if
delFileName
delGen
YES
fileExists
delFileName
block
add
delFileName
if
normGen
block
for
forControl
int
i
i
length
i
block
long
gen
normGen
i
if
gen
YES
block
add
fileNameFromGeneration
name
SEPARATE_NORMS_EXTENSION
i
gen
if
NO
gen
block
if
hasSingleNormFile
useCompoundFile
block
String
fileName
name
PLAIN_NORMS_EXTENSION
i
if
fileExists
fileName
block
add
fileName
if
CHECK_DIR
gen
block
String
fileName
if
useCompoundFile
block
fileName
name
SEPARATE_NORMS_EXTENSION
i
if
hasSingleNormFile
block
fileName
name
PLAIN_NORMS_EXTENSION
i
if
fileName
fileExists
fileName
block
add
fileName
if
preLockless
hasSingleNormFile
useCompoundFile
block
String
prefix
if
useCompoundFile
prefix
name
SEPARATE_NORMS_EXTENSION
prefix
name
PLAIN_NORMS_EXTENSION
int
prefixLength
length
String
allFiles
list
if
allFiles
throw
IOException
dir
for
forControl
int
i
i
length
i
block
String
fileName
allFiles
i
if
length
prefixLength
isDigit
charAt
prefixLength
startsWith
prefix
block
add
fileName
return
files
