NativeFSLockFactory
File
lockDir
acquireTestLock
String
randomLockName
toString
nextInt
Random
MAX_RADIX
Lock
l
makeLock
randomLockName
try
obtain
catchClause
e
IOException
e2
IOException
lockDir
initCause
e
throw
e2
release
NativeFSLockFactory
File
NativeFSLockFactory
lockDirName
String
File
lockDirName
NativeFSLockFactory
lockDir
File
setLockDir
lockDir
setLockDir
lockDir
File
lockDir
lockDir
if
lockDir
block
if
exists
block
if
mkdirs
throw
IOException
getAbsolutePath
if
isDirectory
block
throw
IOException
getAbsolutePath
acquireTestLock
makeLock
Lock
lockName
String
if
lockPrefix
lockName
lockPrefix
lockName
return
NativeFSLock
lockDir
lockName
clearLock
lockName
String
if
exists
block
if
lockPrefix
block
lockName
lockPrefix
lockName
File
lockFile
File
lockDir
lockName
if
exists
delete
block
throw
IOException
lockFile
LockFactory
NativeFSLock
RandomAccessFile
f
FileChannel
channel
FileLock
lock
File
path
File
lockDir
HashSet
LOCK_HELD
HashSet
NativeFSLock
lockDir
File
lockFileName
String
lockDir
lockDir
path
File
lockDir
lockFileName
obtain
boolean
if
isLocked
block
return
if
exists
block
if
mkdirs
throw
IOException
getAbsolutePath
if
isDirectory
block
throw
IOException
getAbsolutePath
String
canonicalPath
getCanonicalPath
boolean
markedHeld
try
synchronized
LOCK_HELD
if
contains
canonicalPath
block
return
block
add
canonicalPath
markedHeld
try
f
RandomAccessFile
path
catchClause
e
failureReason
e
f
if
f
block
try
channel
getChannel
try
lock
tryLock
catchClause
e
failureReason
e
if
lock
block
try
close
channel
if
channel
block
try
close
f
if
markedHeld
isLocked
block
synchronized
LOCK_HELD
if
contains
canonicalPath
block
remove
canonicalPath
return
isLocked
release
try
if
isLocked
block
try
release
lock
try
close
channel
try
close
f
synchronized
LOCK_HELD
remove
getCanonicalPath
delete
catchClause
e
throw
RuntimeException
e
isLocked
boolean
return
lock
toString
String
return
path
finalize
try
if
isLocked
block
release
finalize
Lock
