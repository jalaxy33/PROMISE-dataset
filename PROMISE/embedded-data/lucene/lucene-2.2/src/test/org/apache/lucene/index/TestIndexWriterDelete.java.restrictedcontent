TestIndexWriterDelete
testSimpleCase
String
keywords
String
unindexed
String
unstored
String
text
for
forControl
int
pass
pass
pass
block
boolean
autoCommit
pass
Directory
dir
RAMDirectory
IndexWriter
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setUseCompoundFile
setMaxBufferedDeleteTerms
for
forControl
int
i
i
length
i
block
Document
doc
Document
add
Field
keywords
i
YES
UN_TOKENIZED
add
Field
unindexed
i
YES
NO
add
Field
unstored
i
NO
TOKENIZED
add
Field
text
i
YES
TOKENIZED
addDocument
doc
optimize
if
autoCommit
block
close
Term
term
Term
int
hitCount
getHitCount
dir
term
assertEquals
hitCount
if
autoCommit
block
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setUseCompoundFile
deleteDocuments
term
if
autoCommit
block
close
hitCount
getHitCount
dir
term
assertEquals
hitCount
if
autoCommit
block
close
close
testNonRAMDelete
for
forControl
int
pass
pass
pass
block
boolean
autoCommit
pass
Directory
dir
RAMDirectory
IndexWriter
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
int
id
int
value
for
forControl
int
i
i
i
block
addDoc
modifier
id
value
flush
assertEquals
getRamSegmentCount
assertTrue
getSegmentCount
if
autoCommit
block
close
IndexReader
reader
open
dir
assertEquals
numDocs
close
if
autoCommit
block
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
deleteDocuments
Term
valueOf
value
deleteDocuments
Term
valueOf
value
if
autoCommit
block
close
reader
open
dir
assertEquals
numDocs
close
if
autoCommit
block
close
close
testRAMDeletes
for
forControl
int
pass
pass
pass
block
boolean
autoCommit
pass
Directory
dir
RAMDirectory
IndexWriter
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
int
id
int
value
addDoc
modifier
id
value
deleteDocuments
Term
valueOf
value
addDoc
modifier
id
value
deleteDocuments
Term
valueOf
value
assertEquals
getNumBufferedDeleteTerms
assertEquals
getBufferedDeleteTermsSize
addDoc
modifier
id
value
assertEquals
getSegmentCount
flush
if
autoCommit
block
close
IndexReader
reader
open
dir
assertEquals
numDocs
int
hitCount
getHitCount
dir
Term
valueOf
id
assertEquals
hitCount
close
if
autoCommit
block
close
close
testBothDeletes
for
forControl
int
pass
pass
pass
block
boolean
autoCommit
pass
Directory
dir
RAMDirectory
IndexWriter
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
int
id
int
value
for
forControl
int
i
i
i
block
addDoc
modifier
id
value
value
for
forControl
int
i
i
i
block
addDoc
modifier
id
value
flush
for
forControl
int
i
i
i
block
addDoc
modifier
id
value
deleteDocuments
Term
valueOf
value
flush
if
autoCommit
block
close
IndexReader
reader
open
dir
assertEquals
numDocs
if
autoCommit
block
close
testBatchDeletes
for
forControl
int
pass
pass
pass
block
boolean
autoCommit
pass
Directory
dir
RAMDirectory
IndexWriter
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
int
id
int
value
for
forControl
int
i
i
i
block
addDoc
modifier
id
value
flush
if
autoCommit
block
close
IndexReader
reader
open
dir
assertEquals
numDocs
close
if
autoCommit
block
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
id
deleteDocuments
Term
valueOf
id
deleteDocuments
Term
valueOf
id
if
autoCommit
block
close
reader
open
dir
assertEquals
numDocs
close
Term
terms
Term
for
forControl
int
i
i
length
i
block
terms
i
Term
valueOf
id
if
autoCommit
block
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
deleteDocuments
terms
if
autoCommit
block
close
reader
open
dir
assertEquals
numDocs
close
if
autoCommit
block
close
close
addDoc
modifier
IndexWriter
id
int
value
int
Document
doc
Document
add
Field
NO
TOKENIZED
add
Field
valueOf
id
YES
UN_TOKENIZED
add
Field
valueOf
value
NO
UN_TOKENIZED
addDocument
doc
getHitCount
int
dir
Directory
term
Term
IndexSearcher
searcher
IndexSearcher
dir
int
hitCount
search
length
TermQuery
term
close
return
hitCount
testDeletesOnDiskFull
testOperationsOnDiskFull
testUpdatesOnDiskFull
testOperationsOnDiskFull
testOperationsOnDiskFull
updates
boolean
boolean
debug
Term
searchTerm
Term
int
START_COUNT
int
END_COUNT
for
forControl
int
pass
pass
pass
block
boolean
autoCommit
pass
RAMDirectory
startDir
RAMDirectory
IndexWriter
writer
IndexWriter
startDir
autoCommit
WhitespaceAnalyzer
for
forControl
int
i
i
i
block
Document
d
Document
add
Field
toString
i
YES
UN_TOKENIZED
add
Field
i
NO
TOKENIZED
addDocument
d
close
long
diskUsage
sizeInBytes
long
diskFree
diskUsage
IOException
err
boolean
done
while
done
block
MockRAMDirectory
dir
MockRAMDirectory
startDir
IndexWriter
modifier
IndexWriter
dir
autoCommit
WhitespaceAnalyzer
setMaxBufferedDocs
setMaxBufferedDeleteTerms
boolean
success
for
forControl
int
x
x
x
block
double
rate
double
diskRatio
double
diskFree
diskUsage
long
thisDiskFree
String
testName
if
x
block
thisDiskFree
diskFree
if
diskRatio
block
rate
if
diskRatio
block
rate
if
diskRatio
block
rate
if
debug
block
println
diskFree
testName
thisDiskFree
block
thisDiskFree
rate
if
debug
block
println
testName
setMaxSizeInBytes
thisDiskFree
setRandomIOExceptionRate
rate
diskFree
try
if
x
block
int
docId
for
forControl
int
i
i
i
block
if
updates
block
Document
d
Document
add
Field
toString
i
YES
UN_TOKENIZED
add
Field
i
NO
TOKENIZED
updateDocument
Term
toString
docId
d
block
deleteDocuments
Term
toString
docId
docId
close
success
if
x
block
done
catchClause
e
if
debug
block
println
e
err
e
if
x
block
printStackTrace
fail
testName
String
startFiles
list
SegmentInfos
infos
SegmentInfos
read
dir
IndexFileDeleter
d
IndexFileDeleter
dir
KeepOnlyLastCommitDeletionPolicy
infos
String
endFiles
list
sort
startFiles
sort
endFiles
if
equals
startFiles
endFiles
block
String
successStr
if
success
block
successStr
block
successStr
printStackTrace
fail
successStr
diskFree
arrayToString
startFiles
arrayToString
endFiles
IndexReader
newReader
try
newReader
open
dir
catchClause
e
printStackTrace
fail
testName
e
IndexSearcher
searcher
IndexSearcher
newReader
Hits
hits
try
hits
search
TermQuery
searchTerm
catchClause
e
printStackTrace
fail
testName
e
int
result2
length
if
success
block
if
result2
END_COUNT
block
fail
testName
result2
END_COUNT
block
if
result2
START_COUNT
result2
END_COUNT
block
printStackTrace
fail
testName
result2
START_COUNT
close
close
if
result2
END_COUNT
block
break
close
diskFree
arrayToString
String
l
String
String
s
for
forControl
int
i
i
length
i
block
if
i
block
s
s
l
i
return
s
TestCase
