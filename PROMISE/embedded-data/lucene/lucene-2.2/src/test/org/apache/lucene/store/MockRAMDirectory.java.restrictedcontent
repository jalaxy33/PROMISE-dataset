MockRAMDirectory
long
maxSize
long
maxUsedSize
double
randomIOExceptionRate
Random
randomState
boolean
noDeleteOpenFile
Map
openFiles
MockRAMDirectory
if
openFiles
block
openFiles
HashMap
MockRAMDirectory
dir
String
dir
if
openFiles
block
openFiles
HashMap
MockRAMDirectory
dir
Directory
dir
if
openFiles
block
openFiles
HashMap
MockRAMDirectory
dir
File
dir
if
openFiles
block
openFiles
HashMap
setMaxSizeInBytes
maxSize
long
maxSize
maxSize
getMaxSizeInBytes
long
return
maxSize
getMaxUsedSizeInBytes
long
return
maxUsedSize
resetMaxUsedSizeInBytes
maxUsedSize
getRecomputedActualSizeInBytes
setNoDeleteOpenFile
value
boolean
noDeleteOpenFile
value
getNoDeleteOpenFile
boolean
return
noDeleteOpenFile
setRandomIOExceptionRate
rate
double
seed
long
randomIOExceptionRate
rate
randomState
Random
seed
getRandomIOExceptionRate
double
return
randomIOExceptionRate
maybeThrowIOException
if
randomIOExceptionRate
block
int
number
abs
nextInt
if
number
randomIOExceptionRate
block
throw
IOException
deleteFile
name
String
synchronized
openFiles
if
noDeleteOpenFile
containsKey
name
block
throw
IOException
name
deleteFile
name
createOutput
IndexOutput
name
String
if
openFiles
block
openFiles
HashMap
synchronized
openFiles
if
noDeleteOpenFile
containsKey
name
block
throw
RuntimeException
name
RAMFile
file
RAMFile
synchronized
RAMFile
existing
RAMFile
get
name
if
existing
block
sizeInBytes
sizeInBytes
directory
put
name
file
return
MockRAMOutputStream
file
openInput
IndexInput
name
String
RAMFile
file
synchronized
file
RAMFile
get
name
if
file
throw
FileNotFoundException
name
block
synchronized
openFiles
if
containsKey
name
block
Integer
v
Integer
get
name
v
Integer
intValue
put
name
v
block
put
name
Integer
return
MockRAMInputStream
name
file
getRecomputedSizeInBytes
long
long
size
Iterator
it
values
iterator
while
hasNext
size
RAMFile
next
return
size
getRecomputedActualSizeInBytes
long
long
size
Iterator
it
values
iterator
while
hasNext
size
RAMFile
next
return
size
close
if
openFiles
block
openFiles
HashMap
synchronized
openFiles
if
noDeleteOpenFile
size
block
throw
RuntimeException
openFiles
RAMDirectory
