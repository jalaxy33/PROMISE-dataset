DirectoryIndexReader
Directory
directory
boolean
closeDirectory
IndexDeletionPolicy
deletionPolicy
SegmentInfos
segmentInfos
Lock
writeLock
boolean
stale
HashSet
synced
HashSet
boolean
rollbackHasChanges
SegmentInfos
rollbackSegmentInfos
boolean
readOnly
init
directory
Directory
segmentInfos
SegmentInfos
closeDirectory
boolean
readOnly
boolean
directory
directory
segmentInfos
segmentInfos
closeDirectory
closeDirectory
readOnly
readOnly
if
readOnly
segmentInfos
block
for
forControl
int
i
i
size
i
block
SegmentInfo
info
info
i
List
files
files
for
forControl
int
j
j
size
j
add
get
j
DirectoryIndexReader
DirectoryIndexReader
directory
Directory
segmentInfos
SegmentInfos
closeDirectory
boolean
readOnly
boolean
init
directory
segmentInfos
closeDirectory
readOnly
open
DirectoryIndexReader
directory
Directory
closeDirectory
boolean
deletionPolicy
IndexDeletionPolicy
return
open
directory
closeDirectory
deletionPolicy
open
DirectoryIndexReader
directory
Directory
closeDirectory
boolean
deletionPolicy
IndexDeletionPolicy
commit
IndexCommit
readOnly
boolean
SegmentInfos
FindSegmentsFile
finder
SegmentInfos
FindSegmentsFile
directory
doBody
Object
segmentFileName
String
SegmentInfos
infos
SegmentInfos
read
directory
segmentFileName
DirectoryIndexReader
reader
if
size
block
reader
get
readOnly
infos
info
closeDirectory
if
readOnly
block
reader
ReadOnlyMultiSegmentReader
directory
infos
closeDirectory
block
reader
MultiSegmentReader
directory
infos
closeDirectory
setDeletionPolicy
deletionPolicy
return
reader
if
commit
return
DirectoryIndexReader
run
block
if
directory
getDirectory
throw
IOException
return
DirectoryIndexReader
doBody
getSegmentsFileName
reopen
IndexReader
ensureOpen
if
hasChanges
isCurrent
block
return
return
DirectoryIndexReader
run
SegmentInfos
FindSegmentsFile
directory
doBody
Object
segmentFileName
String
SegmentInfos
infos
SegmentInfos
read
directory
segmentFileName
DirectoryIndexReader
newReader
doReopen
infos
if
newReader
block
init
directory
infos
closeDirectory
readOnly
deletionPolicy
deletionPolicy
return
newReader
doReopen
DirectoryIndexReader
infos
SegmentInfos
setDeletionPolicy
deletionPolicy
IndexDeletionPolicy
deletionPolicy
deletionPolicy
directory
Directory
ensureOpen
return
directory
getVersion
long
ensureOpen
return
getVersion
isCurrent
boolean
ensureOpen
return
readCurrentVersion
directory
getVersion
isOptimized
boolean
ensureOpen
return
size
hasDeletions
doClose
if
closeDirectory
close
doCommit
if
hasChanges
block
if
segmentInfos
block
IndexFileDeleter
deleter
IndexFileDeleter
directory
deletionPolicy
KeepOnlyLastCommitDeletionPolicy
deletionPolicy
segmentInfos
startCommit
boolean
success
try
commitChanges
for
forControl
int
i
i
size
i
block
SegmentInfo
info
info
i
List
files
files
for
forControl
int
j
j
size
j
block
String
fileName
String
get
j
if
contains
fileName
block
assert
fileExists
fileName
sync
fileName
add
fileName
commit
directory
success
if
success
block
rollbackCommit
refresh
checkpoint
segmentInfos
if
writeLock
block
release
writeLock
commitChanges
hasChanges
commitChanges
acquireWriteLock
if
segmentInfos
block
ensureOpen
if
stale
throw
StaleReaderException
if
writeLock
block
Lock
writeLock
makeLock
WRITE_LOCK_NAME
if
obtain
WRITE_LOCK_TIMEOUT
throw
LockObtainFailedException
writeLock
writeLock
writeLock
if
readCurrentVersion
directory
getVersion
block
stale
writeLock
release
writeLock
throw
StaleReaderException
startCommit
if
segmentInfos
block
rollbackSegmentInfos
SegmentInfos
clone
rollbackHasChanges
hasChanges
rollbackCommit
if
segmentInfos
block
for
forControl
int
i
i
size
i
block
info
reset
info
i
i
rollbackSegmentInfos
hasChanges
rollbackHasChanges
finalize
try
if
writeLock
block
release
writeLock
finalize
ReaderCommit
String
segmentsFileName
Collection
files
Directory
dir
long
generation
long
version
boolean
isOptimized
ReaderCommit
infos
SegmentInfos
dir
Directory
segmentsFileName
getCurrentSegmentFileName
dir
dir
int
size
size
files
ArrayList
size
add
segmentsFileName
for
forControl
int
i
i
size
i
block
SegmentInfo
info
info
i
if
dir
dir
addAll
files
version
getVersion
generation
getGeneration
isOptimized
size
info
hasDeletions
isOptimized
boolean
return
isOptimized
getSegmentsFileName
String
return
segmentsFileName
getFileNames
Collection
return
files
getDirectory
Directory
return
dir
getVersion
long
return
version
getGeneration
long
return
generation
isDeleted
boolean
return
IndexCommit
getIndexCommit
IndexCommit
return
ReaderCommit
segmentInfos
directory
listCommits
Collection
dir
Directory
String
files
list
if
files
throw
IOException
dir
Collection
commits
ArrayList
SegmentInfos
latest
SegmentInfos
read
dir
long
currentGen
getGeneration
add
ReaderCommit
latest
dir
for
forControl
int
i
i
length
i
block
String
fileName
files
i
if
startsWith
SEGMENTS
equals
SEGMENTS_GEN
generationFromSegmentsFileName
fileName
currentGen
block
SegmentInfos
sis
SegmentInfos
try
read
dir
fileName
catchClause
fnfe
sis
if
sis
add
ReaderCommit
sis
dir
return
commits
IndexReader
