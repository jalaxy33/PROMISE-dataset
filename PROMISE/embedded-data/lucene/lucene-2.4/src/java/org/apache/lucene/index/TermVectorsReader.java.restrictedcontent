TermVectorsReader
int
FORMAT_VERSION
int
FORMAT_VERSION2
int
FORMAT_UTF8_LENGTH_IN_BYTES
int
FORMAT_CURRENT
FORMAT_UTF8_LENGTH_IN_BYTES
int
FORMAT_SIZE
byte
STORE_POSITIONS_WITH_TERMVECTOR
byte
STORE_OFFSET_WITH_TERMVECTOR
FieldInfos
fieldInfos
IndexInput
tvx
IndexInput
tvd
IndexInput
tvf
int
size
int
numTotalDocs
int
docStoreOffset
int
format
TermVectorsReader
d
Directory
segment
String
fieldInfos
FieldInfos
d
segment
fieldInfos
BUFFER_SIZE
TermVectorsReader
d
Directory
segment
String
fieldInfos
FieldInfos
readBufferSize
int
d
segment
fieldInfos
readBufferSize
TermVectorsReader
d
Directory
segment
String
fieldInfos
FieldInfos
readBufferSize
int
docStoreOffset
int
size
int
boolean
success
try
if
fileExists
segment
VECTORS_INDEX_EXTENSION
block
tvx
openInput
segment
VECTORS_INDEX_EXTENSION
readBufferSize
format
checkValidFormat
tvx
tvd
openInput
segment
VECTORS_DOCUMENTS_EXTENSION
readBufferSize
int
tvdFormat
checkValidFormat
tvd
tvf
openInput
segment
VECTORS_FIELDS_EXTENSION
readBufferSize
int
tvfFormat
checkValidFormat
tvf
assert
format
tvdFormat
assert
format
tvfFormat
if
format
FORMAT_VERSION2
block
assert
length
FORMAT_SIZE
numTotalDocs
int
length
block
assert
length
FORMAT_SIZE
numTotalDocs
int
length
if
docStoreOffset
block
docStoreOffset
size
numTotalDocs
assert
size
numTotalDocs
size
block
docStoreOffset
docStoreOffset
size
size
assert
numTotalDocs
size
docStoreOffset
numTotalDocs
size
docStoreOffset
format
fieldInfos
fieldInfos
success
if
success
block
close
getTvdStream
IndexInput
return
tvd
getTvfStream
IndexInput
return
tvf
seekTvx
docNum
int
if
format
FORMAT_VERSION2
seek
docNum
docStoreOffset
FORMAT_SIZE
seek
docNum
docStoreOffset
FORMAT_SIZE
canReadRawDocs
boolean
return
format
FORMAT_UTF8_LENGTH_IN_BYTES
rawDocs
tvdLengths
int
tvfLengths
int
startDocID
int
numDocs
int
if
tvx
block
fill
tvdLengths
fill
tvfLengths
return
if
format
FORMAT_VERSION2
throw
IllegalStateException
seekTvx
startDocID
long
tvdPosition
readLong
seek
tvdPosition
long
tvfPosition
readLong
seek
tvfPosition
long
lastTvdPosition
tvdPosition
long
lastTvfPosition
tvfPosition
int
count
while
count
numDocs
block
int
docID
docStoreOffset
startDocID
count
assert
docID
numTotalDocs
if
docID
numTotalDocs
block
tvdPosition
readLong
tvfPosition
readLong
block
tvdPosition
length
tvfPosition
length
assert
count
numDocs
tvdLengths
count
int
tvdPosition
lastTvdPosition
tvfLengths
count
int
tvfPosition
lastTvfPosition
count
lastTvdPosition
tvdPosition
lastTvfPosition
tvfPosition
checkValidFormat
int
in
IndexInput
int
format
readInt
if
format
FORMAT_CURRENT
block
throw
CorruptIndexException
format
FORMAT_CURRENT
return
format
close
IOException
keep
if
tvx
try
close
catchClause
e
if
keep
keep
e
if
tvd
try
close
catchClause
e
if
keep
keep
e
if
tvf
try
close
catchClause
e
if
keep
keep
e
if
keep
throw
IOException
fillInStackTrace
size
int
return
size
get
docNum
int
field
String
mapper
TermVectorMapper
if
tvx
block
int
fieldNumber
fieldNumber
field
seekTvx
docNum
long
tvdPosition
readLong
seek
tvdPosition
int
fieldCount
readVInt
int
number
int
found
for
forControl
int
i
i
fieldCount
i
block
if
format
FORMAT_VERSION
number
readVInt
number
readVInt
if
number
fieldNumber
found
i
if
found
block
long
position
if
format
FORMAT_VERSION2
position
readLong
position
readVLong
for
forControl
int
i
i
found
i
position
readVLong
setDocumentNumber
docNum
readTermVector
field
position
mapper
block
block
get
TermFreqVector
docNum
int
field
String
ParallelArrayTermVectorMapper
mapper
ParallelArrayTermVectorMapper
get
docNum
field
mapper
return
materializeVector
readFields
String
fieldCount
int
int
number
String
fields
String
fieldCount
for
forControl
int
i
i
fieldCount
i
block
if
format
FORMAT_VERSION
number
readVInt
number
readVInt
fields
i
fieldName
number
return
fields
readTvfPointers
long
fieldCount
int
long
position
if
format
FORMAT_VERSION2
position
readLong
position
readVLong
long
tvfPointers
long
fieldCount
tvfPointers
position
for
forControl
int
i
i
fieldCount
i
block
position
readVLong
tvfPointers
i
position
return
tvfPointers
get
TermFreqVector
docNum
int
TermFreqVector
result
if
tvx
block
seekTvx
docNum
long
tvdPosition
readLong
seek
tvdPosition
int
fieldCount
readVInt
if
fieldCount
block
String
fields
readFields
fieldCount
long
tvfPointers
readTvfPointers
fieldCount
result
readTermVectors
docNum
fields
tvfPointers
block
return
result
get
docNumber
int
mapper
TermVectorMapper
if
tvx
block
seekTvx
docNumber
long
tvdPosition
readLong
seek
tvdPosition
int
fieldCount
readVInt
if
fieldCount
block
String
fields
readFields
fieldCount
long
tvfPointers
readTvfPointers
fieldCount
setDocumentNumber
docNumber
readTermVectors
fields
tvfPointers
mapper
block
readTermVectors
SegmentTermVector
docNum
int
fields
String
tvfPointers
long
SegmentTermVector
res
SegmentTermVector
length
for
forControl
int
i
i
length
i
block
ParallelArrayTermVectorMapper
mapper
ParallelArrayTermVectorMapper
setDocumentNumber
docNum
readTermVector
fields
i
tvfPointers
i
mapper
res
i
SegmentTermVector
materializeVector
return
res
readTermVectors
fields
String
tvfPointers
long
mapper
TermVectorMapper
for
forControl
int
i
i
length
i
block
readTermVector
fields
i
tvfPointers
i
mapper
readTermVector
field
String
tvfPointer
long
mapper
TermVectorMapper
seek
tvfPointer
int
numTerms
readVInt
if
numTerms
return
boolean
storePositions
boolean
storeOffsets
if
format
FORMAT_VERSION
block
byte
bits
readByte
storePositions
bits
STORE_POSITIONS_WITH_TERMVECTOR
storeOffsets
bits
STORE_OFFSET_WITH_TERMVECTOR
block
readVInt
storePositions
storeOffsets
setExpectations
field
numTerms
storeOffsets
storePositions
int
start
int
deltaLength
int
totalLength
byte
byteBuffer
char
charBuffer
boolean
preUTF8
format
FORMAT_UTF8_LENGTH_IN_BYTES
if
preUTF8
block
charBuffer
char
byteBuffer
block
charBuffer
byteBuffer
byte
for
forControl
int
i
i
numTerms
i
block
start
readVInt
deltaLength
readVInt
totalLength
start
deltaLength
String
term
if
preUTF8
block
if
length
totalLength
block
char
newCharBuffer
char
int
totalLength
arraycopy
charBuffer
newCharBuffer
start
charBuffer
newCharBuffer
readChars
charBuffer
start
deltaLength
term
String
charBuffer
totalLength
block
if
length
totalLength
block
byte
newByteBuffer
byte
int
totalLength
arraycopy
byteBuffer
newByteBuffer
start
byteBuffer
newByteBuffer
readBytes
byteBuffer
start
deltaLength
term
String
byteBuffer
totalLength
int
freq
readVInt
int
positions
if
storePositions
block
if
isIgnoringPositions
block
positions
int
freq
int
prevPosition
for
forControl
int
j
j
freq
j
block
positions
j
prevPosition
readVInt
prevPosition
positions
j
block
for
forControl
int
j
j
freq
j
block
readVInt
TermVectorOffsetInfo
offsets
if
storeOffsets
block
if
isIgnoringOffsets
block
offsets
TermVectorOffsetInfo
freq
int
prevOffset
for
forControl
int
j
j
freq
j
block
int
startOffset
prevOffset
readVInt
int
endOffset
startOffset
readVInt
offsets
j
TermVectorOffsetInfo
startOffset
endOffset
prevOffset
endOffset
block
for
forControl
int
j
j
freq
j
block
readVInt
readVInt
map
term
freq
offsets
positions
clone
Object
TermVectorsReader
clone
TermVectorsReader
clone
if
tvx
tvd
tvf
block
tvx
IndexInput
clone
tvd
IndexInput
clone
tvf
IndexInput
clone
return
clone
Cloneable
ParallelArrayTermVectorMapper
String
terms
int
termFreqs
int
positions
TermVectorOffsetInfo
offsets
int
currentPosition
boolean
storingOffsets
boolean
storingPositions
String
field
setExpectations
field
String
numTerms
int
storeOffsets
boolean
storePositions
boolean
field
field
terms
String
numTerms
termFreqs
int
numTerms
storingOffsets
storeOffsets
storingPositions
storePositions
if
storePositions
positions
int
numTerms
if
storeOffsets
offsets
TermVectorOffsetInfo
numTerms
map
term
String
frequency
int
offsets
TermVectorOffsetInfo
positions
int
terms
currentPosition
term
termFreqs
currentPosition
frequency
if
storingOffsets
block
offsets
currentPosition
offsets
if
storingPositions
block
positions
currentPosition
positions
currentPosition
materializeVector
TermFreqVector
SegmentTermVector
tv
if
field
terms
block
if
storingPositions
storingOffsets
block
tv
SegmentTermPositionVector
field
terms
termFreqs
positions
offsets
block
tv
SegmentTermVector
field
terms
termFreqs
return
tv
TermVectorMapper
