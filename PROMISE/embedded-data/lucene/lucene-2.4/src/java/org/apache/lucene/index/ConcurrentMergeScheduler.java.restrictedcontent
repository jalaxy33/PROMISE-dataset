ConcurrentMergeScheduler
int
mergeThreadPriority
List
mergeThreads
ArrayList
int
maxThreadCount
List
exceptions
ArrayList
Directory
dir
boolean
closed
IndexWriter
writer
int
mergeThreadCount
ConcurrentMergeScheduler
if
allInstances
block
addMyself
setMaxThreadCount
count
int
if
count
throw
IllegalArgumentException
maxThreadCount
count
getMaxThreadCount
int
return
maxThreadCount
getMergeThreadPriority
int
initMergeThreadPriority
return
mergeThreadPriority
setMergeThreadPriority
pri
int
if
pri
MAX_PRIORITY
pri
MIN_PRIORITY
throw
IllegalArgumentException
MIN_PRIORITY
MAX_PRIORITY
mergeThreadPriority
pri
int
numThreads
mergeThreadCount
for
forControl
int
i
i
numThreads
i
block
MergeThread
merge
MergeThread
get
i
setThreadPriority
pri
message
message
String
if
writer
message
message
initMergeThreadPriority
if
mergeThreadPriority
block
mergeThreadPriority
currentThread
getPriority
if
mergeThreadPriority
MAX_PRIORITY
mergeThreadPriority
MAX_PRIORITY
close
closed
sync
while
mergeThreadCount
block
message
size
int
count
size
for
forControl
int
i
i
count
i
message
i
MergeThread
get
i
try
wait
catchClause
e
mergeThreadCount
int
int
count
int
numThreads
size
for
forControl
int
i
i
numThreads
i
if
MergeThread
get
i
count
return
count
merge
writer
IndexWriter
writer
writer
initMergeThreadPriority
dir
getDirectory
message
message
segString
while
block
MergePolicy
OneMerge
merge
getNextMerge
if
merge
block
message
return
mergeInit
merge
synchronized
while
mergeThreadCount
maxThreadCount
block
message
try
wait
catchClause
ie
currentThread
interrupt
message
segString
dir
assert
mergeThreadCount
maxThreadCount
MergeThread
merger
getMergeThread
writer
merge
add
merger
message
getName
start
doMerge
merge
MergePolicy
OneMerge
merge
merge
getMergeThread
MergeThread
writer
IndexWriter
merge
MergePolicy
OneMerge
MergeThread
thread
MergeThread
writer
merge
setThreadPriority
mergeThreadPriority
setDaemon
setName
mergeThreadCount
return
thread
MergeThread
IndexWriter
writer
MergePolicy
OneMerge
startMerge
MergePolicy
OneMerge
runningMerge
MergeThread
writer
IndexWriter
startMerge
MergePolicy
OneMerge
writer
writer
startMerge
startMerge
setRunningMerge
merge
MergePolicy
OneMerge
runningMerge
merge
getRunningMerge
MergePolicy
OneMerge
return
runningMerge
setThreadPriority
pri
int
try
setPriority
pri
catchClause
npe
catchClause
se
run
MergePolicy
OneMerge
merge
startMerge
try
message
while
block
setRunningMerge
merge
doMerge
merge
merge
getNextMerge
if
merge
block
mergeInit
merge
message
segString
dir
break
message
catchClause
exc
if
exc
MergePolicy
MergeAbortedException
block
synchronized
add
exc
if
suppressExceptions
block
anyExceptions
handleMergeException
exc
synchronized
notifyAll
boolean
removed
remove
assert
removed
toString
String
MergePolicy
OneMerge
merge
getRunningMerge
if
merge
merge
startMerge
return
segString
dir
Thread
handleMergeException
exc
Throwable
throw
MergePolicy
MergeException
exc
dir
boolean
anyExceptions
anyUnhandledExceptions
boolean
synchronized
allInstances
int
count
size
for
forControl
int
i
i
count
i
ConcurrentMergeScheduler
get
i
boolean
v
anyExceptions
anyExceptions
return
v
clearUnhandledExceptions
synchronized
allInstances
anyExceptions
addMyself
synchronized
allInstances
int
size
int
upto
for
forControl
int
i
i
size
i
block
ConcurrentMergeScheduler
other
ConcurrentMergeScheduler
get
i
if
closed
mergeThreadCount
set
upto
other
subList
clear
upto
size
add
boolean
suppressExceptions
setSuppressExceptions
suppressExceptions
clearSuppressExceptions
suppressExceptions
List
allInstances
setTestMode
allInstances
ArrayList
MergeScheduler
