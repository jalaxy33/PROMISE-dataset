MergeDocIDRemapper
int
starts
int
newStarts
int
docMaps
int
minDocID
int
maxDocID
int
docShift
MergeDocIDRemapper
infos
SegmentInfos
docMaps
int
delCounts
int
merge
MergePolicy
OneMerge
mergedDocCount
int
docMaps
docMaps
SegmentInfo
firstSegment
info
int
i
while
block
SegmentInfo
info
info
i
if
equals
firstSegment
break
minDocID
docCount
i
int
numDocs
for
forControl
int
j
j
length
i
j
block
numDocs
info
docCount
i
assert
info
equals
info
j
i
maxDocID
minDocID
numDocs
starts
int
length
newStarts
int
length
starts
minDocID
newStarts
minDocID
for
forControl
i
i
length
i
block
int
lastDocCount
info
docCount
i
starts
i
starts
i
lastDocCount
newStarts
i
newStarts
i
lastDocCount
delCounts
i
docShift
numDocs
mergedDocCount
assert
docShift
maxDocID
newStarts
length
info
docCount
length
delCounts
length
remap
int
oldDocID
int
if
oldDocID
minDocID
return
oldDocID
if
oldDocID
maxDocID
return
oldDocID
docShift
block
int
lo
int
hi
length
while
hi
lo
block
int
mid
lo
hi
int
midValue
starts
mid
if
oldDocID
midValue
hi
mid
if
oldDocID
midValue
lo
mid
block
while
mid
length
starts
mid
midValue
block
mid
if
docMaps
mid
return
newStarts
mid
docMaps
mid
oldDocID
starts
mid
return
newStarts
mid
oldDocID
starts
mid
if
docMaps
hi
return
newStarts
hi
docMaps
hi
oldDocID
starts
hi
return
newStarts
hi
oldDocID
starts
hi
