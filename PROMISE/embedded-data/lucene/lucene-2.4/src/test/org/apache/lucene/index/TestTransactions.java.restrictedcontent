TestTransactions
Random
RANDOM
Random
boolean
doFail
RandomFailure
eval
dir
MockRAMDirectory
if
doFail
nextInt
throw
IOException
MockRAMDirectory
Failure
TimedThread
boolean
failed
int
RUN_TIME_SEC
TimedThread
allThreads
doWork
TimedThread
threads
TimedThread
allThreads
threads
run
long
stopTime
currentTimeMillis
RUN_TIME_SEC
try
while
currentTimeMillis
stopTime
anyErrors
doWork
catchClause
e
println
currentThread
printStackTrace
out
failed
anyErrors
boolean
for
forControl
int
i
i
length
i
if
allThreads
i
allThreads
i
failed
return
return
Thread
IndexerThread
Directory
dir1
Directory
dir2
Object
lock
int
nextID
IndexerThread
lock
Object
dir1
Directory
dir2
Directory
threads
TimedThread
threads
lock
lock
dir1
dir1
dir2
dir2
doWork
IndexWriter
writer1
IndexWriter
dir1
WhitespaceAnalyzer
LIMITED
setMaxBufferedDocs
setMergeFactor
ConcurrentMergeScheduler
getMergeScheduler
IndexWriter
writer2
IndexWriter
dir2
WhitespaceAnalyzer
LIMITED
setMaxBufferedDocs
setMergeFactor
ConcurrentMergeScheduler
getMergeScheduler
update
writer1
update
writer2
doFail
try
synchronized
lock
try
prepareCommit
catchClause
t
rollback
rollback
return
try
prepareCommit
catchClause
t
rollback
rollback
return
commit
commit
doFail
close
close
update
writer
IndexWriter
for
forControl
int
j
j
j
block
Document
d
Document
int
n
nextInt
add
Field
toString
nextID
YES
NOT_ANALYZED
add
Field
intToEnglish
n
NO
ANALYZED
addDocument
d
int
deleteID
nextID
for
forControl
int
j
j
j
block
deleteDocuments
Term
deleteID
deleteID
TimedThread
SearcherThread
Directory
dir1
Directory
dir2
Object
lock
SearcherThread
lock
Object
dir1
Directory
dir2
Directory
threads
TimedThread
threads
lock
lock
dir1
dir1
dir2
dir2
doWork
IndexReader
r1
r2
synchronized
lock
r1
open
dir1
r2
open
dir2
if
numDocs
numDocs
throw
RuntimeException
numDocs
numDocs
close
close
TimedThread
initIndex
dir
Directory
IndexWriter
writer
IndexWriter
dir
WhitespaceAnalyzer
LIMITED
for
forControl
int
j
j
j
block
Document
d
Document
int
n
nextInt
add
Field
intToEnglish
n
NO
ANALYZED
addDocument
d
close
testTransactions
MockRAMDirectory
dir1
MockRAMDirectory
MockRAMDirectory
dir2
MockRAMDirectory
setPreventDoubleWrite
setPreventDoubleWrite
failOn
RandomFailure
failOn
RandomFailure
initIndex
dir1
initIndex
dir2
TimedThread
threads
TimedThread
int
numThread
IndexerThread
indexerThread
IndexerThread
dir1
dir2
threads
threads
numThread
indexerThread
start
SearcherThread
searcherThread1
SearcherThread
dir1
dir2
threads
threads
numThread
searcherThread1
start
SearcherThread
searcherThread2
SearcherThread
dir1
dir2
threads
threads
numThread
searcherThread2
start
for
forControl
int
i
i
numThread
i
threads
i
join
for
forControl
int
i
i
numThread
i
assertTrue
TimedThread
threads
i
LuceneTestCase
