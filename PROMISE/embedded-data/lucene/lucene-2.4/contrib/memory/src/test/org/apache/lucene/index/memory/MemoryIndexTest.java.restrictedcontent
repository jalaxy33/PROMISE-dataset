MemoryIndexTest
Analyzer
analyzer
boolean
fastMode
boolean
verbose
String
FIELD_NAME
main
args
String
run
args
MemoryIndexTest
String
fileDir
setUp
fileDir
getProperty
testMany
String
files
listFiles
String
println
asList
files
String
xargs
String
String
args
String
length
length
arraycopy
xargs
args
length
arraycopy
files
args
length
length
run
args
run
args
String
int
k
int
iters
if
length
k
iters
max
parseInt
args
k
int
runs
if
length
k
runs
max
parseInt
args
k
String
cmd
if
length
k
cmd
args
k
boolean
useMemIndex
indexOf
boolean
useRAMIndex
indexOf
String
queries
if
length
k
block
String
arg
args
k
if
startsWith
queries
readLines
File
fileDir
substring
queries
String
arg
File
files
File
File
File
if
length
k
block
files
File
length
k
for
forControl
int
i
k
i
length
i
block
files
i
k
File
args
i
boolean
toLowerCase
Set
stopWords
makeStopSet
ENGLISH_STOP_WORDS
Analyzer
analyzers
Analyzer
SimpleAnalyzer
StopAnalyzer
StandardAnalyzer
DEFAULT_ANALYZER
for
forControl
int
iter
iter
iters
iter
block
println
iter
long
start
currentTimeMillis
long
bytes
for
forControl
int
anal
anal
length
anal
block
analyzer
analyzers
anal
for
forControl
int
i
i
length
i
block
File
file
files
i
if
exists
isDirectory
continue
bytes
length
String
text
toString
FileInputStream
file
Document
doc
createDocument
text
if
verbose
println
file
for
forControl
int
q
q
length
q
block
try
Query
query
parseQuery
queries
q
boolean
measureIndexing
MemoryIndex
memind
if
useMemIndex
measureIndexing
memind
createMemoryIndex
doc
RAMDirectory
ramind
if
useRAMIndex
measureIndexing
ramind
createRAMIndex
doc
for
forControl
int
run
run
runs
run
block
float
score1
float
score2
if
useMemIndex
measureIndexing
memind
createMemoryIndex
doc
if
useMemIndex
score1
query
memind
query
if
useRAMIndex
measureIndexing
ramind
createRAMIndex
doc
if
useRAMIndex
score2
query
ramind
query
if
useMemIndex
useRAMIndex
block
if
verbose
println
score1
score2
queries
q
score1
score2
if
score1
score2
score1
score2
score1
score2
block
throw
IllegalStateException
i
q
queries
q
file
analyzer
catchClause
t
if
t
OutOfMemoryError
printStackTrace
println
queries
q
file
analyzer
throw
t
long
end
currentTimeMillis
println
end
start
println
runs
length
length
length
end
start
float
mb
bytes
length
runs
println
mb
end
start
if
useMemIndex
useRAMIndex
println
println
readLines
String
file
File
BufferedReader
reader
BufferedReader
InputStreamReader
FileInputStream
file
List
lines
ArrayList
String
line
while
line
readLine
block
String
t
trim
if
length
charAt
startsWith
block
add
line
close
String
result
String
size
toArray
result
return
result
createDocument
Document
content
String
Document
doc
Document
add
Field
FIELD_NAME
content
NO
ANALYZED
WITH_POSITIONS
return
doc
createMemoryIndex
MemoryIndex
doc
Document
MemoryIndex
index
MemoryIndex
Iterator
iter
getFields
iterator
while
hasNext
block
Field
field
Field
next
addField
name
stringValue
analyzer
return
index
createRAMIndex
RAMDirectory
doc
Document
RAMDirectory
dir
RAMDirectory
IndexWriter
writer
try
writer
IndexWriter
dir
analyzer
UNLIMITED
addDocument
doc
optimize
return
dir
catchClause
e
throw
RuntimeException
e
try
if
writer
close
catchClause
e
throw
RuntimeException
e
query
float
index
Object
query
Query
Searcher
searcher
try
if
index
Directory
searcher
IndexSearcher
Directory
index
searcher
MemoryIndex
index
float
scores
float
search
query
HitCollector
collect
doc
int
score
float
scores
score
float
score
scores
return
score
catchClause
e
throw
RuntimeException
e
try
if
searcher
close
catchClause
e
throw
RuntimeException
e
getMemorySize
int
index
Object
if
index
Directory
block
try
Directory
dir
Directory
index
int
size
String
fileNames
list
for
forControl
int
i
i
length
i
block
size
fileLength
fileNames
i
return
size
catchClause
e
throw
RuntimeException
e
block
return
MemoryIndex
index
parseQuery
Query
expression
String
QueryParser
parser
QueryParser
FIELD_NAME
analyzer
return
parse
expression
listFiles
String
fileNames
String
LinkedHashSet
allFiles
LinkedHashSet
for
forControl
int
i
i
length
i
block
int
k
if
k
fileNames
i
indexOf
block
add
fileNames
i
block
String
prefix
fileNames
i
substring
k
if
length
prefix
String
suffix
fileNames
i
substring
k
File
files
listFiles
FilenameFilter
accept
boolean
dir
File
name
String
return
endsWith
suffix
File
prefix
if
files
block
for
forControl
int
j
j
length
j
block
add
files
j
getPath
String
result
String
size
toArray
result
return
result
Charset
DEFAULT_PLATFORM_CHARSET
forName
getEncoding
InputStreamReader
ByteArrayInputStream
byte
toString
String
input
InputStream
charset
Charset
if
charset
charset
DEFAULT_PLATFORM_CHARSET
byte
data
toByteArray
input
return
decode
toString
wrap
data
toByteArray
byte
input
InputStream
try
int
len
max
available
byte
buffer
byte
len
byte
output
byte
len
len
int
n
while
n
read
buffer
block
if
len
n
length
block
byte
tmp
byte
max
length
len
n
arraycopy
output
tmp
len
arraycopy
buffer
tmp
len
n
buffer
output
output
tmp
block
arraycopy
buffer
output
len
n
len
n
if
len
length
return
output
buffer
buffer
byte
len
arraycopy
output
buffer
len
return
buffer
if
input
close
TestCase
