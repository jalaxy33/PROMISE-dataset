<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Frequently Asked Questions</title>
<link type="text/css" href="skin/page.css" rel="stylesheet">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Navigation Path ==================-->
<table summary="navigation path" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td nowrap="nowrap" valign="middle" bgcolor="#CFDCED" height="20"><img height="1" width="5" alt="" src="skin/images/spacer.gif" class="spacer"><!--===== breadcrumb trail (javascript-generated) ====--><font size="2" face="Arial, Helvetica, Sans-serif"><script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script></font></td>
</tr>
<tr>
<td bgcolor="#4C6C8F" height="2"><img height="2" width="2" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
<!--================= end Navigation Path ==================-->
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td bgcolor="#294563"><a href="http://jakarta.apache.org"><img border="0" class="logoImage" alt="Jakarta" src="resources/images/group-logo.gif"></a></td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" align="center" bgcolor="#294563"><a href="http://jakarta.apache.org/poi/"><img border="0" class="logoImage" alt="POI" src="resources/images/project-logo.gif"></a></td>
<!--================= end Project Logo ==================-->
<!--================= start Search ==================--><td valign="top" rowspan="2" bgcolor="#294563">
<form target="_blank" action="http://www.google.com/search" method="get">
<table summary="search" border="0" cellspacing="0" cellpadding="0" bgcolor="#4C6C8F">
<tr>
<td colspan="3"><img height="10" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap"><input value="jakarta.apache.org" name="sitesearch" type="hidden"><input size="15" name="q" id="query" type="text"><img height="1" width="5" alt="" src="skin/images/spacer.gif" class="spacer"><input name="Search" value="Search" type="submit">
<br>
<font face="Arial, Helvetica, Sans-serif" size="2" color="white">
                      the jakarta site
                      
                      
                    </font></td><td><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img alt="" border="0" height="10" width="9" src="skin/images/search-left.gif"></td><td><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td><img alt="" border="0" height="10" width="9" src="skin/images/search-right.gif"></td>
</tr>
</table>
</form>
</td>
<!--================= start Search ==================--><td bgcolor="#294563"><img height="10" width="10" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" bgcolor="#294563" colspan="2">
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="6"><img alt="" height="8" width="6" src="skin/images/spacer.gif"></td><td valign="bottom">
<table summary="selected tab" style="height: 1.8em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="skin/images/tabSel-left.gif"></td><td valign="middle" bgcolor="#4C6C8F"><font color="#ffffff" size="2" face="Arial, Helvetica, Sans-serif"><b><a class="base-selected" href="index.html">Home</a></b></font></td><td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="skin/images/tabSel-right.gif"></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td><td bgcolor="#294563"><img alt="" width="1" height="1" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td bgcolor="#4C6C8F" colspan="4"><img width="1" height="10" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
<!--================= end Banner ==================-->
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<td rowspan="3" valign="top">
<table summary="blue line" border="0" cellpadding="0" cellspacing="0">
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td bgcolor="#CFDCED"><font color="#4C6C8F" size="4" face="Arial, Helvetica, Sans-serif">&nbsp;</font></td>
</tr>
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td>
<!--================= end left top NavBar ==================--><td bgcolor="#294563"><img width="1" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap" valign="top" bgcolor="#4C6C8F">
<!--================= start Menu items ==================-->
<div class="menu">
<ul>
<li>
<font color="#CFDCED">Community</font>
<ul>
        
<li>
<a href="news.html">News</a>
</li>
        
<li>
<a href="mirrors.html">Mirrors</a>
</li>
        
<li>
<a href="changes.html">Changes</a>
</li>
        
<li>
<a href="todo.html">To Do</a>
</li>
        
<li>
<a href="getinvolved/index.html">Get Involved</a>
</li>
        
<li>
<a href="http://jakarta.apache.org/site/mail.html">Mailing Lists</a>
</li>
        
<li>
<a href="plan/POI20Vision.html">Vision</a>
</li>
        
<li>
<a href="historyandfuture.html">History and Future</a>
</li>
        
<li>
<a href="who.html">Who We Are</a>
</li>
        
<li>
<a href="resolutions/index.html">Resolutions</a>
</li>
    
</ul>
</li>
<li>
<font color="#CFDCED">Marketing</font>
<ul>
        
<li>
<a href="casestudies.html">Case Studies</a>
</li>
    
</ul>
</li>
<li>
<font color="#CFDCED">Project</font>
<ul>
        
<li>
<a href="overview.html">Overview</a>
</li>
        
<li>
<a href="poifs/index.html">POIFS</a>
</li>
        
<li>
<a href="hssf/index.html">HSSF</a>
</li>
        
<li>
<a href="http://jakarta.apache.org/poi/hwpf/index.html">HWPF</a>
</li>
        
<li>
<a href="hpsf/index.html">HPSF</a>
</li>
        
<li>
<a href="utils/index.html">POI-Utils</a>
</li>
        
<li>
<a href="http://jakarta.apache.org/builds/jakarta-poi/">Download</a>
</li>
    
</ul>
</li>
<li>
<font color="#CFDCED">Docs</font>
<ul>
        
<li>
<a href="apidocs/index.html">Javadocs</a>
</li>
        
<li>
<span class="sel"><font color="#ffcc00">FAQ</font></span>
</li>
        
<li>
<a href="references/index.html">References</a>
</li>
        
<li>
<a href="howtobuild.html">How to Build</a>
</li>
    
</ul>
</li>
<li>
<font color="#CFDCED">Translations</font>
<ul>
        
<li>
<a href="trans/index.html">Index</a>
</li>
        
<li>
<a href="trans/guidelines.html">Guidelines</a>
</li>
        
<li>
<a href="trans/de/index.html">German</a>
</li>
        
<li>
<a href="trans/es/index.html">Spanish</a>
</li>
        
<li>
<a href="http://www.terra-intl.com/jakarta/poi/">Japanese</a>
</li>
    
</ul>
</li>
<li>
<font color="#CFDCED">Code</font>
<ul>
        
        
<li>
<a href="http://jakarta.apache.org/site/cvsindex.html">CVS</a>
</li>
        
<li>
<a href="changelog.html">CVS Changelog</a>
</li>
        
<li>
<a href="http://nagoya.apache.org/bugzilla/buglist.cgi?votes=1&product=POI&order=bugs.votes">Top Voted Bugs</a>
</li>
        
<li>
<a href="http://nagoya.apache.org/bugzilla/buglist.cgi?product=POI">Bug Database</a>
</li>
        
<li>
<a href="http://nagoya.apache.org/bugzilla/buglist.cgi?product=POI&short_desc=%5BPATCH%5D&short_desc_type=allwordssubstr">Patches</a>
</li>

        
<li>
<a href="junit/index.html">Junit Test Results</a>
</li>
        
<li>
<a href="jdepend/index.html">Dependency Metrics</a>
</li>
        
    
</ul>
</li>
</ul>
</div>
<!--================= end Menu items ==================-->
</td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="skin/images/spacer.gif" class="spacer"></td><td bgcolor="#294563"><img width="1" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" align="left" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="skin/images/menu-left.gif"></td><td bgcolor="#4C6C8F"><img height="10" width="10" alt="" src="skin/images/spacer.gif" class="spacer"></td><td valign="bottom" align="right" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="skin/images/menu-right.gif"></td>
</tr>
<tr>
<td height="1" bgcolor="#294563"><img width="1" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<!--================= start middle NavBar ==================-->
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td align="left" width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td align="left" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="skin/images/spacer.gif" class="spacer"></td><td align="right" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="skin/images/spacer.gif" class="spacer"></td><td width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end middle NavBar ==================-->
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td colspan="2" align="left" width="100%">
<div class="content">
<table class="title" summary="">
<tr>
<td valign="middle">
<h1>Frequently Asked Questions</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="faq.pdf"><img alt="PDF" src="skin/images/pdfdoc.gif" class="skin"><br>
          PDF</a></td>
</tr>
</table>
<a name="N10007"></a><a name="Questions"></a>
<h3>Questions</h3>
<div style="margin-left: 0 ; border: 2px">
<ol>
<li>
<a name="faq-N10006-menu"></a><a href="#faq-N10006">
          Why is reading a simple sheet taking so long?
        </a>
</li>
<li>
<a name="faq-N10012-menu"></a><a href="#faq-N10012">
          What is the HSSF "eventmodel"?
        </a>
</li>
<li>
<a name="faq-N1001E-menu"></a><a href="#faq-N1001E">
          Why can't read the document I created using Star Office 5.1?
        </a>
</li>
<li>
<a name="faq-N1002A-menu"></a><a href="#faq-N1002A">
            Why am I getting an exception each time I attempt to read my spreadsheet?
        </a>
</li>
<li>
<a name="faq-N10036-menu"></a><a href="#faq-N10036">
            Does HSSF support protected spreadsheets?
        </a>
</li>
<li>
<a name="faq-N10042-menu"></a><a href="#faq-N10042">
            How do you tell if a field contains a date with HSSF?
        </a>
</li>
<li>
<a name="faq-N10052-menu"></a><a href="#faq-N10052">
            I'm trying to stream an XLS file from a servlet and I'm having some trouble.  What's the problem?
        </a>
</li>
<li>
<a name="faq-N1007C-menu"></a><a href="#faq-N1007C">
            I want to set a cell format (Data format of a cell) of a excel sheet as ###,###,###.#### or ###,###,###.0000.    Is it possible using POI ?
        </a>
</li>
<li>
<a name="faq-N1008C-menu"></a><a href="#faq-N1008C">
            I want to set a cell format (Data format of a cell) of a excel sheet as text.    Is it possible using POI ?
        </a>
</li>
<li>
<a name="faq-N10098-menu"></a><a href="#faq-N10098">
            How do I add a border around a merged cell?
        </a>
</li>
<li>
<a name="faq-N100A4-menu"></a><a href="#faq-N100A4">
            I tried to set cell values and Excel sheet name on my native language,
            but I failed to do it. :(
        </a>
</li>
<li>
<a name="faq-N100B7-menu"></a><a href="#faq-N100B7">
            I'm having trouble creating a spreadsheet using POI using
            websphere 3.5.
        </a>
</li>
<li>
<a name="faq-N100C3-menu"></a><a href="#faq-N100C3">
        I am using styles when creating a workbook in POI, but Excel refuses to open the file, complaining about "Too Many Styles".
	</a>
</li>
<li>
<a name="faq-N100DD-menu"></a><a href="#faq-N100DD">
            Will Poi read any spreadsheet and rewrite it with modifications.
        </a>
</li>
</ol>
</div>
<a name="N10052"></a><a name="Answers"></a>
<h3>Answers</h3>
<div style="margin-left: 0 ; border: 2px">
<a name="N10056"></a><a name="faq-N10006"></a>
<h4>1. 
          Why is reading a simple sheet taking so long?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>You've probably enabled logging.  Logging is intended only for
          autopsie style debugging.  Having it enabled will reduce performance
          by a factor of at least 100.  Logging is helpful for understanding
          why POI can't read some file or developing POI itself.  Important
          errors are thrown as exceptions, which means you probably don't need
          logging.</p>
</div>
<a name="N1005E"></a><a name="faq-N10012"></a>
<h4>2. 
          What is the HSSF "eventmodel"?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>The HSSF eventmodel package is a new API for reading XLS files more efficiently.  It does
              require more knowledge on the part of the user, but reduces memory consumption by more than
              tenfold.  It is based on the AWT event model in combination with SAX.  If you need read-only
              access to a given XLS file, this is the best way to do it.</p>
</div>
<a name="N10066"></a><a name="faq-N1001E"></a>
<h4>3. 
          Why can't read the document I created using Star Office 5.1?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>Star Office 5.1 writes some records using the older BIFF standard.  This causes some problems
              with POI which supports only BIFF8.</p>
</div>
<a name="N1006E"></a><a name="faq-N1002A"></a>
<h4>4. 
            Why am I getting an exception each time I attempt to read my spreadsheet?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>It's possible your spreadsheet contains a feature that is not currently supported by HSSF.
            For example - spreadsheets containing cells with rich text are not currently supported.</p>
</div>
<a name="N10076"></a><a name="faq-N10036"></a>
<h4>5. 
            Does HSSF support protected spreadsheets?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>Protecting a spreadsheet encrypts it.  We wont touch encryption because we're not legally educated
            and don't understand the full implications of trying to implement this.  If you wish to have a go
            at this feel free to add it as a plugin module.  We wont be hosting it here however.</p>
</div>
<a name="N1007E"></a><a name="faq-N10042"></a>
<h4>6. 
            How do you tell if a field contains a date with HSSF?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>Excel stores dates as numbers therefore the only way to determine if a cell is
            actually stored as a date is to look at the formatting. There is a helper method
            in HSSFDateUtil (since the 1.7.0-dev release) that checks for this.
            Thanks to Jason Hoffman for providing the solution.</p>
<pre class="code">
   case HSSFCell.CELL_TYPE_NUMERIC:
         double d = cell.getNumericCellValue();
         // test if a date!
         if (HSSFDateUtil.isCellDateFormatted(cell)) {
           // format in form of M/D/YY
           cal.setTime(HSSFDateUtil.getJavaDate(d));
           cellText =
             (String.valueOf(cal.get(Calendar.YEAR))).substring(2);
           cellText = cal.get(Calendar.MONTH)+1 + "/" +
                      cal.get(Calendar.DAY_OF_MONTH) + "/" +
                      cellText;
         } </pre>
</div>
<a name="N1008B"></a><a name="faq-N10052"></a>
<h4>7. 
            I'm trying to stream an XLS file from a servlet and I'm having some trouble.  What's the problem?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>
            The problem usually manifests itself as the junk characters being shown on
            screen. The problem persists even though you have set the correct mime type.
            </p>
<p>
            The short answer is, don't depend on IE to display a binary file type properly if you stream it via a
            servlet. Every minor version of IE has different bugs on this issue.
            </p>
<p>
            The problem in most versions of IE is that it does not use the mime type on
            the HTTP response to determine the file type; rather it uses the file extension
            on the request. Thus you might want to add a
                <strong>.xls</strong> to your request
            string. For example
                <em>http://yourserver.com/myServelet.xls?param1=xx</em>. This is
            easily accomplished through URL mapping in any servlet container. Sometimes
            a request like
                <em>http://yourserver.com/myServelet?param1=xx&amp;dummy=file.xls</em> is also
            known to work.

            </p>
<p>
            To guarantee opening the file properly in Excel from IE, write out your file to a
            temporary file under your web root from your servelet. Then send an http response
            to the browser to do a client side redirection to your temp file. (Note that using a 
            server side redirect using RequestDispatcher will not be effective in this case)
            </p>
<p>
            Note also that when you request a document that is opened with an
            external handler, IE sometimes makes two requests to the webserver. So if your
            generating process is heavy, it makes sense to write out to a temporary file, so that multiple
            requests happen for a static file.
            </p>
<p>
            None of this is particular to Excel. The same problem arises when you try to
            generate any binary file dynamically to an IE client. For example, if you generate
            pdf files using
                <a href="http://xml.apache.org/fop">FOP</a>, you will come across many of the same issues.

            </p>
</div>
<a name="N100AF"></a><a name="faq-N1007C"></a>
<h4>8. 
            I want to set a cell format (Data format of a cell) of a excel sheet as ###,###,###.#### or ###,###,###.0000.    Is it possible using POI ?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>
	   Yes.  You first need to get a HSSFDataFormat object from the workbook and call getFormat with the desired format.  Some examples are <a href="hssf/quick-guide.html#DataFormats">here</a>.
            </p>
</div>
<a name="N100BB"></a><a name="faq-N1008C"></a>
<h4>9. 
            I want to set a cell format (Data format of a cell) of a excel sheet as text.    Is it possible using POI ?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>
	   Yes.  This is a built-in format for excel that you can get from HSSFDataFormat object using the format string "@".  Also, the string "text" will alias this format.
            </p>
</div>
<a name="N100C3"></a><a name="faq-N10098"></a>
<h4>10. 
            How do I add a border around a merged cell?
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>Add blank cells around where the cells normally would have been and set the borders individually for each cell.
            We will probably enhance HSSF in the future to make this process easier.</p>
</div>
<a name="N100CB"></a><a name="faq-N100A4"></a>
<h4>11. 
            I tried to set cell values and Excel sheet name on my native language,
            but I failed to do it. :(
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>By default HSSF uses cell values and sheet names as compressed unicode,
            so to support localization you should use Unicode.
            To do it you should set it manually:</p>
<pre class="code">
                // for sheet name
                HSSFWorkbook wb = new HSSFWorkbook();
                HSSFSheet s = wb.createSheet();
                wb.setSheetName( 0, "SomeUnicodeName", HSSFWorkbook.ENCODING_UTF_16 );

                // for cell value
                HSSFRow r = s.createRow( 0 );
                HSSFCell c = r.createCell( (short)0 );
                c.setCellType( HSSFCell.CELL_TYPE_STRING );
                c.setEncoding( HSSFCell.ENCODING_UTF_16 );
                c.setCellValue( "\u0422\u0435\u0441\u0442\u043E\u0432\u0430\u044F" ); </pre>
<p>
                Make sure you make the call to setEncoding() before calling setCellValue(), otherwise what you pass in won't be interpreted properly.
            </p>
</div>
<a name="N100DB"></a><a name="faq-N100B7"></a>
<h4>12. 
            I'm having trouble creating a spreadsheet using POI using
            websphere 3.5.
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>Make sure you have fix pack 4 installed.</p>
</div>
<a name="N100E3"></a><a name="faq-N100C3"></a>
<h4>13. 
        I am using styles when creating a workbook in POI, but Excel refuses to open the file, complaining about "Too Many Styles".
	</h4>
<div style="margin-left: 0 ; border: 2px">
<p>You just create the styles OUTSIDE of the loop in which you create cells.</p>
<p>GOOD:</p>
<pre class="code">
 HSSFWorkbook wb = new HSSFWorkbook();
 HSSFSheet sheet = wb.createSheet("new sheet");
 HSSFRow row = null;

 // Aqua background
 HSSFCellStyle style = wb.createCellStyle();
 style.setFillBackgroundColor(HSSFColor.AQUA.index);
 style.setFillPattern(HSSFCellStyle.BIG_SPOTS);
 HSSFCell cell = row.createCell((short) 1);
 cell.setCellValue("X");
 cell.setCellStyle(style);

 // Orange "foreground", foreground being the fill foreground not the font color.
 style = wb.createCellStyle();
 style.setFillForegroundColor(HSSFColor.ORANGE.index);
 style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);

 for (int x = 0; x &lt; 1000; x++) {

 // Create a row and put some cells in it. Rows are 0 based.
	 row = sheet.createRow((short) k);

	 for (int y = 0; y &lt; 100; y++) {
		cell = row.createCell((short) k);
 		cell.setCellValue("X");
		cell.setCellStyle(style);
	 }
 }

 // Write the output to a file
 FileOutputStream fileOut = new FileOutputStream("workbook.xls");
 wb.write(fileOut);
 fileOut.close(); </pre>
<p>BAD:</p>
<pre class="code">
 HSSFWorkbook wb = new HSSFWorkbook();
 HSSFSheet sheet = wb.createSheet("new sheet");
 HSSFRow row = null;

 for (int x = 0; x &lt; 1000; x++) {
	 // Aqua background
	 HSSFCellStyle style = wb.createCellStyle();
	 style.setFillBackgroundColor(HSSFColor.AQUA.index);
	 style.setFillPattern(HSSFCellStyle.BIG_SPOTS);
	 HSSFCell cell = row.createCell((short) 1);
	 cell.setCellValue("X");
	 cell.setCellStyle(style);

	 // Orange "foreground", foreground being the fill foreground not the font color.
	 style = wb.createCellStyle();
	 style.setFillForegroundColor(HSSFColor.ORANGE.index);
	 style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);

	 // Create a row and put some cells in it. Rows are 0 based.
	 row = sheet.createRow((short) k);

	 for (int y = 0; y &lt; 100; y++) {
		 cell = row.createCell((short) k);
		 cell.setCellValue("X");
		 cell.setCellStyle(style);
	 }
 }

 // Write the output to a file
 FileOutputStream fileOut = new FileOutputStream("workbook.xls");
 wb.write(fileOut);
 fileOut.close(); </pre>
</div>
<a name="N100FB"></a><a name="faq-N100DD"></a>
<h4>14. 
            Will Poi read any spreadsheet and rewrite it with modifications.
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>Poi is not guanteed to read the contents of any spreadsheet.
                Certain features may cause spreadsheets to fail to read.  More
                problematic is rewriting spreadsheets.  Poi tried hard to
                preserve the records of the original spreadsheet but some
                features may cause problems.  We advise that you limit the
                formatting of spreadsheets you process so as to not be
                unpleasantly suprised at a later stage.</p>
</div>
</div>
<div class="attribution"></div>
</div>
</td><td width="10"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1" bgcolor="#4C6C8F"><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"><a href="skin/images/label.gif"></a><a href="skin/images/page.gif"></a><a href="skin/images/chapter.gif"></a><a href="skin/images/chapter_open.gif"></a><a href="skin/images/current.gif"></a><a href="/favicon.ico"></a></td>
</tr>
<tr>
<td colspan="2" bgcolor="#CFDCED" class="copyright" align="center"><font size="2" face="Arial, Helvetica, Sans-Serif">Copyright &copy;
          2003&nbsp;The Apache Software Foundation. All rights reserved.<script type="text/javascript" language="JavaScript"><!--
              document.write(" - "+"Last Published: " + document.lastModified);
            //  --></script></font></td>
</tr>
<tr>
<td colspan="2" align="left" bgcolor="#CFDCED" class="logos"></td>
</tr>
</table>
<!--================= end Footer ==================-->
</body>
</html>
