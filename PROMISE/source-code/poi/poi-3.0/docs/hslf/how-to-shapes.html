<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--*** This is a generated file.  Do not edit.  ***-->
<link rel="stylesheet" href="../skin/tigris.css" type="text/css">
<link rel="stylesheet" href="../skin/mysite.css" type="text/css">
<link rel="stylesheet" href="../skin/site.css" type="text/css">
<link media="print" rel="stylesheet" href="../skin/print.css" type="text/css">
<title>Busy Developers' Guide to HSLF drawing layer</title>
</head>
<body bgcolor="white" class="composite">
<!--================= start Banner ==================-->
<div id="banner">
<table width="100%" cellpadding="8" cellspacing="0" summary="banner" border="0">
<tbody>
<tr>
<!--================= start Group Logo ==================-->
<td align="left">
<div class="groupLogo">
<a href="http://jakarta.apache.org"><img border="0" class="logoImage" alt="Jakarta" src="../resources/images/group-logo.gif"></a>
</div>
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td align="right">
<div class="projectLogo">
<a href="http://jakarta.apache.org/poi/"><img border="0" class="logoImage" alt="POI" src="../resources/images/project-logo.gif"></a>
</div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</tbody>
</table>
</div>
<!--================= end Banner ==================-->
<!--================= start Main ==================-->
<table width="100%" cellpadding="0" cellspacing="0" border="0" summary="nav" id="breadcrumbs">
<tbody>
<!--================= start Status ==================-->
<tr class="status">
<td>
<!--================= start BreadCrumb ==================--><a href="http://www.apache.org/">Apache</a> | <a href="http://jakarta.apache.org/">Jakarta</a> | <a href="http://jakarta.apache.org/poi/">POI</a>
<!--================= end BreadCrumb ==================--></td><td id="tabs">
<!--================= start Tabs ==================-->
<div class="tab">
<span class="selectedTab"><a class="base-selected" href="../index.html">Home</a></span> | <script language="Javascript" type="text/javascript">
function printit() {  
if (window.print) {
    window.print() ;  
} else {
    var WebBrowser = '<OBJECT ID="WebBrowser1" WIDTH="0" HEIGHT="0" CLASSID="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"></OBJECT>';
document.body.insertAdjacentHTML('beforeEnd', WebBrowser);
    WebBrowser1.ExecWB(6, 2);//Use a 1 vs. a 2 for a prompting dialog box    WebBrowser1.outerHTML = "";  
}
}
</script><script language="Javascript" type="text/javascript">
var NS = (navigator.appName == "Netscape");
var VERSION = parseInt(navigator.appVersion);
if (VERSION > 3) {
    document.write('  <a title="PRINT this page OUT" href="javascript:printit()">PRINT</a>');
}
</script> | <a title="PDF file of this page" href="how-to-shapes.pdf">PDF</a>
</div>
<!--================= end Tabs ==================-->
</td>
</tr>
</tbody>
</table>
<!--================= end Status ==================-->
<table id="main" width="100%" cellpadding="8" cellspacing="0" summary="" border="0">
<tbody>
<tr valign="top">
<!--================= start Menu ==================-->
<td id="leftcol">
<div id="navcolumn">
<div class="menuBar">
<div class="menu">
<span class="menuLabel">Jakarta POI</span>
        
<div class="menuItem">
<a href="../index.html">Top</a>
</div>
    
</div>
<div class="menu">
<span class="menuLabel">HSLF</span>
        
<div class="menuItem">
<a href="index.html">Overview</a>
</div>
        
<div class="menuItem">
<a href="quick-guide.html">Quick Guide</a>
</div>
        
<div class="menuItem">
<span class="menuSelected">Shapes HowTo</span>
</div>
        
<div class="menuItem">
<a href="ppt-file-format.html">PPT File Format</a>
</div>
	
</div>
</div>
</div>
<form target="_blank" action="http://www.google.com/search" method="get">
<table summary="search" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap"><input value="jakarta.apache.org" name="sitesearch" type="hidden"><input size="10" name="q" id="query" type="text"><img height="1" width="5" alt="" src="../skin/images/spacer.gif" class="spacer"><input name="Search" value="GO" type="submit">
<br>
                          Search jakarta</td><td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td colspan="3"><img height="7" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td class="bottom-left-thick"></td><td bgcolor="#a5b6c6"><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td class="bottom-right-thick"></td>
</tr>
</table>
</form>
</td>
<!--================= end Menu ==================-->
<!--================= start Content ==================--><td>
<div id="bodycol">
<div class="app">
<div align="center">
<h1>Busy Developers' Guide to HSLF drawing layer</h1>
</div>
<div class="h3">
    
    
        
<div class="h3">
<h3>Busy Developers' Guide to HSLF drawing layer</h3>
</div>
             
<div class="h4">
<h4>Index of Features</h4>
</div>
                
<ul>
                    
<li>
<a href="#NewPresentation">How to create a new presentation and add new slides to it</a>
</li>
                    
<li>
<a href="#PageSize">How to retrieve or change slide size</a>
</li>
                    
<li>
<a href="#GetShapes">How to get shapes contained in a particular slide</a>
</li>
                    
<li>
<a href="#Shapes">Drawing a shape on a slide</a>
</li>
                    
<li>
<a href="#Pictures">How to work with pictures</a>
</li>
                    
<li>
<a href="#SlideTitle">How to set slide title</a>
</li>
                    
<li>
<a href="#Fill">How to work with slide/shape background</a>
</li>
                
</ul>
            
            
<div class="h4">
<h4>Features</h4>
</div>
                
<a name="NewPresentation"></a>
                
<div class="h2">
<h2>New Presentation</h2>
</div>
                  
<pre class="code">
    //create a new empty slide show
    SlideShow ppt = new SlideShow();

    //add first slide
    Slide s1 = ppt.createSlide();

    //add second slide
    Slide s2 = ppt.createSlide();
    
    //save changes in a file
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                 </pre>
                
                
<a name="PageSize"></a>
                
<div class="h2">
<h2>How to retrieve or change slide size</h2>
</div>
                    
<pre class="code">
    SlideShow ppt = new SlideShow(new HSLFSlideShow("slideshow.ppt"));
    //retrieve page size. Coordinates are expressed in points (72 dpi)
    java.awt.Dimension pgsize = ppt.getPageSize();
    int pgx = pgsize.width; //slide width
    int pgy = pgsize.height; //slide height

    //set new page size
    ppt.setPageSize(new java.awt.Dimension(1024, 768));
    //save changes 
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                  </pre>
                
                
<a name="GetShapes"></a>
                
<div class="h2">
<h2>How to get shapes contained in a particular slide</h2>
</div>
                  
<p>The superclass of all shapes in HSLF is the Shape class - the elemental object that composes a drawing.
                    The following pictute shows the class tree of HSLF shapes:
                  </p>
                  
<p>
			  
<img alt="Class Tree of HSLF Shapes" height="412" src="images/hslf_shapes.gif" width="611">
                  </p>
                  
<p>
                    The following fragment demonstrates how to iterate over shapes for each slide.
                  </p>
                    
<pre class="code">
  SlideShow ppt = new SlideShow(new HSLFSlideShow("slideshow.ppt"));
  //get slides 
  Slide[] slide = ppt.getSlides();
  for (int i = 0; i &lt; slide.length; i++){
    Shape[] sh = slide[i].getShapes();
    for (int j = 0; j &lt; sh.length; j++){
      //name of the shape
      String name = sh[j].getShapeName();

      //shapes's anchor which defines the position of this shape in the slide
      java.awt.Rectangle anchor = sh[j].getAnchor();

      if (sh[j] instanceof Line){
        Line line = (Line)sh[j];
        //work with Line
      } else if (sh[j] instanceof AutoShape){
        AutoShape shape = (AutoShape)sh[j];
        //work with AutoShape
      } else if (sh[j] instanceof TextBox){
        TextBox shape = (TextBox)sh[j];
        //work with TextBox
      } else if (sh[j] instanceof Picture){
        Picture shape = (Picture)sh[j];
        //work with Picture
      }
    }
  }
                  </pre>
                
                
<a name="Shapes"></a>
                
<div class="h2">
<h2>Drawing a shape on a slide</h2>
</div>
                   
<p>
                     When you add a shape, you usually specify the dimensions of the shape and the position
                     of the upper left corner of the bounding box for the shape relative to the upper left
                     corner of the slide. Distances in the drawing layer are measured in points (72 points = 1 inch).
                   </p>
                   
<pre class="code">
  SlideShow ppt = new SlideShow();

  Slide slide = ppt.createSlide();

  //Line shape
  Line line = new Line();
  line.setAnchor(new java.awt.Rectangle(50, 50, 100, 20));
  line.setLineColor(new Color(0, 128, 0));
  line.setLineStyle(Line.LINE_DOUBLE);
  slide.addShape(line);

  //TextBox
  TextBox txt = new TextBox();
  txt.setText("Hello, World!");
  txt.setAnchor(new java.awt.Rectangle(300, 100, 300, 50));

  //use RichTextRun to work with the text format
  RichTextRun rt = txt.getTextRun().getRichTextRuns()[0];
  rt.setFontSize(32);
  rt.setFontName("Arial");
  rt.setBold(true);
  rt.setItalic(true);
  rt.setUnderlined(true);
  rt.setFontColor(Color.red);
  rt.setAlignment(TextBox.AlignRight);

  slide.addShape(txt);

  //Autoshape
  //32-point star
  AutoShape sh1 = new AutoShape(ShapeTypes.Star32);
  sh1.setAnchor(new java.awt.Rectangle(50, 50, 100, 200));
  sh1.setFillColor(Color.red);
  slide.addShape(sh1);

  //Trapezoid
  AutoShape sh2 = new AutoShape(ShapeTypes.Trapezoid);
  sh2.setAnchor(new java.awt.Rectangle(150, 150, 100, 200));
  sh2.setFillColor(Color.blue);
  slide.addShape(sh2);

  FileOutputStream out = new FileOutputStream("slideshow.ppt");
  ppt.write(out);
  out.close();
                    
                  </pre>
                
                
<a name="Pictures"></a>
                
<div class="h2">
<h2>How to work with pictures</h2>
</div>
                 
  
<p>
  Currently, HSLF API supports the following types of pictures:
  </p>
  
<ul>
    
<li>Windows Metafiles (WMF)</li>
    
<li>Enhanced Metafiles (EMF)</li>
    
<li>JPEG Interchange Format</li>
    
<li>Portable Network Graphics (PNG)</li>
    
<li>Macintosh PICT</li>
  
</ul>

                    
<pre class="code">
  SlideShow ppt = new SlideShow(new HSLFSlideShow("slideshow.ppt"));

  //extract all pictures contained in the presentation
  PictureData[] pdata = ppt.getPictureData();
  for (int i = 0; i &lt; pdata.length; i++){
    PictureData pict = pdata[i];

    // picture data
    byte[] data = pict.getData();

    int type = pict.getType();
    String ext;
    switch (type){
      case Picture.JPEG: ext=".jpg"; break;
      case Picture.PNG: ext=".png"; break;
      case Picture.WMF: ext=".wmf"; break;
      case Picture.EMF: ext=".emf"; break;
      case Picture.PICT: ext=".pict"; break;
      default: continue;
    }
    FileOutputStream out = new FileOutputStream("pict_"+i + ext);
      out.write(data);
      out.close();

  }

  // add a new picture to this slideshow and insert it in a  new slide
  int idx = ppt.addPicture(new File("clock.jpg"), Picture.JPEG);

  Picture pict = new Picture(idx);

  //set image position in the slide
  pict.setAnchor(new java.awt.Rectangle(100, 100, 300, 200));

  Slide slide = ppt.createSlide();
  slide.addShape(pict);

  //now retrieve pictures containes in the first slide and save them on disk
  slide = ppt.getSlides()[0];
  Shape[] sh = slide.getShapes();
  for (int i = 0; i &lt; sh.length; i++){
    if (sh[i] instanceof Picture){
      Picture pict = (Picture)sh[i];
      PictureData pictData = pict.getPictureData();
      byte[] data = pictData.getData();
      int type = pictData.getType();
      if (type == Picture.JPEG){
        FileOutputStream out = new FileOutputStream("slide0_"+i+".jpg");
        out.write(data);
        out.close();
      } else if (type == Picture.PNG){
        FileOutputStream out = new FileOutputStream("slide0_"+i+".png");
        out.write(data);
        out.close();
      }
    }
  }

  FileOutputStream out = new FileOutputStream("slideshow.ppt");
  ppt.write(out);
  out.close();

                    </pre>
                
                
<a name="SlideTitle"></a>
                
<div class="h2">
<h2>How to set slide title</h2>
</div>
                    
<pre class="code">
    SlideShow ppt = new SlideShow();
    Slide slide = ppt.createSlide();
    TextBox title = slide.addTitle();
    title.setText("Hello, World!");
    
    //save changes 
    FileOutputStream out = new FileOutputStream("slideshow.ppt");
    ppt.write(out);
    out.close();
                  </pre>
                  
<p>
                    Below is the equivalent code in PowerPoint VBA:
                  </p>  
                  
<pre class="code">
    Set myDocument = ActivePresentation.Slides(1)
    myDocument.Shapes.AddTitle.TextFrame.TextRange.Text = "Hello, World!"
                  </pre>
                
                
<a name="Fill"></a>
                
<div class="h2">
<h2>How to modify background of a slide master</h2>
</div>
                    
<pre class="code">
        SlideShow ppt = new SlideShow();
        SlideMaster master = ppt.getSlidesMasters()[0];

        Fill fill = master.getBackground().getFill();
        int idx = ppt.addPicture(new File("background.png"), Picture.PNG);
        fill.setFillType(Fill.FILL_PICTURE);
        fill.setPictureData(idx);
                  </pre>
                
                
<div class="h2">
<h2>How to modify background of a slide</h2>
</div>
                    
<pre class="code">
        SlideShow ppt = new SlideShow();
        Slide slide = ppt.createSlide();
        
        //This slide has its own background. 
        //Without this line it will use master's background.
        slide.setFollowMasterBackground(false);
        Fill fill = slide.getBackground().getFill();
        int idx = ppt.addPicture(new File("background.png"), Picture.PNG);
        fill.setFillType(Fill.FILL_PATTERN);
        fill.setPictureData(idx);
                  </pre>
                
                
<div class="h2">
<h2>How to modify background of a shape</h2>
</div>
                    
<pre class="code">
        SlideShow ppt = new SlideShow();
        Slide slide = ppt.createSlide();
        
        Shape shape = new AutoShape(ShapeTypes.Rectangle);
        shape.setAnchor(new java.awt.Rectangle(100, 100, 200, 200));
        Fill fill = shape.getFill();
        fill.setFillType(Fill.FILL_SHADE);
        fill.setBackgroundColor(Color.red);
        fill.setForegroundColor(Color.green);
        
        slide.addShape(shape);
                  </pre>
                
                  
            
        
    

<div id="authors" align="right">by&nbsp;Yegor Kozlov</div>
</div>
</div>
</div>
</td>
<!--================= end Content ==================-->
</tr>
</tbody>
</table>
<!--================= end Main ==================-->
<!--================= start Footer ==================-->
<div id="footer">
<table summary="footer" cellspacing="0" cellpadding="4" width="100%" border="0">
<tbody>
<tr>
<!--================= start Copyright ==================-->
<td colspan="2">
<div align="center">
<div class="copyright">
              Copyright &copy; 2002-2006&nbsp;The Apache Software Foundation. All rights reserved.
            </div>
</div>
</td>
<!--================= end Copyright ==================-->
</tr>
<tr>
<td align="left">
<!--================= start Host ==================-->
<!--================= end Host ==================--></td><td align="right">
<!--================= start Credits ==================-->
<div align="right">
<div class="credit"></div>
</div>
<!--================= end Credits ==================-->
</td>
</tr>
</tbody>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
