<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--*** This is a generated file.  Do not edit.  ***-->
<link rel="stylesheet" href="../../skin/tigris.css" type="text/css">
<link rel="stylesheet" href="../../skin/mysite.css" type="text/css">
<link rel="stylesheet" href="../../skin/site.css" type="text/css">
<link media="print" rel="stylesheet" href="../../skin/print.css" type="text/css">
<title>Preguntas M Frecuentes (FAQ)</title>
</head>
<body bgcolor="white" class="composite">
<!--================= start Banner ==================-->
<div id="banner">
<table width="100%" cellpadding="8" cellspacing="0" summary="banner" border="0">
<tbody>
<tr>
<!--================= start Group Logo ==================-->
<td align="left">
<div class="groupLogo">
<a href="http://jakarta.apache.org"><img border="0" class="logoImage" alt="Jakarta" src="../../resources/images/group-logo.gif"></a>
</div>
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td align="right">
<div class="projectLogo">
<a href="http://jakarta.apache.org/poi/"><img border="0" class="logoImage" alt="POI" src="../../resources/images/project-logo.gif"></a>
</div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</tbody>
</table>
</div>
<!--================= end Banner ==================-->
<!--================= start Main ==================-->
<table width="100%" cellpadding="0" cellspacing="0" border="0" summary="nav" id="breadcrumbs">
<tbody>
<!--================= start Status ==================-->
<tr class="status">
<td>
<!--================= start BreadCrumb ==================--><a href="http://www.apache.org/">Apache</a> | <a href="http://jakarta.apache.org/">Jakarta</a> | <a href="http://jakarta.apache.org/poi/">POI</a>
<!--================= end BreadCrumb ==================--></td><td id="tabs">
<!--================= start Tabs ==================-->
<div class="tab">
<span class="selectedTab"><a class="base-selected" href="../../index.html">Home</a></span> | <script language="Javascript" type="text/javascript">
function printit() {  
if (window.print) {
    window.print() ;  
} else {
    var WebBrowser = '<OBJECT ID="WebBrowser1" WIDTH="0" HEIGHT="0" CLASSID="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"></OBJECT>';
document.body.insertAdjacentHTML('beforeEnd', WebBrowser);
    WebBrowser1.ExecWB(6, 2);//Use a 1 vs. a 2 for a prompting dialog box    WebBrowser1.outerHTML = "";  
}
}
</script><script language="Javascript" type="text/javascript">
var NS = (navigator.appName == "Netscape");
var VERSION = parseInt(navigator.appVersion);
if (VERSION > 3) {
    document.write('  <a title="PRINT this page OUT" href="javascript:printit()">PRINT</a>');
}
</script> | <a title="PDF file of this page" href="faq.pdf">PDF</a>
</div>
<!--================= end Tabs ==================-->
</td>
</tr>
</tbody>
</table>
<!--================= end Status ==================-->
<table id="main" width="100%" cellpadding="8" cellspacing="0" summary="" border="0">
<tbody>
<tr valign="top">
<!--================= start Menu ==================-->
<td id="leftcol">
<div id="navcolumn">
<div class="menuBar">
<div class="menu">
<span class="menuLabel">Apache POI</span>
        
<div class="menuItem">
<a href="index.html">TOP</a>
</div>
    
</div>
<div class="menu">
<span class="menuLabel">Marketing</span>
    
<div class="menuItem">
<a href="casestudies.html">Casos</a>
</div>
  
</div>
<div class="menu">
<span class="menuLabel">Proyecto</span>
    
<div class="menuItem">
<a href="overview.html">Descripci&oacute;n General</a>
</div>
    
<div class="menuItem">
<a href="../../poifs/index.html">POIFS [EN]</a>
</div>
    
<div class="menuItem">
<a href="../../hssf/index.html">HSSF [EN]</a>
</div>
    
<div class="menuItem">
<a href="../../hwpf/index.html">HWPF [EN]</a>
</div>
    
<div class="menuItem">
<a href="../../hpsf/index.html">HPSF [EN]</a>
</div>
    
<div class="menuItem">
<a href="../../utils/index.html">POI-Utils [EN]</a>
</div>
    
<div class="menuItem">
<a href="http://www.apache.org/dyn/closer.cgi/jakarta/poi/">Descargas</a>
</div>
  
</div>
<div class="menu">
<span class="menuLabel">Comunidad</span>
    
<div class="menuItem">
<a href="news.html">Noticias</a>
</div>    
    
<div class="menuItem">
<a href="../../mirrors.html">Espejos [EN]</a>
</div>    
    
<div class="menuItem">
<a href="../../changes.html">Cambios [EN]</a>
</div>
    
<div class="menuItem">
<a href="todo.html">Tareas</a>
</div> 
    
<div class="menuItem">
<a href="../../getinvolved/index.html">Contribuya [EN]</a>
</div>
    
<div class="menuItem">
<a href="http://jakarta.apache.org/site/mail2.html#poi">Listas de Correo</a>
</div>
    
<div class="menuItem">
<a href="../../plan/POI20Vision.html">Visi&oacute;n [EN]</a>
</div>
    
<div class="menuItem">
<a href="historyandfuture.html">Historia y Futuro</a>
</div>
    
<div class="menuItem">
<a href="who.html">Qui&eacute;nes Somos</a>
</div> 
    
<div class="menuItem">
<a href="../../resolutions/index.html">Resoluciones [EN]</a>
</div>    
  
</div>
<div class="menu">
<span class="menuLabel">Documentaci&oacute;n</span>
    
<div class="menuItem">
<a href="http://jakarta.apache.org/poi/javadocs/">Javadocs</a>
</div>  
    
<div class="menuItem">
<span class="menuSelected">FAQ</span>
</div>
    
<div class="menuItem">
<a href="../../references/index.html">Referencias</a>
</div>  
  
</div>
<div class="menu">
<span class="menuLabel">Traducciones</span>
    
<div class="menuItem">
<a href="../../trans/index.html">&Iacute;ndice</a>
</div>
    
<div class="menuItem">
<a href="../../trans/guidelines.html">Procedimientos</a>
</div>
        
<div class="menuItem">
<a href="../de/index.html">Alem&aacute;n (DE)</a>
</div>
    
<div class="menuItem">
<a href="index.html">Espa&ntilde;ol</a>
</div>
        
<div class="menuItem">
<a href="http://jakarta.terra-intl.com/poi/">Japon&eacute;s (Web)</a>
</div>
        
<div class="menuItem">
<a href="http://jakarta.apache-korea.org/poi/">Coreano(Web)</a>
</div>
  
</div>
<div class="menu">
<span class="menuLabel">C&oacute;digo</span>
           
    
<div class="menuItem">
<a href="http://jakarta.apache.org/site/cvsindex.html">CVS</a>
</div>  
        
    
<div class="menuItem">
<a href="http://issues.apache.org/bugzilla/buglist.cgi?votes=1&product=POI&order=bugs.votes">Fallos (Bugs) M&aacute;s Votados</a>
</div>
    
<div class="menuItem">
<a href="http://issues.apache.org/bugzilla/buglist.cgi?product=POI">Base de Datos de Fallos</a>
</div>
    
<div class="menuItem">
<a href="http://issues.apache.org/bugzilla/buglist.cgi?product=POI&short_desc=%5BPATCH%5D&short_desc_type=allwordssubstr">Parches</a>
</div>  

    
<div class="menuItem">
<a href="../../junit/index.html">Resultados de Pruebas Junit</a>
</div>  
    
<div class="menuItem">
<a href="../../jdepend/index.html">M&eacute;tricas de Dependencia</a>
</div> 
     
  
</div>
</div>
</div>
<form target="_blank" action="http://www.google.com/search" method="get">
<table summary="search" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img height="1" width="1" alt="" src="../../skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap"><input value="jakarta.apache.org" name="sitesearch" type="hidden"><input size="10" name="q" id="query" type="text"><img height="1" width="5" alt="" src="../../skin/images/spacer.gif" class="spacer"><input name="Search" value="GO" type="submit">
<br>
                          Search jakarta</td><td><img height="1" width="1" alt="" src="../../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td colspan="3"><img height="7" width="1" alt="" src="../../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td class="bottom-left-thick"></td><td bgcolor="#a5b6c6"><img height="1" width="1" alt="" src="../../skin/images/spacer.gif" class="spacer"></td><td class="bottom-right-thick"></td>
</tr>
</table>
</form>
</td>
<!--================= end Menu ==================-->
<!--================= start Content ==================--><td>
<div id="bodycol">
<div class="app">
<div align="center">
<h1>Preguntas M Frecuentes (FAQ)</h1>
</div>
<div class="h3">
<div class="h3">
<h3>Questions</h3>
</div>
<ol>
<li>
<a name="faq-N10006-menu"></a><a href="#faq-N10006">
          or qula lectura de una hoja de cculo simple lleva tanto tiempo?
        </a>
</li>
<li>
<a name="faq-N10012-menu"></a><a href="#faq-N10012">
          ues el "eventmodel" (modelo de evento) de HSSF?
        </a>
</li>
<li>
<a name="faq-N1001E-menu"></a><a href="#faq-N1001E">
          or quno puedo leer el documento que creutilizando Star Office 5.1?
        </a>
</li>
<li>
<a name="faq-N1002A-menu"></a><a href="#faq-N1002A">
            or qurecibo una excepci cada vez que intento leer mi hoja de cculo?
        </a>
</li>
<li>
<a name="faq-N10036-menu"></a><a href="#faq-N10036">
            oporta HSSF hojas de cculo protegidas?
        </a>
</li>
<li>
<a name="faq-N10042-menu"></a><a href="#faq-N10042">
            o se sabe si un campo contiene una fecha con HSSF?
        </a>
</li>
<li>
<a name="faq-N10052-menu"></a><a href="#faq-N10052">
            Estoy intentando ver un fichero XLS enviado como flujo (stream) desde un servlet y tengo
            complicaciones. u es el problema?
        </a>
</li>
<li>
<a name="faq-N1007C-menu"></a><a href="#faq-N1007C">
            Quiero dar formato a una celda (Data format of a cell) de una hoja excel como
            ###,###,###.#### o ###,###,###.0000. s posible hacer esto con POI?
        </a>
</li>
<li>
<a name="faq-N10092-menu"></a><a href="#faq-N10092">
            o ado un borde alrededor de una celda unida (merged)?
        </a>
</li>
<li>
<a name="faq-N1009E-menu"></a><a href="#faq-N1009E">
            Intentescribir valores en celdas ascomo cambiar el nombre de la hoja Excel
            en mi lengua nativa, pero no pude hacerlo. :(
        </a>
</li>
</ol>
<div class="h3">
<h3>Answers</h3>
</div>
<div class="h4">
<h4>1. 
          or qula lectura de una hoja de cculo simple lleva tanto tiempo?
        </h4>
</div>
          
<p>
          Probablemente hayas habilitado el registro (logging). Dicho registro es
          una herramienta il para la bqueda de errores (debug). Tenerlo habilitado
          reducirel rendimiento en un factor de al menos 100. El registro es il para
          comprender por quPOI no puede leer alg fichero o para el propio desarrollo
          de POI.
          Los errores importantes se lanzan como excepciones, lo cual significa que
          probablemente no necesites el registro (log).
          </p>
        
<div class="h4">
<h4>2. 
          ues el "eventmodel" (modelo de evento) de HSSF?
        </h4>
</div>
              
<p> El paquete "eventmodel" de HSSF es un nuevo API para la lectura m eficiente de ficheros
              XML. Requiere mayor conocimiento por parte del usuario, pero reduce el consumo de memoria a
              una dima parte. Estbasado en el modelo de eventos AWT en combinaci con SAX. Si necesita
              acceso de so-lectura a un fichero XML determinado, esta es la mejor manera de hacerlo.</p>
        
<div class="h4">
<h4>3. 
          or quno puedo leer el documento que creutilizando Star Office 5.1?
        </h4>
</div>
              
<p>Star Office 5.1 escribe algunos registros utilizando el viejo estdar BIFF.
              Esto provoca algunos problemas con POI que so soporta BIFF8.</p>
        
<div class="h4">
<h4>4. 
            or qurecibo una excepci cada vez que intento leer mi hoja de cculo?
        </h4>
</div>
            
<p>Es posible que su hoja de cculo contenga alguna caractertica que no est
            soportada actualmente por HSSF. Por ejemplo - hojas de cculo que contengan
            celdas con formato RTF (rich text) no est soportadas actualmente.</p>
        
<div class="h4">
<h4>5. 
            oporta HSSF hojas de cculo protegidas?
        </h4>
</div>
            
<p>Al proteger una hoja de cculo, ta se cifra. No tocaremos el cifrado, porque no
            tenemos el suficiente conocimiento legal y no estamos seguros de las implicaciones que
            conllevar el intentar implementar esto. Si desea intentarlo, es libre de hacerlo y
            de adirlo como un mulo enchufable (plugin). Sin embargo, no lo guardaremos aqu</p>
        
<div class="h4">
<h4>6. 
            o se sabe si un campo contiene una fecha con HSSF?
        </h4>
</div>
            
<p>Excel almacena las fechas como neros. Asla ica manera para determinar
            si una celda estrealmente almacenada como una fecha consiste en mirar su formato.
            Hay un modo de ayuda (helper) en HSSFDateUtil (desde la distribuci 1.7.0-dev)
            que lo comprueba. Gracias a Jason Hoffman por proporcionar la soluci.</p>
            
<pre class="code">

case HSSFCell.CELL_TYPE_NUMERIC:
                  double d = cell.getNumericCellValue();
                  // test if a date!
                             if (HSSFDateUtil.isCellDateFormatted(cell)) {
                    // format in form of M/D/YY
                    cal.setTime(HSSFDateUtil.getJavaDate(d));
                    cellText =
                      (String.valueOf(cal.get(Calendar.YEAR))).substring(2);
                    cellText = cal.get(Calendar.MONTH)+1 + "/" +
                               cal.get(Calendar.DAY_OF_MONTH) + "/" +
                               cellText;
                  }

            </pre>
        
<div class="h4">
<h4>7. 
            Estoy intentando ver un fichero XLS enviado como flujo (stream) desde un servlet y tengo
            complicaciones. u es el problema?
        </h4>
</div>
            
<p>
            El problema normalmente se manifiesta como un mont de caracteres basura
            en la pantalla. El problema persiste incluso aunque hayas configurado el tipo mime
            correcto.
            </p>
            
<p>
            La respuesta breve es: no dependas de IE para mostrar un fichero binario. 
            Escribe un documento adjunto como es debido si lo envs a trav de un servlet. 
            Toda versi de IE tiene diferentes fallos (bugs) en este sentido.
            </p>
            
<p>
            El problema en la mayor de las versiones de IE reside en que no utiliza el tipo mime
            de la respuesta HTTP para determinar el tipo de fichero; en su lugar utiliza la extensi
            del fichero en la petici. Aspodr adir un <strong>.xls</strong> a su cadena de petici.
            Por ejemplo: <em>http://yourserver.com/myServelet.xls?param1=xx</em>. Esto se consigue
            filmente a trav del mapeo de URL en cualquier contenedor servlet. A veces una
            petici como
                <em>http://yourserver.com/myServelet?param1=xx&amp;dummy=file.xls</em> 
            tambi funciona.
            </p>
            
<p>
            Para garantizar la correcta apertura del fichero en Excel desde IE, escribe
            tu fichero a un fichero temporal bajo su raiz web desde tu servlet. Env entonces
            una respuesta http al navegador para que haga una redirecci en el lado del cliente
            a tu fichero temporal. (Si haces una redirecci en el lado del servidor utilizando
            RequestDispatcher, tendr que adir .xls a la petici como se ha mendionado m
            arriba)
            </p>
            
<p>
            Date cuenta de que cuando pides un documento que se abre con un manejador externo,
            IE a veces realiza dos peticiones al servidor web. Asque si tu proceso generador
            es pesado, tiene sentido escribir a un fichero temporal, para que peticiones
            mtiples utilicen el fichero estico.
            </p>
            
<p>
            Nada de esto pertenece a Excel. El mismo problema ocurre cuando intentas general
            cualquier fichero binario dinicamente a un cliente IE. Por ejemplo, si generas
            ficheros pdf utilizando
                <a href="http://xml.apache.org/fop">FOP</a>,
                te encontrar con los mismos problemas.
            </p>
            
        
<div class="h4">
<h4>8. 
            Quiero dar formato a una celda (Data format of a cell) de una hoja excel como
            ###,###,###.#### o ###,###,###.0000. s posible hacer esto con POI?
        </h4>
</div>
            
<p>
                HSSF no soporta todav formatos de datos personalizados, sin embargo,
                deber ser una facilidad razonablemente sencilla de adir y aceptaremos
                gustosos contribuciones en este ea.
            </p>
            
<p>
                Estos son los formatos incluidos que soporta:
            </p>
            
<p>
            
<a href="http://jakarta.apache.org/poi/javadocs/javasrc/org/apache/poi/hssf/usermodel/HSSFDataFormat_java.html#HSSFDataFormat">http://jakarta.apache.org/poi/javadocs/javasrc/org/apache/poi/hssf/usermodel/HSSFDataFormat_java.html#HSSFDataFormat</a>
            
</p>
        
<div class="h4">
<h4>9. 
            o ado un borde alrededor de una celda unida (merged)?
        </h4>
</div>
            
<p>
            Ade celdas vacs alrededor de donde las celdas hubieran estado normalmente y
            configura los bordes individualmente para cada celda.
            Probablemente mejoraremos HSSF en el futuro para facilitar este proceso.
            </p>
        
<div class="h4">
<h4>10. 
            Intentescribir valores en celdas ascomo cambiar el nombre de la hoja Excel
            en mi lengua nativa, pero no pude hacerlo. :(
        </h4>
</div>
            
<p>
            Por defecto HSSF utiliza valores de celdas y nombres de hoja en unicode comprimido,
            asi que para soportar la localizaci debers utilizar Unicode.
            Para hacerlo debers configurarlo manualmente:
            </p>
            
<pre class="code">

                //
                // para el nombre de la hoja
                //
                HSSFWorkbook wb = new HSSFWorkbook();
                HSSFSheet s = wb.createSheet();
                wb.setSheetName( 0, "SomeUnicodeName", HSSFWorkbook.ENCODING_UTF_16 );


                //
                // para el valor de la celda
                //
                HSSFRow r = s.createRow( 0 );
                HSSFCell c = r.createCell( (short)0 );
                c.setCellType( HSSFCell.CELL_TYPE_STRING );
                c.setEncoding( HSSFCell.ENCODING_UTF_16 );
                c.setCellValue( "\u0422\u0435\u0441\u0442\u043E\u0432\u0430\u044F" );

            </pre>
            
<p>
            Asegate de que haces la llamada a setEncoding() antes de llamar a setCellValue(),
            si no, lo que le pases no serinterpretado correctamente.
            </p>
        
</div>
</div>
</div>
</td>
<!--================= end Content ==================-->
</tr>
</tbody>
</table>
<!--================= end Main ==================-->
<!--================= start Footer ==================-->
<div id="footer">
<table summary="footer" cellspacing="0" cellpadding="4" width="100%" border="0">
<tbody>
<tr>
<!--================= start Copyright ==================-->
<td colspan="2">
<div align="center">
<div class="copyright">
              Copyright &copy; 2002-2006&nbsp;The Apache Software Foundation. All rights reserved.
            </div>
</div>
</td>
<!--================= end Copyright ==================-->
</tr>
<tr>
<td align="left">
<!--================= start Host ==================-->
<!--================= end Host ==================--></td><td align="right">
<!--================= start Credits ==================-->
<div align="right">
<div class="credit"></div>
</div>
<!--================= end Credits ==================-->
</td>
</tr>
</tbody>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
