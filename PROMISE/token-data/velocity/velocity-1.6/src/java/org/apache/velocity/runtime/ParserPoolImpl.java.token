package
org
.
apache
.
velocity
.
runtime
;
import
org
.
apache
.
velocity
.
runtime
.
parser
.
Parser
;
import
org
.
apache
.
velocity
.
util
.
SimplePool
;
import
org
.
apache
.
velocity
.
runtime
.
parser
.
CharStream
;
public
class
ParserPoolImpl
implements
ParserPool
{
SimplePool
pool
=
null
;
int
max
=
RuntimeConstants
.
NUMBER_OF_PARSERS
;
public
void
initialize
(
RuntimeServices
rsvc
)
{
max
=
rsvc
.
getInt
(
RuntimeConstants
.
PARSER_POOL_SIZE
,
RuntimeConstants
.
NUMBER_OF_PARSERS
)
;
pool
=
new
SimplePool
(
max
)
;
for
(
int
i
=
0
;
i
<
max
;
i
++
)
{
pool
.
put
(
rsvc
.
createNewParser
(
)
)
;
}
if
(
rsvc
.
getLog
(
)
.
isDebugEnabled
(
)
)
{
rsvc
.
getLog
(
)
.
debug
(
"Created '"
+
max
+
"' parsers."
)
;
}
}
public
Parser
get
(
)
{
return
(
Parser
)
pool
.
get
(
)
;
}
public
void
put
(
Parser
parser
)
{
parser
.
ReInit
(
(
CharStream
)
null
)
;
pool
.
put
(
parser
)
;
}
}
