package
org
.
apache
.
xerces
.
dom
;
import
org
.
w3c
.
dom
.
*
;
public
class
DeferredTextImpl
extends
TextImpl
implements
DeferredNode
{
static
final
long
serialVersionUID
=
2310613872100393425L
;
protected
transient
int
fNodeIndex
;
DeferredTextImpl
(
DeferredDocumentImpl
ownerDocument
,
int
nodeIndex
)
{
super
(
ownerDocument
,
null
)
;
fNodeIndex
=
nodeIndex
;
syncData
=
true
;
}
public
int
getNodeIndex
(
)
{
return
fNodeIndex
;
}
protected
void
synchronizeData
(
)
{
syncData
=
false
;
DeferredDocumentImpl
ownerDocument
=
(
DeferredDocumentImpl
)
this
.
ownerDocument
;
value
=
ownerDocument
.
getNodeValueString
(
fNodeIndex
)
;
int
parent
=
-
1
;
if
(
getNodeType
(
)
==
Node
.
TEXT_NODE
&&
(
parent
=
ownerDocument
.
getParentNode
(
fNodeIndex
)
)
!=
-
1
&&
ownerDocument
.
getNodeType
(
parent
)
==
Node
.
ELEMENT_NODE
)
{
int
realNext
=
ownerDocument
.
getRealNextSibling
(
fNodeIndex
)
;
int
type
=
ownerDocument
.
getNodeType
(
realNext
)
;
if
(
realNext
!=
-
1
&&
type
==
Node
.
TEXT_NODE
)
{
StringBuffer
sb
=
new
StringBuffer
(
value
)
;
while
(
realNext
!=
-
1
&&
type
==
Node
.
TEXT_NODE
)
{
sb
.
append
(
ownerDocument
.
getNodeValueString
(
realNext
)
)
;
realNext
=
ownerDocument
.
getRealNextSibling
(
realNext
)
;
type
=
ownerDocument
.
getNodeType
(
realNext
)
;
}
value
=
sb
.
toString
(
)
;
}
}
ignorableWhitespace
=
ownerDocument
.
getFirstChild
(
fNodeIndex
)
==
1
;
}
}
