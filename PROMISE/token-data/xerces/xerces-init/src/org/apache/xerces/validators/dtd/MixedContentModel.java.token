package
org
.
apache
.
xerces
.
validators
.
dtd
;
public
class
MixedContentModel
implements
XMLContentModel
{
public
MixedContentModel
(
int
count
,
int
[
]
childList
)
throws
CMException
{
fCount
=
count
;
fChildren
=
new
int
[
fCount
]
;
System
.
arraycopy
(
childList
,
0
,
fChildren
,
0
,
count
)
;
}
public
int
validateContent
(
int
childCount
,
int
[
]
children
)
throws
Exception
{
for
(
int
outIndex
=
0
;
outIndex
<
childCount
;
outIndex
++
)
{
final
int
curChild
=
children
[
outIndex
]
;
if
(
curChild
==
-
1
)
continue
;
int
inIndex
=
0
;
for
(
;
inIndex
<
fCount
;
inIndex
++
)
{
if
(
curChild
==
fChildren
[
inIndex
]
)
break
;
}
if
(
inIndex
==
fCount
)
return
outIndex
;
}
return
-
1
;
}
public
int
whatCanGoHere
(
boolean
fullyValid
,
InsertableElementsInfo
info
)
throws
Exception
{
for
(
int
index
=
info
.
insertAt
;
index
<
info
.
childCount
;
index
++
)
info
.
curChildren
[
index
]
=
info
.
curChildren
[
index
+
1
]
;
info
.
childCount
--
;
final
int
failedIndex
=
validateContent
(
info
.
childCount
,
info
.
curChildren
)
;
if
(
(
failedIndex
!=
-
1
)
&&
(
failedIndex
<
info
.
insertAt
)
)
return
failedIndex
;
info
.
canHoldPCData
=
true
;
info
.
isValidEOC
=
true
;
info
.
resultsCount
=
fCount
;
if
(
(
info
.
results
==
null
)
||
(
info
.
results
.
length
<
info
.
resultsCount
)
)
info
.
results
=
new
boolean
[
info
.
resultsCount
]
;
if
(
(
info
.
possibleChildren
==
null
)
||
(
info
.
possibleChildren
.
length
<
info
.
resultsCount
)
)
{
info
.
possibleChildren
=
new
int
[
info
.
resultsCount
]
;
}
boolean
bStatus
=
true
;
if
(
fullyValid
&&
(
failedIndex
<
info
.
childCount
)
)
bStatus
=
false
;
for
(
int
index
=
0
;
index
<
fCount
;
index
++
)
{
info
.
possibleChildren
[
index
]
=
fChildren
[
index
]
;
info
.
results
[
index
]
=
bStatus
;
}
return
-
1
;
}
private
int
fCount
;
private
int
[
]
fChildren
;
}
;
