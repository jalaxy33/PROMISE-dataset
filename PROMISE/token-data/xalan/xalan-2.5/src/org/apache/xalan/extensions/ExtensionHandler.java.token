package
org
.
apache
.
xalan
.
extensions
;
import
java
.
io
.
IOException
;
import
java
.
lang
.
reflect
.
Method
;
import
java
.
util
.
Vector
;
import
javax
.
xml
.
transform
.
TransformerException
;
import
org
.
apache
.
xalan
.
templates
.
ElemTemplateElement
;
import
org
.
apache
.
xalan
.
templates
.
Stylesheet
;
import
org
.
apache
.
xalan
.
transformer
.
TransformerImpl
;
import
org
.
apache
.
xpath
.
functions
.
FuncExtFunction
;
public
abstract
class
ExtensionHandler
{
protected
String
m_namespaceUri
;
protected
String
m_scriptLang
;
private
static
final
Object
NO_OBJS
[
]
=
new
Object
[
0
]
;
private
static
Method
getCCL
;
static
{
try
{
getCCL
=
Thread
.
class
.
getMethod
(
"getContextClassLoader"
,
new
Class
[
0
]
)
;
}
catch
(
Exception
e
)
{
getCCL
=
null
;
}
}
public
static
Class
getClassForName
(
String
className
)
throws
ClassNotFoundException
{
Class
result
=
null
;
if
(
className
.
equals
(
"org.apache.xalan.xslt.extensions.Redirect"
)
)
className
=
"org.apache.xalan.lib.Redirect"
;
if
(
getCCL
!=
null
)
{
try
{
ClassLoader
contextClassLoader
=
(
ClassLoader
)
getCCL
.
invoke
(
Thread
.
currentThread
(
)
,
NO_OBJS
)
;
result
=
contextClassLoader
.
loadClass
(
className
)
;
}
catch
(
ClassNotFoundException
cnfe
)
{
result
=
Class
.
forName
(
className
)
;
}
catch
(
Exception
e
)
{
getCCL
=
null
;
result
=
Class
.
forName
(
className
)
;
}
}
else
result
=
Class
.
forName
(
className
)
;
return
result
;
}
protected
ExtensionHandler
(
String
namespaceUri
,
String
scriptLang
)
{
m_namespaceUri
=
namespaceUri
;
m_scriptLang
=
scriptLang
;
}
public
abstract
boolean
isFunctionAvailable
(
String
function
)
;
public
abstract
boolean
isElementAvailable
(
String
element
)
;
public
abstract
Object
callFunction
(
String
funcName
,
Vector
args
,
Object
methodKey
,
ExpressionContext
exprContext
)
throws
TransformerException
;
public
abstract
Object
callFunction
(
FuncExtFunction
extFunction
,
Vector
args
,
ExpressionContext
exprContext
)
throws
TransformerException
;
public
abstract
void
processElement
(
String
localPart
,
ElemTemplateElement
element
,
TransformerImpl
transformer
,
Stylesheet
stylesheetTree
,
Object
methodKey
)
throws
TransformerException
,
IOException
;
}
