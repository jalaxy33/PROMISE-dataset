package
org
.
apache
.
lucene
.
search
;
import
java
.
io
.
IOException
;
import
java
.
util
.
BitSet
;
import
org
.
apache
.
lucene
.
index
.
IndexReader
;
import
org
.
apache
.
lucene
.
util
.
OpenBitSet
;
public
class
QueryWrapperFilter
extends
Filter
{
private
Query
query
;
public
QueryWrapperFilter
(
Query
query
)
{
this
.
query
=
query
;
}
public
BitSet
bits
(
IndexReader
reader
)
throws
IOException
{
final
BitSet
bits
=
new
BitSet
(
reader
.
maxDoc
(
)
)
;
new
IndexSearcher
(
reader
)
.
search
(
query
,
new
HitCollector
(
)
{
public
final
void
collect
(
int
doc
,
float
score
)
{
bits
.
set
(
doc
)
;
}
}
)
;
return
bits
;
}
public
DocIdSet
getDocIdSet
(
IndexReader
reader
)
throws
IOException
{
final
OpenBitSet
bits
=
new
OpenBitSet
(
reader
.
maxDoc
(
)
)
;
new
IndexSearcher
(
reader
)
.
search
(
query
,
new
HitCollector
(
)
{
public
final
void
collect
(
int
doc
,
float
score
)
{
bits
.
set
(
doc
)
;
}
}
)
;
return
bits
;
}
public
String
toString
(
)
{
return
"QueryWrapperFilter("
+
query
+
")"
;
}
public
boolean
equals
(
Object
o
)
{
if
(
!
(
o
instanceof
QueryWrapperFilter
)
)
return
false
;
return
this
.
query
.
equals
(
(
(
QueryWrapperFilter
)
o
)
.
query
)
;
}
public
int
hashCode
(
)
{
return
query
.
hashCode
(
)
^
0x923F64B9
;
}
}
