package
org
.
apache
.
tools
.
ant
.
taskdefs
.
optional
.
javah
;
import
org
.
apache
.
tools
.
ant
.
BuildException
;
import
org
.
apache
.
tools
.
ant
.
ProjectComponent
;
import
org
.
apache
.
tools
.
ant
.
util
.
ClasspathUtils
;
import
org
.
apache
.
tools
.
ant
.
util
.
JavaEnvUtils
;
public
class
JavahAdapterFactory
{
public
static
String
getDefault
(
)
{
if
(
JavaEnvUtils
.
isKaffe
(
)
)
{
return
Kaffeh
.
IMPLEMENTATION_NAME
;
}
return
SunJavah
.
IMPLEMENTATION_NAME
;
}
public
static
JavahAdapter
getAdapter
(
String
choice
,
ProjectComponent
log
)
throws
BuildException
{
if
(
(
JavaEnvUtils
.
isKaffe
(
)
&&
choice
==
null
)
||
Kaffeh
.
IMPLEMENTATION_NAME
.
equals
(
choice
)
)
{
return
new
Kaffeh
(
)
;
}
else
if
(
SunJavah
.
IMPLEMENTATION_NAME
.
equals
(
choice
)
)
{
return
new
SunJavah
(
)
;
}
else
if
(
choice
!=
null
)
{
return
resolveClassName
(
choice
)
;
}
return
new
SunJavah
(
)
;
}
private
static
JavahAdapter
resolveClassName
(
String
className
)
throws
BuildException
{
return
(
JavahAdapter
)
ClasspathUtils
.
newInstance
(
className
,
JavahAdapterFactory
.
class
.
getClassLoader
(
)
,
JavahAdapter
.
class
)
;
}
}
