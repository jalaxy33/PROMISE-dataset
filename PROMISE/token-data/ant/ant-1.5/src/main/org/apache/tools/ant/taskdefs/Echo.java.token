package
org
.
apache
.
tools
.
ant
.
taskdefs
;
import
org
.
apache
.
tools
.
ant
.
Task
;
import
org
.
apache
.
tools
.
ant
.
Project
;
import
org
.
apache
.
tools
.
ant
.
BuildException
;
import
org
.
apache
.
tools
.
ant
.
types
.
EnumeratedAttribute
;
import
java
.
io
.
File
;
import
java
.
io
.
FileWriter
;
import
java
.
io
.
IOException
;
public
class
Echo
extends
Task
{
protected
String
message
=
""
;
protected
File
file
=
null
;
protected
boolean
append
=
false
;
protected
int
logLevel
=
Project
.
MSG_WARN
;
public
void
execute
(
)
throws
BuildException
{
if
(
file
==
null
)
{
log
(
message
,
logLevel
)
;
}
else
{
FileWriter
out
=
null
;
try
{
out
=
new
FileWriter
(
file
.
getAbsolutePath
(
)
,
append
)
;
out
.
write
(
message
,
0
,
message
.
length
(
)
)
;
}
catch
(
IOException
ioe
)
{
throw
new
BuildException
(
ioe
,
location
)
;
}
finally
{
if
(
out
!=
null
)
{
try
{
out
.
close
(
)
;
}
catch
(
IOException
ioex
)
{
}
}
}
}
}
public
void
setMessage
(
String
msg
)
{
this
.
message
=
msg
;
}
public
void
setFile
(
File
file
)
{
this
.
file
=
file
;
}
public
void
setAppend
(
boolean
append
)
{
this
.
append
=
append
;
}
public
void
addText
(
String
msg
)
{
message
+=
project
.
replaceProperties
(
msg
)
;
}
public
void
setLevel
(
EchoLevel
echoLevel
)
{
String
option
=
echoLevel
.
getValue
(
)
;
if
(
option
.
equals
(
"error"
)
)
{
logLevel
=
Project
.
MSG_ERR
;
}
else
if
(
option
.
equals
(
"warning"
)
)
{
logLevel
=
Project
.
MSG_WARN
;
}
else
if
(
option
.
equals
(
"info"
)
)
{
logLevel
=
Project
.
MSG_INFO
;
}
else
if
(
option
.
equals
(
"verbose"
)
)
{
logLevel
=
Project
.
MSG_VERBOSE
;
}
else
{
logLevel
=
Project
.
MSG_DEBUG
;
}
}
public
static
class
EchoLevel
extends
EnumeratedAttribute
{
public
String
[
]
getValues
(
)
{
return
new
String
[
]
{
"error"
,
"warning"
,
"info"
,
"verbose"
,
"debug"
}
;
}
}
}
