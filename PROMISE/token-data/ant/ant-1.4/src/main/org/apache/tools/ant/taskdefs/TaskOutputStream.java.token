package
org
.
apache
.
tools
.
ant
.
taskdefs
;
import
org
.
apache
.
tools
.
ant
.
*
;
import
java
.
io
.
*
;
public
class
TaskOutputStream
extends
OutputStream
{
private
Task
task
;
private
StringBuffer
line
;
private
int
msgOutputLevel
;
TaskOutputStream
(
Task
task
,
int
msgOutputLevel
)
{
this
.
task
=
task
;
this
.
msgOutputLevel
=
msgOutputLevel
;
line
=
new
StringBuffer
(
)
;
}
public
void
write
(
int
c
)
throws
IOException
{
char
cc
=
(
char
)
c
;
if
(
cc
==
'\r'
||
cc
==
'\n'
)
{
if
(
line
.
length
(
)
>
0
)
{
processLine
(
)
;
}
}
else
{
line
.
append
(
cc
)
;
}
}
private
void
processLine
(
)
{
String
s
=
line
.
toString
(
)
;
task
.
log
(
s
,
msgOutputLevel
)
;
line
=
new
StringBuffer
(
)
;
}
}
