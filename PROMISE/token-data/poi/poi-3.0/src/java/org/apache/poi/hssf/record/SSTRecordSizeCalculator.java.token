package
org
.
apache
.
poi
.
hssf
.
record
;
import
org
.
apache
.
poi
.
util
.
IntMapper
;
class
SSTRecordSizeCalculator
{
private
IntMapper
strings
;
public
SSTRecordSizeCalculator
(
IntMapper
strings
)
{
this
.
strings
=
strings
;
}
public
int
getRecordSize
(
)
{
UnicodeString
.
UnicodeRecordStats
rs
=
new
UnicodeString
.
UnicodeRecordStats
(
)
;
rs
.
remainingSize
-=
SSTRecord
.
SST_RECORD_OVERHEAD
;
rs
.
recordSize
+=
SSTRecord
.
SST_RECORD_OVERHEAD
;
for
(
int
i
=
0
;
i
<
strings
.
size
(
)
;
i
++
)
{
UnicodeString
unistr
=
(
(
UnicodeString
)
strings
.
get
(
i
)
)
;
unistr
.
getRecordSize
(
rs
)
;
}
return
rs
.
recordSize
;
}
}
