package
org
.
apache
.
poi
.
hssf
.
record
.
formula
;
import
org
.
apache
.
poi
.
util
.
LittleEndian
;
import
org
.
apache
.
poi
.
util
.
BitField
;
import
org
.
apache
.
poi
.
hssf
.
util
.
AreaReference
;
import
org
.
apache
.
poi
.
hssf
.
util
.
CellReference
;
import
org
.
apache
.
poi
.
hssf
.
model
.
Workbook
;
public
class
AreaPtg
extends
Ptg
{
public
final
static
short
sid
=
0x25
;
private
final
static
int
SIZE
=
9
;
private
short
field_1_first_row
;
private
short
field_2_last_row
;
private
short
field_3_first_column
;
private
short
field_4_last_column
;
private
BitField
rowRelative
=
new
BitField
(
0x8000
)
;
private
BitField
colRelative
=
new
BitField
(
0x4000
)
;
private
BitField
column
=
new
BitField
(
0x3FFF
)
;
private
AreaPtg
(
)
{
}
public
AreaPtg
(
String
arearef
)
{
AreaReference
ar
=
new
AreaReference
(
arearef
)
;
setFirstRow
(
(
short
)
ar
.
getCells
(
)
[
0
]
.
getRow
(
)
)
;
setFirstColumn
(
(
short
)
ar
.
getCells
(
)
[
0
]
.
getCol
(
)
)
;
setLastRow
(
(
short
)
ar
.
getCells
(
)
[
1
]
.
getRow
(
)
)
;
setLastColumn
(
(
short
)
ar
.
getCells
(
)
[
1
]
.
getCol
(
)
)
;
setFirstColRelative
(
!
ar
.
getCells
(
)
[
0
]
.
isColAbsolute
(
)
)
;
setLastColRelative
(
!
ar
.
getCells
(
)
[
1
]
.
isColAbsolute
(
)
)
;
setFirstRowRelative
(
!
ar
.
getCells
(
)
[
0
]
.
isRowAbsolute
(
)
)
;
setLastRowRelative
(
!
ar
.
getCells
(
)
[
1
]
.
isRowAbsolute
(
)
)
;
}
public
AreaPtg
(
byte
[
]
data
,
int
offset
)
{
offset
++
;
field_1_first_row
=
LittleEndian
.
getShort
(
data
,
0
+
offset
)
;
field_2_last_row
=
LittleEndian
.
getShort
(
data
,
2
+
offset
)
;
field_3_first_column
=
LittleEndian
.
getShort
(
data
,
4
+
offset
)
;
field_4_last_column
=
LittleEndian
.
getShort
(
data
,
6
+
offset
)
;
}
public
String
toString
(
)
{
StringBuffer
buffer
=
new
StringBuffer
(
)
;
buffer
.
append
(
"AreaPtg\n"
)
;
buffer
.
append
(
"firstRow = "
+
getFirstRow
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"lastRow  = "
+
getLastRow
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"firstCol = "
+
getFirstColumn
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"lastCol  = "
+
getLastColumn
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"firstColRowRel= "
+
isFirstRowRelative
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"lastColRowRel = "
+
isLastRowRelative
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"firstColRel   = "
+
isFirstColRelative
(
)
)
.
append
(
"\n"
)
;
buffer
.
append
(
"lastColRel    = "
+
isLastColRelative
(
)
)
.
append
(
"\n"
)
;
return
buffer
.
toString
(
)
;
}
public
void
writeBytes
(
byte
[
]
array
,
int
offset
)
{
array
[
offset
]
=
(
byte
)
(
sid
+
ptgClass
)
;
LittleEndian
.
putShort
(
array
,
offset
+
1
,
field_1_first_row
)
;
LittleEndian
.
putShort
(
array
,
offset
+
3
,
field_2_last_row
)
;
LittleEndian
.
putShort
(
array
,
offset
+
5
,
field_3_first_column
)
;
LittleEndian
.
putShort
(
array
,
offset
+
7
,
field_4_last_column
)
;
}
public
int
getSize
(
)
{
return
SIZE
;
}
public
short
getFirstRow
(
)
{
return
field_1_first_row
;
}
public
void
setFirstRow
(
short
row
)
{
field_1_first_row
=
row
;
}
public
short
getLastRow
(
)
{
return
field_2_last_row
;
}
public
void
setLastRow
(
short
row
)
{
field_2_last_row
=
row
;
}
public
short
getFirstColumn
(
)
{
return
column
.
getShortValue
(
field_3_first_column
)
;
}
public
short
getFirstColumnRaw
(
)
{
return
field_3_first_column
;
}
public
boolean
isFirstRowRelative
(
)
{
return
rowRelative
.
isSet
(
field_3_first_column
)
;
}
public
void
setFirstRowRelative
(
boolean
rel
)
{
field_3_first_column
=
rowRelative
.
setShortBoolean
(
field_3_first_column
,
rel
)
;
}
public
boolean
isFirstColRelative
(
)
{
return
colRelative
.
isSet
(
field_3_first_column
)
;
}
public
void
setFirstColRelative
(
boolean
rel
)
{
field_3_first_column
=
colRelative
.
setShortBoolean
(
field_3_first_column
,
rel
)
;
}
public
void
setFirstColumn
(
short
column
)
{
field_3_first_column
=
column
;
}
public
void
setFirstColumnRaw
(
short
column
)
{
field_3_first_column
=
column
;
}
public
short
getLastColumn
(
)
{
return
column
.
getShortValue
(
field_4_last_column
)
;
}
public
short
getLastColumnRaw
(
)
{
return
field_4_last_column
;
}
public
boolean
isLastRowRelative
(
)
{
return
rowRelative
.
isSet
(
field_4_last_column
)
;
}
public
void
setLastRowRelative
(
boolean
rel
)
{
field_4_last_column
=
rowRelative
.
setShortBoolean
(
field_4_last_column
,
rel
)
;
}
public
boolean
isLastColRelative
(
)
{
return
colRelative
.
isSet
(
field_4_last_column
)
;
}
public
void
setLastColRelative
(
boolean
rel
)
{
field_4_last_column
=
colRelative
.
setShortBoolean
(
field_4_last_column
,
rel
)
;
}
public
void
setLastColumn
(
short
column
)
{
field_4_last_column
=
column
;
}
public
void
setLastColumnRaw
(
short
column
)
{
field_4_last_column
=
column
;
}
public
String
toFormulaString
(
Workbook
book
)
{
return
(
new
CellReference
(
getFirstRow
(
)
,
getFirstColumn
(
)
,
!
isFirstRowRelative
(
)
,
!
isFirstColRelative
(
)
)
)
.
toString
(
)
+
":"
+
(
new
CellReference
(
getLastRow
(
)
,
getLastColumn
(
)
,
!
isLastRowRelative
(
)
,
!
isLastColRelative
(
)
)
)
.
toString
(
)
;
}
public
byte
getDefaultOperandClass
(
)
{
return
Ptg
.
CLASS_REF
;
}
public
Object
clone
(
)
{
AreaPtg
ptg
=
new
AreaPtg
(
)
;
ptg
.
field_1_first_row
=
field_1_first_row
;
ptg
.
field_2_last_row
=
field_2_last_row
;
ptg
.
field_3_first_column
=
field_3_first_column
;
ptg
.
field_4_last_column
=
field_4_last_column
;
ptg
.
setClass
(
ptgClass
)
;
return
ptg
;
}
}
