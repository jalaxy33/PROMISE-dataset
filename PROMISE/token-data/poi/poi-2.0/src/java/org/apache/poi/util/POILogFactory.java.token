package
org
.
apache
.
poi
.
util
;
import
java
.
io
.
FileInputStream
;
import
java
.
io
.
IOException
;
import
java
.
util
.
*
;
public
class
POILogFactory
{
private
static
Map
_loggers
=
new
HashMap
(
)
;
;
private
POILogFactory
(
)
{
}
public
static
POILogger
getLogger
(
final
Class
theclass
)
{
return
getLogger
(
theclass
.
getName
(
)
)
;
}
public
static
POILogger
getLogger
(
final
String
cat
)
{
POILogger
logger
=
null
;
if
(
_loggers
.
containsKey
(
cat
)
)
{
logger
=
(
POILogger
)
_loggers
.
get
(
cat
)
;
}
else
{
try
{
String
loggerClassName
=
System
.
getProperty
(
"org.apache.poi.util.POILogger"
)
;
Class
loggerClass
=
Class
.
forName
(
loggerClassName
)
;
logger
=
(
POILogger
)
loggerClass
.
newInstance
(
)
;
}
catch
(
Exception
e
)
{
logger
=
new
NullLogger
(
)
;
}
logger
.
initialize
(
cat
)
;
_loggers
.
put
(
cat
,
logger
)
;
}
return
logger
;
}
}
