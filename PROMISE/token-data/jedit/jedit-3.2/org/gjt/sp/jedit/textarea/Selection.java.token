package
org
.
gjt
.
sp
.
jedit
.
textarea
;
import
javax
.
swing
.
text
.
*
;
import
org
.
gjt
.
sp
.
jedit
.
Buffer
;
public
abstract
class
Selection
{
public
int
getStart
(
)
{
return
start
;
}
public
int
getEnd
(
)
{
return
end
;
}
public
int
getStartLine
(
)
{
return
startLine
;
}
public
int
getEndLine
(
)
{
return
endLine
;
}
public
abstract
int
getStart
(
Buffer
buffer
,
int
line
)
;
public
abstract
int
getEnd
(
Buffer
buffer
,
int
line
)
;
public
String
toString
(
)
{
return
getClass
(
)
.
getName
(
)
+
"[start="
+
start
+
",end="
+
end
+
",startLine="
+
startLine
+
",endLine="
+
endLine
+
"]"
;
}
int
start
,
end
,
startLine
,
endLine
;
protected
Selection
(
)
{
}
protected
Selection
(
Selection
copy
)
{
start
=
copy
.
start
;
end
=
copy
.
end
;
}
protected
Selection
(
int
start
,
int
end
)
{
this
.
start
=
start
;
this
.
end
=
end
;
}
public
static
class
Range
extends
Selection
{
public
Range
(
)
{
super
(
)
;
}
public
Range
(
Selection
sel
)
{
super
(
sel
)
;
}
public
Range
(
int
start
,
int
end
)
{
super
(
start
,
end
)
;
}
public
int
getStart
(
Buffer
buffer
,
int
line
)
{
if
(
line
==
startLine
)
return
start
;
else
{
Element
map
=
buffer
.
getDefaultRootElement
(
)
;
Element
lineElement
=
map
.
getElement
(
line
)
;
return
lineElement
.
getStartOffset
(
)
;
}
}
public
int
getEnd
(
Buffer
buffer
,
int
line
)
{
if
(
line
==
endLine
)
return
end
;
else
{
Element
map
=
buffer
.
getDefaultRootElement
(
)
;
Element
lineElement
=
map
.
getElement
(
line
)
;
return
lineElement
.
getEndOffset
(
)
-
1
;
}
}
}
public
static
class
Rect
extends
Selection
{
public
Rect
(
)
{
super
(
)
;
}
public
Rect
(
Selection
sel
)
{
super
(
sel
)
;
}
public
Rect
(
int
start
,
int
end
)
{
super
(
start
,
end
)
;
}
public
int
getStart
(
Buffer
buffer
,
int
line
)
{
if
(
line
==
startLine
)
return
start
;
else
{
Element
map
=
buffer
.
getDefaultRootElement
(
)
;
int
_start
=
start
-
map
.
getElement
(
startLine
)
.
getStartOffset
(
)
;
int
_end
=
end
-
map
.
getElement
(
endLine
)
.
getStartOffset
(
)
;
Element
lineElement
=
map
.
getElement
(
line
)
;
return
Math
.
min
(
lineElement
.
getEndOffset
(
)
-
1
,
lineElement
.
getStartOffset
(
)
+
Math
.
min
(
_start
,
_end
)
)
;
}
}
public
int
getEnd
(
Buffer
buffer
,
int
line
)
{
if
(
line
==
endLine
)
return
end
;
else
{
Element
map
=
buffer
.
getDefaultRootElement
(
)
;
int
_start
=
start
-
map
.
getElement
(
startLine
)
.
getStartOffset
(
)
;
int
_end
=
end
-
map
.
getElement
(
endLine
)
.
getStartOffset
(
)
;
Element
lineElement
=
map
.
getElement
(
line
)
;
return
Math
.
min
(
lineElement
.
getEndOffset
(
)
-
1
,
lineElement
.
getStartOffset
(
)
+
Math
.
max
(
_start
,
_end
)
)
;
}
}
}
}
