package
org
.
gjt
.
sp
.
jedit
;
import
gnu
.
regexp
.
REException
;
import
javax
.
swing
.
*
;
import
java
.
awt
.
*
;
import
java
.
awt
.
event
.
*
;
import
java
.
io
.
File
;
import
java
.
net
.
*
;
import
java
.
util
.
Hashtable
;
import
java
.
util
.
StringTokenizer
;
import
org
.
gjt
.
sp
.
jedit
.
browser
.
*
;
import
org
.
gjt
.
sp
.
jedit
.
gui
.
*
;
import
org
.
gjt
.
sp
.
jedit
.
io
.
VFS
;
import
org
.
gjt
.
sp
.
jedit
.
msg
.
PropertiesChanged
;
import
org
.
gjt
.
sp
.
jedit
.
syntax
.
SyntaxStyle
;
import
org
.
gjt
.
sp
.
jedit
.
syntax
.
Token
;
import
org
.
gjt
.
sp
.
util
.
Log
;
public
class
GUIUtilities
{
public
static
final
Icon
NEW_BUFFER_ICON
;
public
static
final
Icon
DIRTY_BUFFER_ICON
;
public
static
final
Icon
READ_ONLY_BUFFER_ICON
;
public
static
final
Icon
NORMAL_BUFFER_ICON
;
public
static
final
Icon
EDITOR_WINDOW_ICON
;
public
static
final
Icon
PLUGIN_WINDOW_ICON
;
public
static
JMenuBar
loadMenuBar
(
String
name
)
{
String
menus
=
jEdit
.
getProperty
(
name
)
;
StringTokenizer
st
=
new
StringTokenizer
(
menus
)
;
JMenuBar
mbar
=
new
JMenuBar
(
)
;
while
(
st
.
hasMoreTokens
(
)
)
mbar
.
add
(
GUIUtilities
.
loadMenu
(
st
.
nextToken
(
)
)
)
;
return
mbar
;
}
public
static
JMenu
loadMenu
(
String
name
)
{
if
(
name
.
equals
(
"open-encoding"
)
)
return
new
OpenWithEncodingMenu
(
)
;
else
if
(
name
.
equals
(
"recent-files"
)
)
return
new
RecentFilesMenu
(
)
;
else
if
(
name
.
equals
(
"current-directory"
)
)
return
new
CurrentDirectoryMenu
(
)
;
else
if
(
name
.
equals
(
"markers"
)
)
return
new
MarkersMenu
(
)
;
else
if
(
name
.
equals
(
"macros"
)
)
return
new
MacrosMenu
(
)
;
else
if
(
name
.
equals
(
"plugins"
)
)
return
new
PluginsMenu
(
)
;
else
return
new
EnhancedMenu
(
name
)
;
}
public
static
JPopupMenu
loadPopupMenu
(
String
name
)
{
JPopupMenu
menu
=
new
JPopupMenu
(
)
;
String
menuItems
=
jEdit
.
getProperty
(
name
)
;
if
(
menuItems
!=
null
)
{
StringTokenizer
st
=
new
StringTokenizer
(
menuItems
)
;
while
(
st
.
hasMoreTokens
(
)
)
{
String
menuItemName
=
st
.
nextToken
(
)
;
if
(
menuItemName
.
equals
(
"-"
)
)
menu
.
addSeparator
(
)
;
else
{
if
(
menuItemName
.
startsWith
(
"%"
)
)
menu
.
add
(
loadMenu
(
menuItemName
.
substring
(
1
)
)
)
;
else
menu
.
add
(
loadMenuItem
(
menuItemName
,
false
)
)
;
}
}
}
return
menu
;
}
public
static
JMenuItem
loadMenuItem
(
String
name
)
{
return
loadMenuItem
(
name
,
true
)
;
}
public
static
JMenuItem
loadMenuItem
(
String
name
,
boolean
setMnemonic
)
{
String
label
;
EditAction
action
;
if
(
name
.
startsWith
(
"play-macro@"
)
)
{
Macros
.
Macro
macro
=
Macros
.
getMacro
(
name
.
substring
(
11
)
)
;
if
(
macro
!=
null
)
{
label
=
macro
.
name
;
int
index
=
label
.
lastIndexOf
(
'/'
)
;
label
=
label
.
substring
(
index
+
1
)
.
replace
(
'_'
,
' '
)
;
action
=
macro
.
action
;
}
else
{
label
=
name
.
substring
(
11
)
;
action
=
null
;
}
}
else
{
action
=
jEdit
.
getAction
(
name
)
;
label
=
jEdit
.
getProperty
(
name
.
concat
(
".label"
)
)
;
if
(
label
==
null
)
label
=
name
;
}
char
mnemonic
;
int
index
=
label
.
indexOf
(
'$'
)
;
if
(
index
!=
-
1
&&
label
.
length
(
)
-
index
>
1
)
{
mnemonic
=
Character
.
toLowerCase
(
label
.
charAt
(
index
+
1
)
)
;
label
=
label
.
substring
(
0
,
index
)
.
concat
(
label
.
substring
(
++
index
)
)
;
}
else
mnemonic
=
'\0'
;
JMenuItem
mi
;
if
(
action
!=
null
&&
action
.
isToggle
(
)
)
mi
=
new
EnhancedCheckBoxMenuItem
(
label
,
action
)
;
else
mi
=
new
EnhancedMenuItem
(
label
,
action
)
;
if
(
setMnemonic
&&
mnemonic
!=
'\0'
)
mi
.
setMnemonic
(
mnemonic
)
;
return
mi
;
}
public
static
JToolBar
loadToolBar
(
String
name
)
{
JToolBar
toolBar
=
new
JToolBar
(
)
;
toolBar
.
setFloatable
(
false
)
;
toolBar
.
putClientProperty
(
"JToolBar.isRollover"
,
Boolean
.
TRUE
)
;
String
buttons
=
jEdit
.
getProperty
(
name
)
;
if
(
buttons
!=
null
)
{
StringTokenizer
st
=
new
StringTokenizer
(
buttons
)
;
while
(
st
.
hasMoreTokens
(
)
)
{
String
button
=
st
.
nextToken
(
)
;
if
(
button
.
equals
(
"-"
)
)
toolBar
.
addSeparator
(
)
;
else
{
JButton
b
=
loadToolButton
(
button
)
;
if
(
b
!=
null
)
toolBar
.
add
(
b
)
;
}
}
}
return
toolBar
;
}
public
static
EnhancedButton
loadToolButton
(
String
name
)
{
String
label
;
EditAction
action
;
if
(
name
.
startsWith
(
"play-macro@"
)
)
{
Macros
.
Macro
macro
=
Macros
.
getMacro
(
name
.
substring
(
11
)
)
;
if
(
macro
!=
null
)
{
label
=
macro
.
name
;
int
index
=
label
.
lastIndexOf
(
'/'
)
;
label
=
label
.
substring
(
index
+
1
)
.
replace
(
'_'
,
' '
)
;
action
=
macro
.
action
;
}
else
{
label
=
name
.
substring
(
11
)
;
action
=
null
;
}
}
else
{
action
=
jEdit
.
getAction
(
name
)
;
label
=
jEdit
.
getProperty
(
name
.
concat
(
".label"
)
)
;
if
(
label
==
null
)
label
=
name
;
else
label
=
prettifyMenuLabel
(
label
)
;
}
Icon
icon
;
String
iconName
=
jEdit
.
getProperty
(
name
+
".icon"
)
;
if
(
iconName
!=
null
)
{
icon
=
loadIcon
(
iconName
)
;
if
(
icon
==
null
)
return
null
;
}
else
return
null
;
String
toolTip
=
label
;
String
shortcut
=
jEdit
.
getProperty
(
name
+
".shortcut"
)
;
if
(
shortcut
!=
null
)
toolTip
=
toolTip
+
" ("
+
shortcut
+
")"
;
return
new
EnhancedButton
(
icon
,
toolTip
,
action
)
;
}
public
static
Icon
loadIcon
(
String
iconName
)
{
Icon
icon
=
(
Icon
)
icons
.
get
(
iconName
)
;
if
(
icon
!=
null
)
return
icon
;
if
(
iconName
.
startsWith
(
"file:"
)
)
{
icon
=
new
ImageIcon
(
iconName
.
substring
(
5
)
)
;
}
else
{
URL
url
=
GUIUtilities
.
class
.
getResource
(
"/org/gjt/sp/jedit/icons/"
+
iconName
)
;
if
(
url
==
null
)
{
Log
.
log
(
Log
.
ERROR
,
GUIUtilities
.
class
,
"Icon not found: "
+
iconName
)
;
return
null
;
}
icon
=
new
ImageIcon
(
url
)
;
}
icons
.
put
(
iconName
,
icon
)
;
return
icon
;
}
public
static
String
prettifyMenuLabel
(
String
label
)
{
int
index
=
label
.
indexOf
(
'$'
)
;
if
(
index
!=
-
1
)
{
label
=
label
.
substring
(
0
,
index
)
.
concat
(
label
.
substring
(
index
+
1
)
)
;
}
return
label
;
}
public
static
void
message
(
Component
comp
,
String
name
,
Object
[
]
args
)
{
hideSplashScreen
(
)
;
JOptionPane
.
showMessageDialog
(
comp
,
jEdit
.
getProperty
(
name
.
concat
(
".message"
)
,
args
)
,
jEdit
.
getProperty
(
name
.
concat
(
".title"
)
,
args
)
,
JOptionPane
.
INFORMATION_MESSAGE
)
;
}
public
static
void
error
(
Component
comp
,
String
name
,
Object
[
]
args
)
{
hideSplashScreen
(
)
;
JOptionPane
.
showMessageDialog
(
comp
,
jEdit
.
getProperty
(
name
.
concat
(
".message"
)
,
args
)
,
jEdit
.
getProperty
(
name
.
concat
(
".title"
)
,
args
)
,
JOptionPane
.
ERROR_MESSAGE
)
;
}
public
static
String
input
(
Component
comp
,
String
name
,
Object
def
)
{
return
input
(
comp
,
name
,
null
,
def
)
;
}
public
static
String
inputProperty
(
Component
comp
,
String
name
,
String
def
)
{
return
inputProperty
(
comp
,
name
,
null
,
def
)
;
}
public
static
String
input
(
Component
comp
,
String
name
,
Object
[
]
args
,
Object
def
)
{
hideSplashScreen
(
)
;
String
retVal
=
(
String
)
JOptionPane
.
showInputDialog
(
comp
,
jEdit
.
getProperty
(
name
.
concat
(
".message"
)
,
args
)
,
jEdit
.
getProperty
(
name
.
concat
(
".title"
)
)
,
JOptionPane
.
QUESTION_MESSAGE
,
null
,
null
,
def
)
;
return
retVal
;
}
public
static
String
inputProperty
(
Component
comp
,
String
name
,
Object
[
]
args
,
String
def
)
{
hideSplashScreen
(
)
;
String
retVal
=
(
String
)
JOptionPane
.
showInputDialog
(
comp
,
jEdit
.
getProperty
(
name
.
concat
(
".message"
)
,
args
)
,
jEdit
.
getProperty
(
name
.
concat
(
".title"
)
)
,
JOptionPane
.
QUESTION_MESSAGE
,
null
,
null
,
jEdit
.
getProperty
(
def
)
)
;
if
(
retVal
!=
null
)
jEdit
.
setProperty
(
def
,
retVal
)
;
return
retVal
;
}
public
static
int
confirm
(
Component
comp
,
String
name
,
Object
[
]
args
,
int
buttons
,
int
type
)
{
hideSplashScreen
(
)
;
return
JOptionPane
.
showConfirmDialog
(
comp
,
jEdit
.
getProperty
(
name
+
".message"
,
args
)
,
jEdit
.
getProperty
(
name
+
".title"
)
,
buttons
,
type
)
;
}
public
static
String
[
]
showVFSFileDialog
(
View
view
,
String
path
,
int
type
,
boolean
multipleSelection
)
{
VFSFileChooserDialog
fileChooser
=
new
VFSFileChooserDialog
(
view
,
path
,
type
,
multipleSelection
)
;
String
[
]
selectedFiles
=
fileChooser
.
getSelectedFiles
(
)
;
if
(
selectedFiles
==
null
)
return
null
;
return
selectedFiles
;
}
public
static
Color
parseColor
(
String
name
)
{
return
parseColor
(
name
,
Color
.
black
)
;
}
public
static
Color
parseColor
(
String
name
,
Color
defaultColor
)
{
if
(
name
==
null
)
return
defaultColor
;
else
if
(
name
.
startsWith
(
"#"
)
)
{
try
{
return
Color
.
decode
(
name
)
;
}
catch
(
NumberFormatException
nf
)
{
return
defaultColor
;
}
}
else
if
(
"red"
.
equals
(
name
)
)
return
Color
.
red
;
else
if
(
"green"
.
equals
(
name
)
)
return
Color
.
green
;
else
if
(
"blue"
.
equals
(
name
)
)
return
Color
.
blue
;
else
if
(
"yellow"
.
equals
(
name
)
)
return
Color
.
yellow
;
else
if
(
"orange"
.
equals
(
name
)
)
return
Color
.
orange
;
else
if
(
"white"
.
equals
(
name
)
)
return
Color
.
white
;
else
if
(
"lightGray"
.
equals
(
name
)
)
return
Color
.
lightGray
;
else
if
(
"gray"
.
equals
(
name
)
)
return
Color
.
gray
;
else
if
(
"darkGray"
.
equals
(
name
)
)
return
Color
.
darkGray
;
else
if
(
"black"
.
equals
(
name
)
)
return
Color
.
black
;
else
if
(
"cyan"
.
equals
(
name
)
)
return
Color
.
cyan
;
else
if
(
"magenta"
.
equals
(
name
)
)
return
Color
.
magenta
;
else
if
(
"pink"
.
equals
(
name
)
)
return
Color
.
pink
;
else
return
defaultColor
;
}
public
static
String
getColorHexString
(
Color
c
)
{
String
colString
=
Integer
.
toHexString
(
c
.
getRGB
(
)
&
0xffffff
)
;
return
"#000000"
.
substring
(
0
,
7
-
colString
.
length
(
)
)
.
concat
(
colString
)
;
}
public
static
SyntaxStyle
parseStyle
(
String
str
,
String
family
,
int
size
)
throws
IllegalArgumentException
{
Color
fgColor
=
Color
.
black
;
Color
bgColor
=
null
;
boolean
italic
=
false
;
boolean
bold
=
false
;
StringTokenizer
st
=
new
StringTokenizer
(
str
)
;
while
(
st
.
hasMoreTokens
(
)
)
{
String
s
=
st
.
nextToken
(
)
;
if
(
s
.
startsWith
(
"color:"
)
)
{
fgColor
=
GUIUtilities
.
parseColor
(
s
.
substring
(
6
)
,
Color
.
black
)
;
}
else
if
(
s
.
startsWith
(
"bgColor:"
)
)
{
bgColor
=
GUIUtilities
.
parseColor
(
s
.
substring
(
8
)
,
null
)
;
}
else
if
(
s
.
startsWith
(
"style:"
)
)
{
for
(
int
i
=
6
;
i
<
s
.
length
(
)
;
i
++
)
{
if
(
s
.
charAt
(
i
)
==
'i'
)
italic
=
true
;
else
if
(
s
.
charAt
(
i
)
==
'b'
)
bold
=
true
;
else
throw
new
IllegalArgumentException
(
"Invalid style: "
+
s
)
;
}
}
else
throw
new
IllegalArgumentException
(
"Invalid directive: "
+
s
)
;
}
return
new
SyntaxStyle
(
fgColor
,
bgColor
,
new
Font
(
family
,
(
italic
?
Font
.
ITALIC
:
0
)
|
(
bold
?
Font
.
BOLD
:
0
)
,
size
)
)
;
}
public
static
String
getStyleString
(
SyntaxStyle
style
)
{
StringBuffer
buf
=
new
StringBuffer
(
)
;
buf
.
append
(
"color:"
+
getColorHexString
(
style
.
getForegroundColor
(
)
)
)
;
if
(
style
.
getBackgroundColor
(
)
!=
null
)
{
buf
.
append
(
" bgColor:"
+
getColorHexString
(
style
.
getBackgroundColor
(
)
)
)
;
}
if
(
!
style
.
getFont
(
)
.
isPlain
(
)
)
{
buf
.
append
(
" style:"
+
(
style
.
getFont
(
)
.
isItalic
(
)
?
"i"
:
""
)
+
(
style
.
getFont
(
)
.
isBold
(
)
?
"b"
:
""
)
)
;
}
return
buf
.
toString
(
)
;
}
public
static
SyntaxStyle
[
]
loadStyles
(
String
family
,
int
size
)
{
SyntaxStyle
[
]
styles
=
new
SyntaxStyle
[
Token
.
ID_COUNT
]
;
try
{
styles
[
Token
.
COMMENT1
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.comment1"
)
,
family
,
size
)
;
styles
[
Token
.
COMMENT2
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.comment2"
)
,
family
,
size
)
;
styles
[
Token
.
LITERAL1
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.literal1"
)
,
family
,
size
)
;
styles
[
Token
.
LITERAL2
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.literal2"
)
,
family
,
size
)
;
styles
[
Token
.
LABEL
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.label"
)
,
family
,
size
)
;
styles
[
Token
.
KEYWORD1
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.keyword1"
)
,
family
,
size
)
;
styles
[
Token
.
KEYWORD2
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.keyword2"
)
,
family
,
size
)
;
styles
[
Token
.
KEYWORD3
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.keyword3"
)
,
family
,
size
)
;
styles
[
Token
.
FUNCTION
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.function"
)
,
family
,
size
)
;
styles
[
Token
.
MARKUP
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.markup"
)
,
family
,
size
)
;
styles
[
Token
.
OPERATOR
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.operator"
)
,
family
,
size
)
;
styles
[
Token
.
DIGIT
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.digit"
)
,
family
,
size
)
;
styles
[
Token
.
INVALID
]
=
GUIUtilities
.
parseStyle
(
jEdit
.
getProperty
(
"view.style.invalid"
)
,
family
,
size
)
;
}
catch
(
Exception
e
)
{
Log
.
log
(
Log
.
ERROR
,
GUIUtilities
.
class
,
e
)
;
}
return
styles
;
}
public
static
void
loadGeometry
(
Window
win
,
String
name
)
{
int
x
,
y
,
width
,
height
,
adjust_x
,
adjust_y
,
adjust_width
,
adjust_height
;
try
{
width
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".width"
)
)
;
height
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".height"
)
)
;
}
catch
(
NumberFormatException
nf
)
{
Dimension
size
=
win
.
getSize
(
)
;
width
=
size
.
width
;
height
=
size
.
height
;
}
try
{
x
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".x"
)
)
;
y
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".y"
)
)
;
}
catch
(
NumberFormatException
nf
)
{
Component
parent
=
win
.
getParent
(
)
;
if
(
parent
==
null
)
{
Dimension
screen
=
win
.
getToolkit
(
)
.
getScreenSize
(
)
;
x
=
(
screen
.
width
-
width
)
/
2
;
y
=
(
screen
.
height
-
height
)
/
2
;
}
else
{
Rectangle
bounds
=
parent
.
getBounds
(
)
;
x
=
bounds
.
x
+
(
bounds
.
width
-
width
)
/
2
;
y
=
bounds
.
y
+
(
bounds
.
height
-
height
)
/
2
;
}
}
try
{
adjust_x
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".dx"
)
)
;
adjust_y
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".dy"
)
)
;
adjust_width
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".d-width"
)
)
;
adjust_height
=
Integer
.
parseInt
(
jEdit
.
getProperty
(
name
+
".d-height"
)
)
;
}
catch
(
NumberFormatException
nf
)
{
adjust_x
=
adjust_y
=
0
;
adjust_width
=
adjust_height
=
0
;
}
Rectangle
desired
=
new
Rectangle
(
x
,
y
,
width
,
height
)
;
Rectangle
required
=
new
Rectangle
(
x
-
adjust_x
,
y
-
adjust_y
,
width
-
adjust_width
,
height
-
adjust_height
)
;
win
.
setBounds
(
required
)
;
if
(
File
.
separatorChar
==
'/'
&&
System
.
getProperty
(
"java.version"
)
.
compareTo
(
"1.2"
)
<
0
)
{
win
.
setBounds
(
required
)
;
new
UnixWorkaround
(
win
,
name
,
desired
,
required
)
;
}
else
win
.
setBounds
(
desired
)
;
}
static
class
UnixWorkaround
{
Window
win
;
String
name
;
Rectangle
desired
;
Rectangle
required
;
long
start
;
boolean
windowOpened
;
UnixWorkaround
(
Window
win
,
String
name
,
Rectangle
desired
,
Rectangle
required
)
{
this
.
win
=
win
;
this
.
name
=
name
;
this
.
desired
=
desired
;
this
.
required
=
required
;
start
=
System
.
currentTimeMillis
(
)
;
win
.
addComponentListener
(
new
ComponentHandler
(
)
)
;
win
.
addWindowListener
(
new
WindowHandler
(
)
)
;
}
class
ComponentHandler
extends
ComponentAdapter
{
public
void
componentMoved
(
ComponentEvent
evt
)
{
if
(
System
.
currentTimeMillis
(
)
-
start
<
1000
)
{
Rectangle
r
=
win
.
getBounds
(
)
;
if
(
!
windowOpened
&&
r
.
equals
(
required
)
)
return
;
if
(
!
r
.
equals
(
desired
)
)
{
win
.
setBounds
(
desired
)
;
}
}
else
win
.
removeComponentListener
(
this
)
;
}
public
void
componentResized
(
ComponentEvent
evt
)
{
if
(
System
.
currentTimeMillis
(
)
-
start
<
1000
)
{
Rectangle
r
=
win
.
getBounds
(
)
;
if
(
!
windowOpened
&&
r
.
equals
(
required
)
)
return
;
if
(
!
r
.
equals
(
desired
)
)
{
win
.
setBounds
(
desired
)
;
}
}
else
win
.
removeComponentListener
(
this
)
;
}
}
class
WindowHandler
extends
WindowAdapter
{
public
void
windowOpened
(
WindowEvent
evt
)
{
windowOpened
=
true
;
Rectangle
r
=
win
.
getBounds
(
)
;
if
(
r
.
x
!=
desired
.
x
||
r
.
y
!=
desired
.
y
||
r
.
width
!=
desired
.
width
||
r
.
height
!=
desired
.
height
)
{
jEdit
.
setProperty
(
name
+
".dx"
,
String
.
valueOf
(
r
.
x
-
required
.
x
)
)
;
jEdit
.
setProperty
(
name
+
".dy"
,
String
.
valueOf
(
r
.
y
-
required
.
y
)
)
;
jEdit
.
setProperty
(
name
+
".d-width"
,
String
.
valueOf
(
r
.
width
-
required
.
width
)
)
;
jEdit
.
setProperty
(
name
+
".d-height"
,
String
.
valueOf
(
r
.
height
-
required
.
height
)
)
;
}
win
.
removeWindowListener
(
this
)
;
}
}
}
public
static
void
saveGeometry
(
Window
win
,
String
name
)
{
Rectangle
bounds
=
win
.
getBounds
(
)
;
jEdit
.
setProperty
(
name
+
".x"
,
String
.
valueOf
(
bounds
.
x
)
)
;
jEdit
.
setProperty
(
name
+
".y"
,
String
.
valueOf
(
bounds
.
y
)
)
;
jEdit
.
setProperty
(
name
+
".width"
,
String
.
valueOf
(
bounds
.
width
)
)
;
jEdit
.
setProperty
(
name
+
".height"
,
String
.
valueOf
(
bounds
.
height
)
)
;
}
public
static
void
hideSplashScreen
(
)
{
if
(
splash
!=
null
)
{
splash
.
dispose
(
)
;
splash
=
null
;
}
}
public
static
Image
getEditorIcon
(
)
{
return
(
(
ImageIcon
)
EDITOR_WINDOW_ICON
)
.
getImage
(
)
;
}
public
static
Image
getPluginIcon
(
)
{
return
(
(
ImageIcon
)
PLUGIN_WINDOW_ICON
)
.
getImage
(
)
;
}
public
static
void
requestFocus
(
final
Window
win
,
final
Component
comp
)
{
win
.
addWindowListener
(
new
WindowAdapter
(
)
{
public
void
windowActivated
(
WindowEvent
evt
)
{
comp
.
requestFocus
(
)
;
win
.
removeWindowListener
(
this
)
;
}
}
)
;
}
public
static
boolean
isPopupTrigger
(
MouseEvent
evt
)
{
if
(
macOS
)
return
evt
.
isControlDown
(
)
;
else
return
(
(
evt
.
getModifiers
(
)
&
InputEvent
.
BUTTON3_MASK
)
!=
0
)
;
}
public
static
JMenu
loadMenu
(
View
view
,
String
name
)
{
return
loadMenu
(
name
)
;
}
public
static
JMenuItem
loadMenuItem
(
View
view
,
String
name
)
{
return
loadMenuItem
(
name
,
true
)
;
}
public
static
Icon
loadToolBarIcon
(
String
iconName
)
{
return
loadIcon
(
iconName
)
;
}
public
static
String
showFileDialog
(
View
view
,
String
file
,
int
type
)
{
if
(
file
==
null
)
file
=
System
.
getProperty
(
"user.dir"
)
;
File
_file
=
new
File
(
file
)
;
JFileChooser
chooser
=
new
JFileChooser
(
)
;
chooser
.
setCurrentDirectory
(
_file
)
;
if
(
_file
.
isDirectory
(
)
)
chooser
.
setSelectedFile
(
null
)
;
else
chooser
.
setSelectedFile
(
_file
)
;
chooser
.
setDialogType
(
type
)
;
chooser
.
setFileSelectionMode
(
JFileChooser
.
FILES_ONLY
)
;
int
retVal
=
chooser
.
showDialog
(
view
,
null
)
;
if
(
retVal
==
JFileChooser
.
APPROVE_OPTION
)
{
File
selectedFile
=
chooser
.
getSelectedFile
(
)
;
if
(
selectedFile
!=
null
)
return
selectedFile
.
getAbsolutePath
(
)
;
}
return
null
;
}
static
void
showSplashScreen
(
)
{
splash
=
new
SplashScreen
(
)
;
}
static
void
advanceSplashProgress
(
)
{
if
(
splash
!=
null
)
splash
.
advance
(
)
;
}
private
static
SplashScreen
splash
;
private
static
boolean
macOS
;
private
static
Hashtable
icons
;
private
GUIUtilities
(
)
{
}
static
{
macOS
=
(
System
.
getProperty
(
"os.name"
)
.
indexOf
(
"Mac"
)
!=
-
1
)
;
icons
=
new
Hashtable
(
)
;
NEW_BUFFER_ICON
=
loadIcon
(
"new.gif"
)
;
DIRTY_BUFFER_ICON
=
loadIcon
(
"dirty.gif"
)
;
READ_ONLY_BUFFER_ICON
=
loadIcon
(
"readonly.gif"
)
;
NORMAL_BUFFER_ICON
=
loadIcon
(
"normal.gif"
)
;
EDITOR_WINDOW_ICON
=
loadIcon
(
"jedit_icon1.gif"
)
;
PLUGIN_WINDOW_ICON
=
loadIcon
(
"jedit_icon2.gif"
)
;
}
}
