package
org
.
apache
.
log4j
.
lf5
.
util
;
import
java
.
io
.
BufferedInputStream
;
import
java
.
io
.
ByteArrayInputStream
;
import
java
.
io
.
IOException
;
import
java
.
io
.
InputStream
;
import
java
.
util
.
Properties
;
public
class
ProductProperties
{
protected
Properties
_productProperties
;
private
static
ProductProperties
_reference
=
null
;
private
static
Object
_synchronizingObject
=
new
Object
(
)
;
private
ProductProperties
(
)
{
this
(
new
Resource
(
"org/apache/log4j/lf5/lf5.properties"
)
)
;
}
private
ProductProperties
(
Resource
resource
)
{
super
(
)
;
_productProperties
=
new
Properties
(
)
;
try
{
InputStream
source
=
getSource
(
resource
)
;
byte
[
]
contents
=
StreamUtils
.
getBytes
(
source
)
;
_productProperties
=
getProperties
(
contents
)
;
source
.
close
(
)
;
validateProductProperties
(
)
;
}
catch
(
Exception
e
)
{
String
error
=
e
.
getMessage
(
)
;
throw
new
ExceptionInInitializerError
(
error
)
;
}
}
public
static
ProductProperties
getInstance
(
)
{
if
(
_reference
==
null
)
{
synchronized
(
_synchronizingObject
)
{
if
(
_reference
==
null
)
{
_reference
=
new
ProductProperties
(
)
;
}
}
}
return
_reference
;
}
public
static
String
getPropertyNameOfProductName
(
)
{
return
"product.name"
;
}
public
static
String
getPropertyNameOfProductVersionNumber
(
)
{
return
"product.version.number"
;
}
public
static
String
getPropertyNameOfProductReleaseDate
(
)
{
return
"product.release.date"
;
}
public
String
getProductName
(
)
{
return
_productProperties
.
getProperty
(
getPropertyNameOfProductName
(
)
)
;
}
public
void
setProductName
(
String
productName
)
{
_productProperties
.
setProperty
(
getPropertyNameOfProductName
(
)
,
productName
)
;
}
public
String
getProductVersionNumber
(
)
{
return
_productProperties
.
getProperty
(
getPropertyNameOfProductVersionNumber
(
)
)
;
}
public
void
setProductVersionNumber
(
String
productVersionNumber
)
{
_productProperties
.
setProperty
(
getPropertyNameOfProductVersionNumber
(
)
,
productVersionNumber
)
;
}
public
String
getProductReleaseDate
(
)
{
return
_productProperties
.
getProperty
(
getPropertyNameOfProductReleaseDate
(
)
)
;
}
public
void
setProductReleaseDate
(
String
productReleaseDate
)
{
_productProperties
.
setProperty
(
getPropertyNameOfProductReleaseDate
(
)
,
productReleaseDate
)
;
}
public
String
get
(
String
name
)
{
return
_productProperties
.
getProperty
(
name
)
;
}
public
Object
set
(
String
name
,
String
value
)
{
return
_productProperties
.
setProperty
(
name
,
value
)
;
}
public
String
getLogFactor5
(
)
{
return
getString
(
"lf5"
)
;
}
public
String
getString
(
String
propertyName
)
{
return
String
.
valueOf
(
get
(
propertyName
)
)
;
}
protected
void
validateProductProperties
(
)
throws
Exception
{
String
value
=
null
;
value
=
getProductVersionNumber
(
)
;
if
(
(
value
==
null
)
||
value
.
equals
(
""
)
)
{
throw
new
Exception
(
"Product version number is null."
)
;
}
value
=
getProductReleaseDate
(
)
;
if
(
(
value
==
null
)
||
value
.
equals
(
""
)
)
{
throw
new
Exception
(
"Product release date is null."
)
;
}
}
private
InputStream
getSource
(
Resource
resource
)
{
return
new
BufferedInputStream
(
ResourceUtils
.
getResourceAsStream
(
this
,
resource
)
)
;
}
private
Properties
getProperties
(
byte
[
]
contents
)
throws
IOException
{
ByteArrayInputStream
source
=
new
ByteArrayInputStream
(
contents
)
;
Properties
result
=
new
Properties
(
)
;
result
.
load
(
source
)
;
source
.
close
(
)
;
return
result
;
}
}
