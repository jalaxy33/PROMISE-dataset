package
org
.
apache
.
camel
.
processor
.
idempotent
;
import
org
.
apache
.
camel
.
util
.
LRUCache
;
import
java
.
util
.
Set
;
import
java
.
util
.
HashSet
;
import
java
.
util
.
Map
;
import
java
.
util
.
HashMap
;
import
java
.
util
.
LinkedHashMap
;
public
class
MemoryMessageIdRepository
implements
MessageIdRepository
{
private
Map
cache
;
public
static
MessageIdRepository
memoryMessageIdRepository
(
)
{
return
memoryMessageIdRepository
(
new
HashMap
(
)
)
;
}
public
static
MessageIdRepository
memoryMessageIdRepository
(
int
cacheSize
)
{
return
memoryMessageIdRepository
(
new
LRUCache
(
cacheSize
)
)
;
}
public
static
MessageIdRepository
memoryMessageIdRepository
(
Map
cache
)
{
return
new
MemoryMessageIdRepository
(
cache
)
;
}
public
MemoryMessageIdRepository
(
Map
set
)
{
this
.
cache
=
set
;
}
public
boolean
contains
(
String
messageId
)
{
synchronized
(
cache
)
{
if
(
cache
.
containsKey
(
messageId
)
)
{
return
true
;
}
else
{
cache
.
put
(
messageId
,
messageId
)
;
return
false
;
}
}
}
}
