package
org
.
apache
.
camel
.
builder
;
import
java
.
util
.
ArrayList
;
import
java
.
util
.
List
;
import
org
.
apache
.
camel
.
CamelContext
;
import
org
.
apache
.
camel
.
Endpoint
;
import
org
.
apache
.
camel
.
processor
.
LoggingLevel
;
import
org
.
apache
.
camel
.
processor
.
SendProcessor
;
import
org
.
apache
.
commons
.
logging
.
Log
;
import
org
.
apache
.
commons
.
logging
.
LogFactory
;
public
abstract
class
BuilderSupport
{
private
CamelContext
context
;
private
ErrorHandlerBuilder
errorHandlerBuilder
;
private
boolean
inheritErrorHandler
=
true
;
protected
BuilderSupport
(
CamelContext
context
)
{
this
.
context
=
context
;
}
protected
BuilderSupport
(
BuilderSupport
parent
)
{
this
.
context
=
parent
.
getContext
(
)
;
this
.
inheritErrorHandler
=
parent
.
inheritErrorHandler
;
if
(
inheritErrorHandler
&&
parent
.
errorHandlerBuilder
!=
null
)
{
this
.
errorHandlerBuilder
=
parent
.
errorHandlerBuilder
.
copy
(
)
;
}
}
@
Fluent
public
ValueBuilder
header
(
@
FluentArg
(
"name"
)
String
name
)
{
return
Builder
.
header
(
name
)
;
}
@
Fluent
public
ValueBuilder
body
(
)
{
return
Builder
.
body
(
)
;
}
@
Fluent
public
<
T
>
ValueBuilder
bodyAs
(
@
FluentArg
(
"class"
)
Class
<
T
>
type
)
{
return
Builder
.
bodyAs
(
type
)
;
}
@
Fluent
public
ValueBuilder
outBody
(
)
{
return
Builder
.
outBody
(
)
;
}
@
Fluent
public
<
T
>
ValueBuilder
outBody
(
@
FluentArg
(
"class"
)
Class
<
T
>
type
)
{
return
Builder
.
outBody
(
type
)
;
}
@
Fluent
public
ValueBuilder
systemProperty
(
@
FluentArg
(
"name"
)
String
name
)
{
return
Builder
.
systemProperty
(
name
)
;
}
@
Fluent
public
ValueBuilder
systemProperty
(
@
FluentArg
(
"name"
)
String
name
,
@
FluentArg
(
"defaultValue"
)
String
defaultValue
)
{
return
Builder
.
systemProperty
(
name
,
defaultValue
)
;
}
@
Fluent
public
Endpoint
endpoint
(
@
FluentArg
(
"uri"
)
String
uri
)
{
return
getContext
(
)
.
getEndpoint
(
uri
)
;
}
@
Fluent
public
List
<
Endpoint
>
endpoints
(
@
FluentArg
(
"uris"
)
String
...
uris
)
{
List
<
Endpoint
>
endpoints
=
new
ArrayList
<
Endpoint
>
(
)
;
for
(
String
uri
:
uris
)
{
endpoints
.
add
(
endpoint
(
uri
)
)
;
}
return
endpoints
;
}
@
Fluent
public
List
<
Endpoint
>
endpoints
(
@
FluentArg
(
"endpoints"
)
Endpoint
...
endpoints
)
{
List
<
Endpoint
>
answer
=
new
ArrayList
<
Endpoint
>
(
)
;
for
(
Endpoint
endpoint
:
endpoints
)
{
answer
.
add
(
endpoint
)
;
}
return
answer
;
}
@
Fluent
public
NoErrorHandlerBuilder
noErrorHandler
(
)
{
return
new
NoErrorHandlerBuilder
(
)
;
}
@
Fluent
public
LoggingErrorHandlerBuilder
loggingErrorHandler
(
)
{
return
new
LoggingErrorHandlerBuilder
(
)
;
}
@
Fluent
public
LoggingErrorHandlerBuilder
loggingErrorHandler
(
@
FluentArg
(
"log"
)
String
log
)
{
return
loggingErrorHandler
(
LogFactory
.
getLog
(
log
)
)
;
}
@
Fluent
public
LoggingErrorHandlerBuilder
loggingErrorHandler
(
@
FluentArg
(
"log"
)
Log
log
)
{
return
new
LoggingErrorHandlerBuilder
(
log
)
;
}
@
Fluent
public
LoggingErrorHandlerBuilder
loggingErrorHandler
(
@
FluentArg
(
"log"
)
Log
log
,
@
FluentArg
(
"level"
)
LoggingLevel
level
)
{
return
new
LoggingErrorHandlerBuilder
(
log
,
level
)
;
}
@
Fluent
public
DeadLetterChannelBuilder
deadLetterChannel
(
)
{
return
new
DeadLetterChannelBuilder
(
)
;
}
@
Fluent
public
DeadLetterChannelBuilder
deadLetterChannel
(
@
FluentArg
(
"uri"
)
String
deadLetterUri
)
{
return
deadLetterChannel
(
endpoint
(
deadLetterUri
)
)
;
}
@
Fluent
public
DeadLetterChannelBuilder
deadLetterChannel
(
@
FluentArg
(
"ref"
)
Endpoint
deadLetterEndpoint
)
{
return
new
DeadLetterChannelBuilder
(
new
SendProcessor
(
deadLetterEndpoint
)
)
;
}
public
CamelContext
getContext
(
)
{
return
context
;
}
public
void
setContext
(
CamelContext
context
)
{
this
.
context
=
context
;
}
public
ErrorHandlerBuilder
getErrorHandlerBuilder
(
)
{
if
(
errorHandlerBuilder
==
null
)
{
errorHandlerBuilder
=
createErrorHandlerBuilder
(
)
;
}
return
errorHandlerBuilder
;
}
protected
ErrorHandlerBuilder
createErrorHandlerBuilder
(
)
{
if
(
isInheritErrorHandler
(
)
)
{
return
new
DeadLetterChannelBuilder
(
)
;
}
else
{
return
new
NoErrorHandlerBuilder
(
)
;
}
}
public
void
setErrorHandlerBuilder
(
ErrorHandlerBuilder
errorHandlerBuilder
)
{
this
.
errorHandlerBuilder
=
errorHandlerBuilder
;
}
public
boolean
isInheritErrorHandler
(
)
{
return
inheritErrorHandler
;
}
public
void
setInheritErrorHandler
(
boolean
inheritErrorHandler
)
{
this
.
inheritErrorHandler
=
inheritErrorHandler
;
}
}
