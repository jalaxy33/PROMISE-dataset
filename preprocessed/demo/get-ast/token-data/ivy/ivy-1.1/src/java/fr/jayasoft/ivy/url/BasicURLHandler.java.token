package
fr
jayasoft
ivy
url
import
java
io
ByteArrayInputStream
import
java
io
ByteArrayOutputStream
import
java
io
File
import
java
io
IOException
import
java
io
InputStream
import
java
net
HttpURLConnection
import
java
net
URL
import
java
net
URLConnection
import
java
net
UnknownHostException
import
org
apache
commons
httpclient
HttpStatus
import
fr
jayasoft
ivy
util
CopyProgressListener
import
fr
jayasoft
ivy
util
FileUtil
import
fr
jayasoft
ivy
util
Message
public
class
BasicURLHandler
implements
URLHandler
public
boolean
isReachable
URL
url
return
isReachable
url
public
boolean
isReachable
URL
url
int
timeout
try
URLConnection
con
url
openConnection
if
con
instanceof
HttpURLConnection
int
status
HttpURLConnection
con
getResponseCode
if
status
HttpStatus
SC_OK
return
if
status
HttpStatus
SC_PROXY_AUTHENTICATION_REQUIRED
Message
warn
else
if
String
valueOf
status
startsWith
Message
verbose
HttpURLConnection
con
getResponseMessage
url
else
if
String
valueOf
status
startsWith
Message
error
HttpURLConnection
con
getResponseMessage
url
Message
debug
status
url
else
int
contentLength
con
getContentLength
return
contentLength
catch
UnknownHostException
e
Message
warn
e
getMessage
url
Message
info
catch
IOException
e
Message
error
e
getMessage
url
return
public
InputStream
openStream
URL
url
throws
IOException
URLConnection
conn
InputStream
inStream
try
conn
url
openConnection
inStream
conn
getInputStream
ByteArrayOutputStream
outStream
new
ByteArrayOutputStream
byte
buffer
new
byte
int
len
while
len
inStream
read
buffer
outStream
write
buffer
len
return
new
ByteArrayInputStream
outStream
toByteArray
finally
if
inStream
inStream
close
if
conn
if
conn
instanceof
HttpURLConnection
HttpURLConnection
conn
disconnect
public
void
download
URL
src
File
dest
CopyProgressListener
l
throws
IOException
URLConnection
srcConn
try
srcConn
src
openConnection
FileUtil
copy
srcConn
getInputStream
dest
l
finally
if
srcConn
if
srcConn
instanceof
HttpURLConnection
HttpURLConnection
srcConn
disconnect
