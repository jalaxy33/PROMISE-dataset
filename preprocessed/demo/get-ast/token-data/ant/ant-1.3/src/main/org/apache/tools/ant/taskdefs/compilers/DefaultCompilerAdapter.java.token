package
org
apache
tools
ant
taskdefs
compilers
import
org
apache
tools
ant
import
org
apache
tools
ant
taskdefs
import
org
apache
tools
ant
types
import
java
io
import
java
util
Random
public
abstract
class
DefaultCompilerAdapter
implements
CompilerAdapter
protected
Path
src
protected
File
destDir
protected
String
encoding
protected
boolean
debug
protected
boolean
optimize
protected
boolean
deprecation
protected
boolean
depend
protected
boolean
verbose
protected
String
target
protected
Path
bootclasspath
protected
Path
extdirs
protected
Path
compileClasspath
protected
Project
project
protected
Location
location
protected
boolean
includeAntRuntime
protected
boolean
includeJavaRuntime
protected
File
compileList
protected
static
String
lSep
System
getProperty
protected
Javac
attributes
public
void
setJavac
Javac
attributes
this
attributes
attributes
src
attributes
getSrcdir
destDir
attributes
getDestdir
encoding
attributes
getEncoding
debug
attributes
getDebug
optimize
attributes
getOptimize
deprecation
attributes
getDeprecation
depend
attributes
getDepend
verbose
attributes
getVerbose
target
attributes
getTarget
bootclasspath
attributes
getBootclasspath
extdirs
attributes
getExtdirs
compileList
attributes
getFileList
compileClasspath
attributes
getClasspath
project
attributes
getProject
location
attributes
getLocation
includeAntRuntime
attributes
getIncludeantruntime
includeJavaRuntime
attributes
getIncludejavaruntime
public
Javac
getJavac
return
attributes
protected
Path
getCompileClasspath
Path
classpath
new
Path
project
if
destDir
classpath
setLocation
destDir
if
compileClasspath
if
includeAntRuntime
classpath
addExisting
Path
systemClasspath
else
if
includeAntRuntime
classpath
addExisting
compileClasspath
concatSystemClasspath
else
classpath
addExisting
compileClasspath
concatSystemClasspath
if
includeJavaRuntime
if
System
getProperty
toLowerCase
indexOf
FileSet
msZipFiles
new
FileSet
msZipFiles
setDir
new
File
System
getProperty
File
separator
msZipFiles
setIncludes
classpath
addFileset
msZipFiles
else
if
Project
getJavaVersion
Project
JAVA_1_1
classpath
addExisting
new
Path
System
getProperty
File
separator
File
separator
else
classpath
addExisting
new
Path
System
getProperty
File
separator
File
separator
classpath
addExisting
new
Path
System
getProperty
File
separator
File
separator
File
separator
return
classpath
protected
Commandline
setupJavacCommand
Commandline
cmd
new
Commandline
Path
classpath
getCompileClasspath
if
deprecation
cmd
createArgument
setValue
if
destDir
cmd
createArgument
setValue
cmd
createArgument
setFile
destDir
cmd
createArgument
setValue
if
Project
getJavaVersion
startsWith
cmd
createArgument
setValue
classpath
toString
File
pathSeparator
src
toString
else
cmd
createArgument
setPath
classpath
cmd
createArgument
setValue
cmd
createArgument
setPath
src
if
target
cmd
createArgument
setValue
cmd
createArgument
setValue
target
if
encoding
cmd
createArgument
setValue
cmd
createArgument
setValue
encoding
if
debug
cmd
createArgument
setValue
if
optimize
cmd
createArgument
setValue
if
bootclasspath
cmd
createArgument
setValue
cmd
createArgument
setPath
bootclasspath
if
extdirs
cmd
createArgument
setValue
cmd
createArgument
setPath
extdirs
if
depend
if
Project
getJavaVersion
startsWith
cmd
createArgument
setValue
else
if
Project
getJavaVersion
startsWith
cmd
createArgument
setValue
else
attributes
log
Project
MSG_WARN
if
verbose
cmd
createArgument
setValue
logAndAddFilesToCompile
cmd
return
cmd
protected
void
logAndAddFilesToCompile
Commandline
cmd
attributes
log
cmd
toString
Project
MSG_VERBOSE
StringBuffer
niceSourceList
new
StringBuffer
if
compileList
length
niceSourceList
append
niceSourceList
append
niceSourceList
append
lSep
for
int
i
i
compileList
length
i
String
arg
compileList
i
getAbsolutePath
cmd
createArgument
setValue
arg
niceSourceList
append
arg
lSep
attributes
log
niceSourceList
toString
Project
MSG_VERBOSE
protected
int
executeExternalCompile
String
args
int
firstFileName
String
commandArray
File
tmpFile
try
if
Commandline
toString
args
length
PrintWriter
out
try
tmpFile
new
File
new
Random
System
currentTimeMillis
nextLong
out
new
PrintWriter
new
FileWriter
tmpFile
for
int
i
firstFileName
i
args
length
i
out
println
args
i
out
flush
commandArray
new
String
firstFileName
System
arraycopy
args
commandArray
firstFileName
commandArray
firstFileName
tmpFile
getAbsolutePath
catch
IOException
e
throw
new
BuildException
e
location
finally
if
out
try
out
close
catch
Throwable
t
else
commandArray
args
try
Execute
exe
new
Execute
new
LogStreamHandler
attributes
Project
MSG_INFO
Project
MSG_WARN
exe
setAntRun
project
exe
setWorkingDirectory
project
getBaseDir
exe
setCommandline
commandArray
exe
execute
return
exe
getExitValue
catch
IOException
e
throw
new
BuildException
args
e
location
finally
if
tmpFile
tmpFile
delete
protected
void
addExtdirsToClasspath
Path
classpath
if
extdirs
String
extProp
System
getProperty
if
extProp
extdirs
new
Path
project
extProp
else
return
String
dirs
extdirs
list
for
int
i
i
dirs
length
i
if
dirs
i
endsWith
File
separator
dirs
i
File
separator
File
dir
project
resolveFile
dirs
i
FileSet
fs
new
FileSet
fs
setDir
dir
fs
setIncludes
classpath
addFileset
fs
