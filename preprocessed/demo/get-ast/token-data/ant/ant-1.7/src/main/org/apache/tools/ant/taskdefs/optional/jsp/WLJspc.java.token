package
org
apache
tools
ant
taskdefs
optional
jsp
import
java
io
File
import
java
util
Date
import
java
util
StringTokenizer
import
java
util
Vector
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
DirectoryScanner
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
taskdefs
Java
import
org
apache
tools
ant
taskdefs
MatchingTask
import
org
apache
tools
ant
types
Path
public
class
WLJspc
extends
MatchingTask
private
File
destinationDirectory
private
File
sourceDirectory
private
String
destinationPackage
private
Path
compileClasspath
private
String
pathToPackage
private
Vector
filesToDo
new
Vector
public
void
execute
throws
BuildException
if
destinationDirectory
isDirectory
throw
new
BuildException
destinationDirectory
getPath
if
sourceDirectory
isDirectory
throw
new
BuildException
sourceDirectory
getPath
if
destinationPackage
throw
new
BuildException
getLocation
pathToPackage
this
destinationPackage
replace
File
separatorChar
DirectoryScanner
ds
super
getDirectoryScanner
sourceDirectory
if
compileClasspath
compileClasspath
new
Path
getProject
compileClasspath
compileClasspath
concatSystemClasspath
String
files
ds
getIncludedFiles
Java
helperTask
new
Java
this
helperTask
setFork
helperTask
setClassname
helperTask
setTaskName
getTaskName
String
args
new
String
File
jspFile
String
parents
int
j
args
j
args
j
destinationDirectory
getAbsolutePath
trim
args
j
args
j
sourceDirectory
getAbsolutePath
trim
args
j
args
j
args
j
args
j
args
j
compileClasspath
toString
this
scanDir
files
log
filesToDo
size
for
int
i
i
filesToDo
size
i
String
filename
String
filesToDo
elementAt
i
jspFile
new
File
filename
args
j
parents
jspFile
getParent
if
parents
equals
parents
parents
this
replaceString
parents
File
separator
args
j
destinationPackage
parents
else
args
j
destinationPackage
args
j
sourceDirectory
File
separator
filename
helperTask
clearArgs
for
int
x
x
j
x
helperTask
createArg
setValue
args
x
helperTask
setClasspath
compileClasspath
if
helperTask
executeJava
log
filename
Project
MSG_WARN
public
void
setClasspath
Path
classpath
if
compileClasspath
compileClasspath
classpath
else
compileClasspath
append
classpath
public
Path
createClasspath
if
compileClasspath
compileClasspath
new
Path
getProject
return
compileClasspath
public
void
setSrc
File
dirName
sourceDirectory
dirName
public
void
setDest
File
dirName
destinationDirectory
dirName
public
void
setPackage
String
packageName
destinationPackage
packageName
protected
void
scanDir
String
files
long
now
new
Date
getTime
File
jspFile
String
parents
String
pack
for
int
i
i
files
length
i
File
srcFile
new
File
this
sourceDirectory
files
i
jspFile
new
File
files
i
parents
jspFile
getParent
if
parents
equals
parents
parents
this
replaceString
parents
File
separator
pack
pathToPackage
File
separator
parents
else
pack
pathToPackage
String
filePath
pack
File
separator
int
startingIndex
files
i
lastIndexOf
File
separator
files
i
lastIndexOf
File
separator
int
endingIndex
files
i
indexOf
if
endingIndex
log
files
i
Project
MSG_VERBOSE
continue
filePath
files
i
substring
startingIndex
endingIndex
filePath
File
classFile
new
File
this
destinationDirectory
filePath
if
srcFile
lastModified
now
log
files
i
Project
MSG_WARN
if
srcFile
lastModified
classFile
lastModified
filesToDo
addElement
files
i
log
files
i
Project
MSG_VERBOSE
protected
String
replaceString
String
inpString
String
escapeChars
String
replaceChars
String
localString
int
numTokens
StringTokenizer
st
new
StringTokenizer
inpString
escapeChars
numTokens
st
countTokens
for
int
i
i
numTokens
i
String
test
st
nextToken
test
test
equals
escapeChars
replaceChars
test
localString
test
return
localString
