package
org
apache
tools
ant
taskdefs
import
java
io
File
import
java
io
IOException
import
java
io
InputStream
import
java
io
OutputStream
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
Task
import
org
apache
tools
ant
types
Resource
import
org
apache
tools
ant
types
ResourceCollection
import
org
apache
tools
ant
types
resources
FileResource
public
abstract
class
Pack
extends
Task
protected
File
zipFile
protected
File
source
private
Resource
src
public
void
setZipfile
File
zipFile
this
zipFile
zipFile
public
void
setDestfile
File
zipFile
setZipfile
zipFile
public
void
setSrc
File
src
setSrcResource
new
FileResource
src
public
void
setSrcResource
Resource
src
if
src
isDirectory
throw
new
BuildException
if
src
instanceof
FileResource
source
FileResource
src
getFile
else
if
supportsNonFileResources
throw
new
BuildException
this
src
src
public
void
addConfigured
ResourceCollection
a
if
a
size
throw
new
BuildException
setSrcResource
Resource
a
iterator
next
private
void
validate
throws
BuildException
if
zipFile
throw
new
BuildException
getLocation
if
zipFile
isDirectory
throw
new
BuildException
getLocation
if
getSrcResource
throw
new
BuildException
getLocation
public
void
execute
throws
BuildException
validate
Resource
s
getSrcResource
if
s
isExists
log
s
toString
else
if
zipFile
lastModified
s
getLastModified
log
zipFile
getAbsolutePath
pack
else
log
zipFile
getAbsolutePath
private
void
zipFile
InputStream
in
OutputStream
zOut
throws
IOException
byte
buffer
new
byte
int
count
do
zOut
write
buffer
count
count
in
read
buffer
buffer
length
while
count
protected
void
zipFile
File
file
OutputStream
zOut
throws
IOException
zipResource
new
FileResource
file
zOut
protected
void
zipResource
Resource
resource
OutputStream
zOut
throws
IOException
InputStream
rIn
resource
getInputStream
try
zipFile
rIn
zOut
finally
rIn
close
protected
abstract
void
pack
public
Resource
getSrcResource
return
src
protected
boolean
supportsNonFileResources
return
