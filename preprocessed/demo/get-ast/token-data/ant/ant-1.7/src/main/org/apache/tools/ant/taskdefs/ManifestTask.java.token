package
org
apache
tools
ant
taskdefs
import
java
io
File
import
java
io
FileInputStream
import
java
io
InputStreamReader
import
java
io
FileOutputStream
import
java
io
OutputStreamWriter
import
java
io
IOException
import
java
io
PrintWriter
import
java
util
Enumeration
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
Task
import
org
apache
tools
ant
util
FileUtils
import
org
apache
tools
ant
types
EnumeratedAttribute
public
class
ManifestTask
extends
Task
private
Manifest
nestedManifest
new
Manifest
private
File
manifestFile
private
Mode
mode
private
String
encoding
public
static
class
Mode
extends
EnumeratedAttribute
public
String
getValues
return
new
String
public
ManifestTask
mode
new
Mode
mode
setValue
public
void
addConfiguredSection
Manifest
Section
section
throws
ManifestException
nestedManifest
addConfiguredSection
section
public
void
addConfiguredAttribute
Manifest
Attribute
attribute
throws
ManifestException
nestedManifest
addConfiguredAttribute
attribute
public
void
setFile
File
f
manifestFile
f
public
void
setEncoding
String
encoding
this
encoding
encoding
public
void
setMode
Mode
m
mode
m
public
void
execute
throws
BuildException
if
manifestFile
throw
new
BuildException
Manifest
toWrite
Manifest
getDefaultManifest
Manifest
current
BuildException
error
if
manifestFile
exists
FileInputStream
fis
InputStreamReader
isr
try
fis
new
FileInputStream
manifestFile
if
encoding
isr
new
InputStreamReader
fis
else
isr
new
InputStreamReader
fis
encoding
current
new
Manifest
isr
catch
ManifestException
m
error
new
BuildException
manifestFile
m
getLocation
catch
IOException
e
error
new
BuildException
manifestFile
e
getLocation
finally
FileUtils
close
isr
for
Enumeration
e
nestedManifest
getWarnings
e
hasMoreElements
log
String
e
nextElement
Project
MSG_WARN
try
if
mode
getValue
equals
manifestFile
exists
if
current
toWrite
merge
current
else
if
error
throw
error
toWrite
merge
nestedManifest
catch
ManifestException
m
throw
new
BuildException
m
getLocation
if
toWrite
equals
current
log
Project
MSG_VERBOSE
return
PrintWriter
w
try
FileOutputStream
fos
new
FileOutputStream
manifestFile
OutputStreamWriter
osw
new
OutputStreamWriter
fos
Manifest
JAR_ENCODING
w
new
PrintWriter
osw
toWrite
write
w
catch
IOException
e
throw
new
BuildException
manifestFile
e
getLocation
finally
if
w
w
close
