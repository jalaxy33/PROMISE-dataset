package
org
apache
tools
ant
taskdefs
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
ProjectHelper
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
Task
import
org
apache
tools
ant
util
FileUtils
import
java
io
File
import
java
util
Vector
public
class
ImportTask
extends
Task
private
String
file
private
boolean
optional
private
static
final
FileUtils
FILE_UTILS
FileUtils
getFileUtils
public
void
setOptional
boolean
optional
this
optional
optional
public
void
setFile
String
file
this
file
file
public
void
execute
if
file
throw
new
BuildException
if
getOwningTarget
equals
getOwningTarget
getName
throw
new
BuildException
ProjectHelper
helper
ProjectHelper
getProject
getReference
ProjectHelper
PROJECTHELPER_REFERENCE
if
helper
throw
new
BuildException
Vector
importStack
helper
getImportStack
if
importStack
size
throw
new
BuildException
if
getLocation
getLocation
getFileName
throw
new
BuildException
File
buildFile
new
File
getLocation
getFileName
getAbsoluteFile
File
buildFileParent
new
File
buildFile
getParent
File
importedFile
FILE_UTILS
resolveFile
buildFileParent
file
getProject
log
importedFile
buildFile
getAbsolutePath
Project
MSG_VERBOSE
if
importedFile
exists
String
message
file
buildFile
getAbsolutePath
if
optional
getProject
log
message
Project
MSG_VERBOSE
return
else
throw
new
BuildException
message
if
importStack
contains
importedFile
getProject
log
importedFile
Project
MSG_VERBOSE
return
try
helper
parse
getProject
importedFile
catch
BuildException
ex
throw
ProjectHelper
addLocationToBuildException
ex
getLocation
