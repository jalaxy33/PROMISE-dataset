package
org
apache
tools
ant
filters
import
java
io
FileInputStream
import
java
io
IOException
import
java
io
Reader
import
java
util
Enumeration
import
java
util
Hashtable
import
java
util
Properties
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
types
Parameter
import
org
apache
tools
ant
util
FileUtils
public
final
class
ReplaceTokens
extends
BaseParamFilterReader
implements
ChainableReader
private
static
final
char
DEFAULT_BEGIN_TOKEN
private
static
final
char
DEFAULT_END_TOKEN
private
String
queuedData
private
String
replaceData
private
int
replaceIndex
private
int
queueIndex
private
Hashtable
hash
new
Hashtable
private
char
beginToken
DEFAULT_BEGIN_TOKEN
private
char
endToken
DEFAULT_END_TOKEN
public
ReplaceTokens
super
public
ReplaceTokens
final
Reader
in
super
in
private
int
getNextChar
throws
IOException
if
queueIndex
final
int
ch
queuedData
charAt
queueIndex
if
queueIndex
queuedData
length
queueIndex
return
ch
return
in
read
public
int
read
throws
IOException
if
getInitialized
initialize
setInitialized
if
replaceIndex
final
int
ch
replaceData
charAt
replaceIndex
if
replaceIndex
replaceData
length
replaceIndex
return
ch
int
ch
getNextChar
if
ch
beginToken
final
StringBuffer
key
new
StringBuffer
do
ch
getNextChar
if
ch
key
append
char
ch
else
break
while
ch
endToken
if
ch
if
queuedData
queueIndex
queuedData
key
toString
else
queuedData
key
toString
queuedData
substring
queueIndex
queueIndex
return
beginToken
else
key
setLength
key
length
final
String
replaceWith
String
hash
get
key
toString
if
replaceWith
if
replaceWith
length
replaceData
replaceWith
replaceIndex
return
read
else
String
newData
key
toString
endToken
if
queuedData
queueIndex
queuedData
newData
else
queuedData
newData
queuedData
substring
queueIndex
queueIndex
return
beginToken
return
ch
public
void
setBeginToken
final
char
beginToken
this
beginToken
beginToken
private
char
getBeginToken
return
beginToken
public
void
setEndToken
final
char
endToken
this
endToken
endToken
private
char
getEndToken
return
endToken
public
void
addConfiguredToken
final
Token
token
hash
put
token
getKey
token
getValue
private
Properties
getPropertiesFromFile
String
fileName
FileInputStream
in
Properties
props
new
Properties
try
in
new
FileInputStream
fileName
props
load
in
catch
IOException
ioe
ioe
printStackTrace
finally
FileUtils
close
in
return
props
private
void
setTokens
final
Hashtable
hash
this
hash
hash
private
Hashtable
getTokens
return
hash
public
Reader
chain
final
Reader
rdr
ReplaceTokens
newFilter
new
ReplaceTokens
rdr
newFilter
setBeginToken
getBeginToken
newFilter
setEndToken
getEndToken
newFilter
setTokens
getTokens
newFilter
setInitialized
return
newFilter
private
void
initialize
Parameter
params
getParameters
if
params
for
int
i
i
params
length
i
if
params
i
final
String
type
params
i
getType
if
equals
type
final
String
name
params
i
getName
String
value
params
i
getValue
if
equals
name
if
value
length
throw
new
BuildException
beginToken
params
i
getValue
charAt
else
if
equals
name
if
value
length
throw
new
BuildException
endToken
params
i
getValue
charAt
else
if
equals
type
final
String
name
params
i
getName
final
String
value
params
i
getValue
hash
put
name
value
else
if
equals
type
Properties
props
getPropertiesFromFile
params
i
getValue
for
Enumeration
e
props
keys
e
hasMoreElements
String
key
String
e
nextElement
String
value
props
getProperty
key
hash
put
key
value
public
static
class
Token
private
String
key
private
String
value
public
final
void
setKey
String
key
this
key
key
public
final
void
setValue
String
value
this
value
value
public
final
String
getKey
return
key
public
final
String
getValue
return
value
