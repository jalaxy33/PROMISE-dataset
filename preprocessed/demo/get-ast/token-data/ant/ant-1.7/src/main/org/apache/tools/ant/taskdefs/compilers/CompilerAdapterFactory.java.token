package
org
apache
tools
ant
taskdefs
compilers
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
Task
import
org
apache
tools
ant
util
ClasspathUtils
import
org
apache
tools
ant
util
JavaEnvUtils
public
final
class
CompilerAdapterFactory
private
static
final
String
MODERN_COMPILER
private
CompilerAdapterFactory
public
static
CompilerAdapter
getCompiler
String
compilerType
Task
task
throws
BuildException
boolean
isClassicCompilerSupported
if
JavaEnvUtils
isJavaVersion
JavaEnvUtils
JAVA_1_2
JavaEnvUtils
isJavaVersion
JavaEnvUtils
JAVA_1_3
isClassicCompilerSupported
if
compilerType
equalsIgnoreCase
return
new
Jikes
if
compilerType
equalsIgnoreCase
return
new
JavacExternal
if
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
if
isClassicCompilerSupported
return
new
Javac12
else
task
log
Project
MSG_WARN
compilerType
if
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
if
doesModernCompilerExist
return
new
Javac13
else
if
isClassicCompilerSupported
task
log
Project
MSG_WARN
return
new
Javac12
else
throw
new
BuildException
MODERN_COMPILER
JavaEnvUtils
getJavaHome
if
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
return
new
Jvc
if
compilerType
equalsIgnoreCase
return
new
Kjc
if
compilerType
equalsIgnoreCase
return
new
Gcj
if
compilerType
equalsIgnoreCase
compilerType
equalsIgnoreCase
return
new
Sj
return
resolveClassName
compilerType
private
static
boolean
doesModernCompilerExist
try
Class
forName
MODERN_COMPILER
return
catch
ClassNotFoundException
cnfe
try
ClassLoader
cl
CompilerAdapterFactory
class
getClassLoader
if
cl
cl
loadClass
MODERN_COMPILER
return
catch
ClassNotFoundException
cnfe2
return
private
static
CompilerAdapter
resolveClassName
String
className
throws
BuildException
return
CompilerAdapter
ClasspathUtils
newInstance
className
CompilerAdapterFactory
class
getClassLoader
CompilerAdapter
class
