package
org
apache
tools
ant
types
selectors
import
java
io
File
import
java
text
DateFormat
import
java
text
SimpleDateFormat
import
java
text
ParseException
import
java
util
Locale
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
types
Parameter
import
org
apache
tools
ant
types
TimeComparison
import
org
apache
tools
ant
util
FileUtils
public
class
DateSelector
extends
BaseExtendSelector
private
static
final
FileUtils
FILE_UTILS
FileUtils
getFileUtils
private
long
millis
private
String
dateTime
private
boolean
includeDirs
private
long
granularity
private
String
pattern
private
TimeComparison
when
TimeComparison
EQUAL
public
static
final
String
MILLIS_KEY
public
static
final
String
DATETIME_KEY
public
static
final
String
CHECKDIRS_KEY
public
static
final
String
GRANULARITY_KEY
public
static
final
String
WHEN_KEY
public
static
final
String
PATTERN_KEY
public
DateSelector
granularity
FILE_UTILS
getFileTimestampGranularity
public
String
toString
StringBuffer
buf
new
StringBuffer
buf
append
dateTime
buf
append
append
when
getValue
buf
append
buf
append
granularity
if
pattern
buf
append
append
pattern
buf
append
return
buf
toString
public
void
setMillis
long
millis
this
millis
millis
public
long
getMillis
if
dateTime
validate
return
millis
public
void
setDatetime
String
dateTime
this
dateTime
dateTime
millis
public
void
setCheckdirs
boolean
includeDirs
this
includeDirs
includeDirs
public
void
setGranularity
int
granularity
this
granularity
granularity
public
void
setWhen
TimeComparisons
tcmp
setWhen
TimeComparison
tcmp
public
void
setWhen
TimeComparison
t
when
t
public
void
setPattern
String
pattern
this
pattern
pattern
public
void
setParameters
Parameter
parameters
super
setParameters
parameters
if
parameters
for
int
i
i
parameters
length
i
String
paramname
parameters
i
getName
if
MILLIS_KEY
equalsIgnoreCase
paramname
try
setMillis
new
Long
parameters
i
getValue
longValue
catch
NumberFormatException
nfe
setError
parameters
i
getValue
else
if
DATETIME_KEY
equalsIgnoreCase
paramname
setDatetime
parameters
i
getValue
else
if
CHECKDIRS_KEY
equalsIgnoreCase
paramname
setCheckdirs
Project
toBoolean
parameters
i
getValue
else
if
GRANULARITY_KEY
equalsIgnoreCase
paramname
try
setGranularity
new
Integer
parameters
i
getValue
intValue
catch
NumberFormatException
nfe
setError
parameters
i
getValue
else
if
WHEN_KEY
equalsIgnoreCase
paramname
setWhen
new
TimeComparison
parameters
i
getValue
else
if
PATTERN_KEY
equalsIgnoreCase
paramname
setPattern
parameters
i
getValue
else
setError
paramname
public
void
verifySettings
if
dateTime
millis
setError
else
if
millis
dateTime
DateFormat
df
pattern
DateFormat
getDateTimeInstance
DateFormat
SHORT
DateFormat
SHORT
Locale
US
new
SimpleDateFormat
pattern
try
setMillis
df
parse
dateTime
getTime
if
millis
setError
dateTime
catch
ParseException
pe
setError
dateTime
pattern
pattern
public
boolean
isSelected
File
basedir
String
filename
File
file
validate
return
file
isDirectory
includeDirs
when
evaluate
file
lastModified
millis
granularity
public
static
class
TimeComparisons
extends
TimeComparison
