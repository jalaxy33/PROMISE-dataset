package
org
apache
tools
ant
taskdefs
cvslib
import
java
text
ParseException
import
java
text
SimpleDateFormat
import
java
util
Date
import
java
util
Enumeration
import
java
util
Hashtable
import
java
util
Locale
import
java
util
TimeZone
class
ChangeLogParser
private
static
final
int
GET_FILE
private
static
final
int
GET_DATE
private
static
final
int
GET_COMMENT
private
static
final
int
GET_REVISION
private
static
final
int
GET_PREVIOUS_REV
private
static
final
SimpleDateFormat
INPUT_DATE
new
SimpleDateFormat
Locale
US
private
static
final
SimpleDateFormat
CVS1129_INPUT_DATE
new
SimpleDateFormat
Locale
US
static
TimeZone
utc
TimeZone
getTimeZone
INPUT_DATE
setTimeZone
utc
CVS1129_INPUT_DATE
setTimeZone
utc
private
String
file
private
String
date
private
String
author
private
String
comment
private
String
revision
private
String
previousRevision
private
int
status
GET_FILE
private
final
Hashtable
entries
new
Hashtable
public
CVSEntry
getEntrySetAsArray
final
CVSEntry
array
new
CVSEntry
entries
size
int
i
for
Enumeration
e
entries
elements
e
hasMoreElements
array
i
CVSEntry
e
nextElement
return
array
public
void
stdout
final
String
line
switch
status
case
GET_FILE
reset
processFile
line
break
case
GET_REVISION
processRevision
line
break
case
GET_DATE
processDate
line
break
case
GET_COMMENT
processComment
line
break
case
GET_PREVIOUS_REV
processGetPreviousRevision
line
break
default
break
private
void
processComment
final
String
line
final
String
lineSeparator
System
getProperty
if
line
equals
final
int
end
comment
length
lineSeparator
length
comment
comment
substring
end
saveEntry
status
GET_FILE
else
if
line
equals
final
int
end
comment
length
lineSeparator
length
comment
comment
substring
end
status
GET_PREVIOUS_REV
else
comment
line
lineSeparator
private
void
processFile
final
String
line
if
line
startsWith
file
line
substring
line
length
status
GET_REVISION
private
void
processRevision
final
String
line
if
line
startsWith
revision
line
substring
status
GET_DATE
else
if
line
startsWith
status
GET_FILE
private
void
processDate
final
String
line
if
line
startsWith
int
endOfDateIndex
line
indexOf
date
line
substring
length
endOfDateIndex
int
startOfAuthorIndex
line
indexOf
endOfDateIndex
int
endOfAuthorIndex
line
indexOf
startOfAuthorIndex
author
line
substring
length
startOfAuthorIndex
endOfAuthorIndex
status
GET_COMMENT
comment
private
void
processGetPreviousRevision
final
String
line
if
line
startsWith
throw
new
IllegalStateException
line
previousRevision
line
substring
length
saveEntry
revision
previousRevision
status
GET_DATE
private
void
saveEntry
final
String
entryKey
date
author
comment
CVSEntry
entry
if
entries
containsKey
entryKey
Date
dateObject
parseDate
date
entry
new
CVSEntry
dateObject
author
comment
entries
put
entryKey
entry
else
entry
CVSEntry
entries
get
entryKey
entry
addFile
file
revision
previousRevision
private
Date
parseDate
final
String
date
try
return
INPUT_DATE
parse
date
catch
ParseException
e
try
return
CVS1129_INPUT_DATE
parse
date
catch
ParseException
e2
throw
new
IllegalStateException
date
public
void
reset
this
file
this
date
this
author
this
comment
this
revision
this
previousRevision
