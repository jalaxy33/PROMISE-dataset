package
org
apache
tools
ant
taskdefs
import
java
io
File
import
java
io
IOException
import
java
util
Locale
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
types
ZipFileSet
import
org
apache
tools
ant
util
FileUtils
import
org
apache
tools
zip
ZipOutputStream
public
class
War
extends
Jar
private
File
deploymentDescriptor
private
boolean
needxmlfile
private
File
addedWebXmlFile
private
static
final
FileUtils
FILE_UTILS
FileUtils
getFileUtils
private
static
final
String
XML_DESCRIPTOR_PATH
private
static
final
String
XML_DESCRIPTOR_PATH_LC
XML_DESCRIPTOR_PATH
toLowerCase
Locale
ENGLISH
public
War
super
archiveType
emptyBehavior
public
void
setWarfile
File
warFile
setDestFile
warFile
public
void
setWebxml
File
descr
deploymentDescriptor
descr
if
deploymentDescriptor
exists
throw
new
BuildException
deploymentDescriptor
ZipFileSet
fs
new
ZipFileSet
fs
setFile
deploymentDescriptor
fs
setFullpath
XML_DESCRIPTOR_PATH
super
addFileset
fs
public
void
setNeedxmlfile
boolean
needxmlfile
this
needxmlfile
needxmlfile
public
void
addLib
ZipFileSet
fs
fs
setPrefix
super
addFileset
fs
public
void
addClasses
ZipFileSet
fs
fs
setPrefix
super
addFileset
fs
public
void
addWebinf
ZipFileSet
fs
fs
setPrefix
super
addFileset
fs
protected
void
initZipOutputStream
ZipOutputStream
zOut
throws
IOException
BuildException
super
initZipOutputStream
zOut
protected
void
zipFile
File
file
ZipOutputStream
zOut
String
vPath
int
mode
throws
IOException
String
vPathLowerCase
vPath
toLowerCase
Locale
ENGLISH
boolean
addFile
if
XML_DESCRIPTOR_PATH_LC
equals
vPathLowerCase
if
addedWebXmlFile
addFile
if
FILE_UTILS
fileNameEquals
addedWebXmlFile
file
log
archiveType
XML_DESCRIPTOR_PATH
file
addedWebXmlFile
Project
MSG_WARN
else
addedWebXmlFile
file
addFile
deploymentDescriptor
file
if
addFile
super
zipFile
file
zOut
vPath
mode
protected
void
cleanUp
if
addedWebXmlFile
deploymentDescriptor
needxmlfile
isInUpdateMode
throw
new
BuildException
addedWebXmlFile
super
cleanUp
