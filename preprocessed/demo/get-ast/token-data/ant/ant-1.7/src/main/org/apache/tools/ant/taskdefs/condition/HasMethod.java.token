package
org
apache
tools
ant
taskdefs
condition
import
org
apache
tools
ant
types
Path
import
org
apache
tools
ant
types
Reference
import
org
apache
tools
ant
AntClassLoader
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
ProjectComponent
import
java
lang
reflect
Method
import
java
lang
reflect
Field
public
class
HasMethod
extends
ProjectComponent
implements
Condition
private
String
classname
private
String
method
private
String
field
private
Path
classpath
private
AntClassLoader
loader
private
boolean
ignoreSystemClasses
public
void
setClasspath
Path
classpath
createClasspath
append
classpath
public
Path
createClasspath
if
this
classpath
this
classpath
new
Path
getProject
return
this
classpath
createPath
public
void
setClasspathRef
Reference
r
createClasspath
setRefid
r
public
void
setClassname
String
classname
this
classname
classname
public
void
setMethod
String
method
this
method
method
public
void
setField
String
field
this
field
field
public
void
setIgnoreSystemClasses
boolean
ignoreSystemClasses
this
ignoreSystemClasses
ignoreSystemClasses
private
Class
loadClass
String
classname
try
if
ignoreSystemClasses
loader
getProject
createClassLoader
classpath
loader
setParentFirst
loader
addJavaLibraries
if
loader
try
return
loader
findClass
classname
catch
SecurityException
se
return
else
return
else
if
loader
return
loader
loadClass
classname
else
ClassLoader
l
this
getClass
getClassLoader
if
l
return
Class
forName
classname
l
else
return
Class
forName
classname
catch
ClassNotFoundException
e
throw
new
BuildException
classname
catch
NoClassDefFoundError
e
throw
new
BuildException
e
getMessage
classname
public
boolean
eval
throws
BuildException
if
classname
throw
new
BuildException
Class
clazz
loadClass
classname
if
method
return
isMethodFound
clazz
if
field
return
isFieldFound
clazz
throw
new
BuildException
private
boolean
isFieldFound
Class
clazz
Field
fields
clazz
getDeclaredFields
for
int
i
i
fields
length
i
Field
fieldEntry
fields
i
if
fieldEntry
getName
equals
field
return
return
private
boolean
isMethodFound
Class
clazz
Method
methods
clazz
getDeclaredMethods
for
int
i
i
methods
length
i
Method
methodEntry
methods
i
if
methodEntry
getName
equals
method
return
return
