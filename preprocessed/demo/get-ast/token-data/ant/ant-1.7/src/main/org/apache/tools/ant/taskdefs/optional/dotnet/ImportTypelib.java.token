package
org
apache
tools
ant
taskdefs
optional
dotnet
import
org
apache
tools
ant
Task
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
util
FileUtils
import
java
io
File
public
class
ImportTypelib
extends
Task
private
static
final
FileUtils
FILE_UTILS
FileUtils
getFileUtils
private
File
srcFile
private
File
destFile
private
String
namespace
private
boolean
useSysArray
private
boolean
unsafe
private
String
extraOptions
public
void
setDestFile
File
destFile
this
destFile
destFile
public
void
setNamespace
String
namespace
this
namespace
namespace
public
void
setSrcFile
File
srcFile
this
srcFile
srcFile
public
void
setUnsafe
boolean
unsafe
this
unsafe
unsafe
public
void
setUseSysArray
boolean
useSysArray
this
useSysArray
useSysArray
public
void
setExtraOptions
String
extraOptions
this
extraOptions
extraOptions
protected
void
validate
throws
BuildException
if
destFile
throw
new
BuildException
if
destFile
isDirectory
throw
new
BuildException
if
srcFile
srcFile
exists
throw
new
BuildException
if
srcFile
isDirectory
throw
new
BuildException
if
namespace
throw
new
BuildException
private
boolean
isExecuteNeeded
if
destFile
exists
log
Project
MSG_VERBOSE
return
long
sourceTime
srcFile
lastModified
long
destTime
destFile
lastModified
if
sourceTime
destTime
FILE_UTILS
getFileTimestampGranularity
log
Project
MSG_VERBOSE
return
else
log
Project
MSG_VERBOSE
return
public
void
execute
throws
BuildException
log
Project
MSG_WARN
validate
log
srcFile
destFile
namespace
Project
MSG_VERBOSE
if
isExecuteNeeded
return
NetCommand
command
new
NetCommand
this
command
setFailOnError
command
addArgument
srcFile
toString
command
addArgument
command
addArgument
destFile
command
addArgument
namespace
if
useSysArray
command
addArgument
if
unsafe
command
addArgument
command
addArgument
extraOptions
command
runCommand
