package
org
apache
tools
ant
taskdefs
import
org
apache
tools
ant
import
java
io
import
java
util
zip
public
class
GZip
extends
Task
private
File
zipFile
private
File
source
public
void
setZipfile
File
zipFilename
zipFile
zipFilename
public
void
setSrc
File
src
source
src
public
void
execute
throws
BuildException
if
zipFile
throw
new
BuildException
location
if
source
throw
new
BuildException
location
log
zipFile
getAbsolutePath
GZIPOutputStream
zOut
try
zOut
new
GZIPOutputStream
new
FileOutputStream
zipFile
if
source
isDirectory
log
Project
MSG_ERR
else
zipFile
source
zOut
catch
IOException
ioe
String
msg
ioe
getMessage
throw
new
BuildException
msg
ioe
location
finally
if
zOut
try
zOut
close
catch
IOException
e
private
void
zipFile
InputStream
in
GZIPOutputStream
zOut
throws
IOException
byte
buffer
new
byte
int
count
do
zOut
write
buffer
count
count
in
read
buffer
buffer
length
while
count
private
void
zipFile
File
file
GZIPOutputStream
zOut
throws
IOException
FileInputStream
fIn
new
FileInputStream
file
try
zipFile
fIn
zOut
finally
fIn
close
