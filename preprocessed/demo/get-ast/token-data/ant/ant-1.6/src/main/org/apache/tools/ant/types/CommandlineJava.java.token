package
org
apache
tools
ant
types
import
java
util
Enumeration
import
java
util
Properties
import
java
util
Vector
import
java
util
List
import
java
util
LinkedList
import
java
util
ListIterator
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
Project
import
org
apache
tools
ant
util
JavaEnvUtils
public
class
CommandlineJava
implements
Cloneable
private
Commandline
vmCommand
new
Commandline
private
Commandline
javaCommand
new
Commandline
private
SysProperties
sysProperties
new
SysProperties
private
Path
classpath
private
Path
bootclasspath
private
String
vmVersion
private
String
maxMemory
private
Assertions
assertions
private
boolean
executeJar
public
static
class
SysProperties
extends
Environment
implements
Cloneable
Properties
sys
private
Vector
propertySets
new
Vector
public
String
getVariables
throws
BuildException
List
definitions
new
LinkedList
ListIterator
list
definitions
listIterator
addDefinitionsToList
list
if
definitions
size
return
else
return
String
definitions
toArray
new
String
public
void
addDefinitionsToList
ListIterator
listIt
String
props
super
getVariables
if
props
for
int
i
i
props
length
i
listIt
add
props
i
Properties
propertySets
mergePropertySets
for
Enumeration
e
propertySets
keys
e
hasMoreElements
String
key
String
e
nextElement
String
value
propertySets
getProperty
key
listIt
add
key
value
public
int
size
Properties
p
mergePropertySets
return
variables
size
p
size
public
void
setSystem
throws
BuildException
try
sys
System
getProperties
Properties
p
new
Properties
for
Enumeration
e
sys
keys
e
hasMoreElements
Object
o
e
nextElement
p
put
o
sys
get
o
p
putAll
mergePropertySets
for
Enumeration
e
variables
elements
e
hasMoreElements
Environment
Variable
v
Environment
Variable
e
nextElement
p
put
v
getKey
v
getValue
System
setProperties
p
catch
SecurityException
e
throw
new
BuildException
e
public
void
restoreSystem
throws
BuildException
if
sys
throw
new
BuildException
try
System
setProperties
sys
sys
catch
SecurityException
e
throw
new
BuildException
e
public
Object
clone
try
SysProperties
c
SysProperties
super
clone
c
variables
Vector
variables
clone
c
propertySets
Vector
propertySets
clone
return
c
catch
CloneNotSupportedException
e
return
public
void
addSyspropertyset
PropertySet
ps
propertySets
addElement
ps
private
Properties
mergePropertySets
Properties
p
new
Properties
for
Enumeration
e
propertySets
elements
e
hasMoreElements
PropertySet
ps
PropertySet
e
nextElement
p
putAll
ps
getProperties
return
p
public
CommandlineJava
setVm
JavaEnvUtils
getJreExecutable
setVmversion
JavaEnvUtils
getJavaVersion
public
Commandline
Argument
createArgument
return
javaCommand
createArgument
public
Commandline
Argument
createVmArgument
return
vmCommand
createArgument
public
void
addSysproperty
Environment
Variable
sysp
sysProperties
addVariable
sysp
public
void
addSyspropertyset
PropertySet
sysp
sysProperties
addSyspropertyset
sysp
public
void
setVm
String
vm
vmCommand
setExecutable
vm
public
void
setVmversion
String
value
vmVersion
value
public
Assertions
getAssertions
return
assertions
public
void
setAssertions
Assertions
assertions
this
assertions
assertions
public
void
setJar
String
jarpathname
javaCommand
setExecutable
jarpathname
executeJar
public
String
getJar
if
executeJar
return
javaCommand
getExecutable
return
public
void
setClassname
String
classname
javaCommand
setExecutable
classname
executeJar
public
String
getClassname
if
executeJar
return
javaCommand
getExecutable
return
public
Path
createClasspath
Project
p
if
classpath
classpath
new
Path
p
return
classpath
public
Path
createBootclasspath
Project
p
if
bootclasspath
bootclasspath
new
Path
p
return
bootclasspath
public
String
getVmversion
return
vmVersion
public
String
getCommandline
List
commands
new
LinkedList
final
ListIterator
listIterator
commands
listIterator
addCommandsToList
listIterator
return
String
commands
toArray
new
String
private
void
addCommandsToList
final
ListIterator
listIterator
getActualVMCommand
addCommandToList
listIterator
sysProperties
addDefinitionsToList
listIterator
if
haveBootclasspath
listIterator
add
bootclasspath
toString
if
haveClasspath
listIterator
add
listIterator
add
classpath
concatSystemClasspath
toString
if
getAssertions
getAssertions
applyAssertions
this
if
executeJar
listIterator
add
javaCommand
addCommandToList
listIterator
public
void
setMaxmemory
String
max
this
maxMemory
max
public
String
toString
return
Commandline
toString
getCommandline
public
String
describeCommand
return
Commandline
describeCommand
getCommandline
public
String
describeJavaCommand
return
Commandline
describeCommand
getJavaCommand
private
Commandline
getActualVMCommand
Commandline
actualVMCommand
Commandline
vmCommand
clone
if
maxMemory
if
vmVersion
startsWith
actualVMCommand
createArgument
setValue
maxMemory
else
actualVMCommand
createArgument
setValue
maxMemory
return
actualVMCommand
public
int
size
int
size
getActualVMCommand
size
javaCommand
size
sysProperties
size
if
haveClasspath
size
if
haveBootclasspath
size
if
executeJar
size
if
getAssertions
size
getAssertions
size
return
size
public
Commandline
getJavaCommand
return
javaCommand
public
Commandline
getVmCommand
return
getActualVMCommand
public
Path
getClasspath
return
classpath
public
Path
getBootclasspath
return
bootclasspath
public
void
setSystemProperties
throws
BuildException
sysProperties
setSystem
public
void
restoreSystemProperties
throws
BuildException
sysProperties
restoreSystem
public
SysProperties
getSystemProperties
return
sysProperties
public
Object
clone
try
CommandlineJava
c
CommandlineJava
super
clone
c
vmCommand
Commandline
vmCommand
clone
c
javaCommand
Commandline
javaCommand
clone
c
sysProperties
SysProperties
sysProperties
clone
if
classpath
c
classpath
Path
classpath
clone
if
bootclasspath
c
bootclasspath
Path
bootclasspath
clone
if
assertions
c
assertions
Assertions
assertions
clone
return
c
catch
CloneNotSupportedException
e
throw
new
BuildException
e
public
void
clearJavaArgs
javaCommand
clearArgs
private
boolean
haveClasspath
Path
fullClasspath
classpath
classpath
concatSystemClasspath
return
fullClasspath
fullClasspath
toString
trim
length
private
boolean
haveBootclasspath
boolean
log
if
bootclasspath
bootclasspath
toString
trim
length
if
bootclasspath
toString
equals
bootclasspath
concatSystemClasspath
toString
if
log
System
out
println
else
if
vmVersion
startsWith
if
log
System
out
println
else
return
return
