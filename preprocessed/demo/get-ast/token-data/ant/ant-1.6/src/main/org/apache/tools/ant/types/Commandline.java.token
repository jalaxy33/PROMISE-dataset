package
org
apache
tools
ant
types
import
java
io
File
import
java
util
StringTokenizer
import
java
util
Vector
import
java
util
ArrayList
import
java
util
List
import
java
util
ListIterator
import
java
util
LinkedList
import
org
apache
tools
ant
BuildException
import
org
apache
tools
ant
ProjectComponent
import
org
apache
tools
ant
util
StringUtils
public
class
Commandline
implements
Cloneable
private
Vector
arguments
new
Vector
private
String
executable
protected
static
final
String
DISCLAIMER
StringUtils
LINE_SEP
StringUtils
LINE_SEP
StringUtils
LINE_SEP
public
Commandline
String
toProcess
super
String
tmp
translateCommandline
toProcess
if
tmp
tmp
length
setExecutable
tmp
for
int
i
i
tmp
length
i
createArgument
setValue
tmp
i
public
Commandline
super
public
static
class
Argument
extends
ProjectComponent
private
String
parts
public
void
setValue
String
value
parts
new
String
value
public
void
setLine
String
line
if
line
return
parts
translateCommandline
line
public
void
setPath
Path
value
parts
new
String
value
toString
public
void
setPathref
Reference
value
Path
p
new
Path
getProject
p
setRefid
value
parts
new
String
p
toString
public
void
setFile
File
value
parts
new
String
value
getAbsolutePath
public
String
getParts
return
parts
public
class
Marker
private
int
position
private
int
realPos
Marker
int
position
this
position
position
public
int
getPosition
if
realPos
realPos
executable
for
int
i
i
position
i
Argument
arg
Argument
arguments
elementAt
i
realPos
arg
getParts
length
return
realPos
public
Argument
createArgument
return
this
createArgument
public
Argument
createArgument
boolean
insertAtStart
Argument
argument
new
Argument
if
insertAtStart
arguments
insertElementAt
argument
else
arguments
addElement
argument
return
argument
public
void
setExecutable
String
executable
if
executable
executable
length
return
this
executable
executable
replace
File
separatorChar
replace
File
separatorChar
public
String
getExecutable
return
executable
public
void
addArguments
String
line
for
int
i
i
line
length
i
createArgument
setValue
line
i
public
String
getCommandline
List
commands
new
LinkedList
ListIterator
list
commands
listIterator
addCommandToList
list
final
String
result
new
String
commands
size
return
String
commands
toArray
result
public
void
addCommandToList
ListIterator
list
if
executable
list
add
executable
addArgumentsToList
list
public
String
getArguments
List
result
new
ArrayList
arguments
size
addArgumentsToList
result
listIterator
String
res
new
String
result
size
return
String
result
toArray
res
public
void
addArgumentsToList
ListIterator
list
for
int
i
i
arguments
size
i
Argument
arg
Argument
arguments
elementAt
i
String
s
arg
getParts
if
s
for
int
j
j
s
length
j
list
add
s
j
public
String
toString
return
toString
getCommandline
public
static
String
quoteArgument
String
argument
if
argument
indexOf
if
argument
indexOf
throw
new
BuildException
else
return
argument
else
if
argument
indexOf
argument
indexOf
return
argument
else
return
argument
public
static
String
toString
String
line
if
line
line
length
return
final
StringBuffer
result
new
StringBuffer
for
int
i
i
line
length
i
if
i
result
append
result
append
quoteArgument
line
i
return
result
toString
public
static
String
translateCommandline
String
toProcess
if
toProcess
toProcess
length
return
new
String
final
int
normal
final
int
inQuote
final
int
inDoubleQuote
int
state
normal
StringTokenizer
tok
new
StringTokenizer
toProcess
Vector
v
new
Vector
StringBuffer
current
new
StringBuffer
boolean
lastTokenHasBeenQuoted
while
tok
hasMoreTokens
String
nextTok
tok
nextToken
switch
state
case
inQuote
if
equals
nextTok
lastTokenHasBeenQuoted
state
normal
else
current
append
nextTok
break
case
inDoubleQuote
if
equals
nextTok
lastTokenHasBeenQuoted
state
normal
else
current
append
nextTok
break
default
if
equals
nextTok
state
inQuote
else
if
equals
nextTok
state
inDoubleQuote
else
if
equals
nextTok
if
lastTokenHasBeenQuoted
current
length
v
addElement
current
toString
current
new
StringBuffer
else
current
append
nextTok
lastTokenHasBeenQuoted
break
if
lastTokenHasBeenQuoted
current
length
v
addElement
current
toString
if
state
inQuote
state
inDoubleQuote
throw
new
BuildException
toProcess
String
args
new
String
v
size
v
copyInto
args
return
args
public
int
size
return
getCommandline
length
public
Object
clone
try
Commandline
c
Commandline
super
clone
c
arguments
Vector
arguments
clone
return
c
catch
CloneNotSupportedException
e
throw
new
BuildException
e
public
void
clear
executable
arguments
removeAllElements
public
void
clearArgs
arguments
removeAllElements
public
Marker
createMarker
return
new
Marker
arguments
size
public
String
describeCommand
return
describeCommand
this
public
String
describeArguments
return
describeArguments
this
public
static
String
describeCommand
Commandline
line
return
describeCommand
line
getCommandline
public
static
String
describeArguments
Commandline
line
return
describeArguments
line
getArguments
public
static
String
describeCommand
String
args
if
args
args
length
return
StringBuffer
buf
new
StringBuffer
buf
append
args
buf
append
if
args
length
buf
append
buf
append
describeArguments
args
else
buf
append
DISCLAIMER
return
buf
toString
public
static
String
describeArguments
String
args
return
describeArguments
args
protected
static
String
describeArguments
String
args
int
offset
if
args
args
length
offset
return
StringBuffer
buf
new
StringBuffer
if
args
length
offset
buf
append
buf
append
append
StringUtils
LINE_SEP
for
int
i
offset
i
args
length
i
buf
append
append
args
i
append
append
StringUtils
LINE_SEP
buf
append
DISCLAIMER
return
buf
toString
