package
org
apache
xml
serializer
import
java
io
IOException
import
java
io
OutputStream
import
java
io
UnsupportedEncodingException
import
java
io
Writer
import
java
util
Properties
import
java
util
StringTokenizer
import
java
util
Vector
import
javax
xml
transform
OutputKeys
import
javax
xml
transform
Transformer
import
org
apache
xml
res
XMLErrorResources
import
org
apache
xml
res
XMLMessages
import
org
apache
xml
utils
BoolStack
import
org
apache
xml
utils
FastStringBuffer
import
org
apache
xml
utils
QName
import
org
apache
xml
utils
TreeWalker
import
org
apache
xml
utils
WrappedRuntimeException
import
org
w3c
dom
Node
import
org
xml
sax
Attributes
import
org
xml
sax
ContentHandler
import
org
xml
sax
SAXException
abstract
public
class
ToStream
extends
SerializerBase
private
static
final
String
COMMENT_BEGIN
private
static
final
String
COMMENT_END
protected
BoolStack
m_disableOutputEscapingStates
new
BoolStack
boolean
m_triedToGetConverter
java
lang
reflect
Method
m_canConvertMeth
Object
m_charToByteConverter
protected
BoolStack
m_preserves
new
BoolStack
protected
boolean
m_ispreserve
protected
boolean
m_isprevtext
protected
int
m_maxCharacter
Encodings
getLastPrintable
protected
final
char
m_lineSep
System
getProperty
toCharArray
protected
boolean
m_lineSepUse
protected
final
int
m_lineSepLen
m_lineSep
length
protected
CharInfo
m_charInfo
boolean
m_shouldFlush
protected
boolean
m_spaceBeforeClose
boolean
m_startNewLine
protected
boolean
m_inDoctype
boolean
m_isUTF8
protected
Properties
m_format
protected
boolean
m_cdataStartCalled
public
ToStream
protected
void
closeCDATA
throws
org
xml
sax
SAXException
try
m_writer
write
CDATA_DELIMITER_CLOSE
m_cdataTagOpen
catch
IOException
e
throw
new
SAXException
e
public
void
serialize
Node
node
throws
IOException
try
TreeWalker
walker
new
TreeWalker
this
new
org
apache
xml
utils
DOM2Helper
walker
traverse
node
catch
org
xml
sax
SAXException
se
throw
new
WrappedRuntimeException
se
static
final
boolean
isUTF16Surrogate
char
c
return
c
private
boolean
m_escaping
protected
final
void
flushWriter
throws
org
xml
sax
SAXException
final
java
io
Writer
writer
m_writer
if
writer
try
if
writer
instanceof
WriterToUTF8Buffered
if
m_shouldFlush
WriterToUTF8Buffered
writer
flush
else
WriterToUTF8Buffered
writer
flushBuffer
if
writer
instanceof
WriterToASCI
if
m_shouldFlush
writer
flush
else
writer
flush
catch
IOException
ioe
throw
new
org
xml
sax
SAXException
ioe
public
OutputStream
getOutputStream
if
m_writer
instanceof
WriterToUTF8Buffered
return
WriterToUTF8Buffered
m_writer
getOutputStream
if
m_writer
instanceof
WriterToASCI
return
WriterToASCI
m_writer
getOutputStream
else
return
public
void
elementDecl
String
name
String
model
throws
SAXException
if
m_inExternalDTD
return
try
final
java
io
Writer
writer
m_writer
if
m_needToOutputDocTypeDecl
outputDocTypeDecl
m_elemContext
m_elementName
m_needToOutputDocTypeDecl
if
m_inDoctype
writer
write
writer
write
m_lineSep
m_lineSepLen
m_inDoctype
writer
write
writer
write
name
writer
write
writer
write
model
writer
write
writer
write
m_lineSep
m_lineSepLen
catch
IOException
e
throw
new
SAXException
e
public
void
internalEntityDecl
String
name
String
value
throws
SAXException
if
m_inExternalDTD
return
try
if
m_needToOutputDocTypeDecl
outputDocTypeDecl
m_elemContext
m_elementName
m_needToOutputDocTypeDecl
if
m_inDoctype
final
java
io
Writer
writer
m_writer
writer
write
writer
write
m_lineSep
m_lineSepLen
m_inDoctype
outputEntityDecl
name
value
catch
IOException
e
throw
new
SAXException
e
void
outputEntityDecl
String
name
String
value
throws
IOException
final
java
io
Writer
writer
m_writer
writer
write
writer
write
name
writer
write
writer
write
value
writer
write
writer
write
m_lineSep
m_lineSepLen
protected
final
void
outputLineSep
throws
IOException
m_writer
write
m_lineSep
m_lineSepLen
public
void
setOutputFormat
Properties
format
boolean
shouldFlush
m_shouldFlush
init
m_writer
format
m_shouldFlush
shouldFlush
private
synchronized
void
init
Writer
writer
Properties
format
boolean
defaultProperties
boolean
shouldFlush
m_shouldFlush
shouldFlush
if
m_tracer
writer
instanceof
SerializerTraceWriter
m_writer
new
SerializerTraceWriter
writer
m_tracer
else
m_writer
writer
m_format
format
setCdataSectionElements
OutputKeys
CDATA_SECTION_ELEMENTS
format
setIndentAmount
OutputPropertyUtils
getIntProperty
OutputPropertiesFactory
S_KEY_INDENT_AMOUNT
format
setIndent
OutputPropertyUtils
getBooleanProperty
OutputKeys
INDENT
format
boolean
shouldNotWriteXMLHeader
OutputPropertyUtils
getBooleanProperty
OutputKeys
OMIT_XML_DECLARATION
format
setOmitXMLDeclaration
shouldNotWriteXMLHeader
setDoctypeSystem
format
getProperty
OutputKeys
DOCTYPE_SYSTEM
String
doctypePublic
format
getProperty
OutputKeys
DOCTYPE_PUBLIC
setDoctypePublic
doctypePublic
if
format
get
OutputKeys
STANDALONE
String
val
format
getProperty
OutputKeys
STANDALONE
if
defaultProperties
setStandaloneInternal
val
else
setStandalone
val
setMediaType
format
getProperty
OutputKeys
MEDIA_TYPE
if
doctypePublic
if
doctypePublic
startsWith
m_spaceBeforeClose
String
encoding
getEncoding
if
encoding
encoding
Encodings
getMimeEncoding
format
getProperty
OutputKeys
ENCODING
setEncoding
encoding
m_isUTF8
encoding
equals
Encodings
DEFAULT_MIME_ENCODING
m_maxCharacter
Encodings
getLastPrintable
encoding
String
entitiesFileName
String
format
get
OutputPropertiesFactory
S_KEY_ENTITIES
if
entitiesFileName
String
method
String
format
get
OutputKeys
METHOD
m_charInfo
CharInfo
getCharInfo
entitiesFileName
method
private
synchronized
void
init
Writer
writer
Properties
format
init
writer
format
protected
synchronized
void
init
OutputStream
output
Properties
format
boolean
defaultProperties
throws
UnsupportedEncodingException
String
encoding
getEncoding
if
encoding
encoding
Encodings
getMimeEncoding
format
getProperty
OutputKeys
ENCODING
setEncoding
encoding
if
encoding
equalsIgnoreCase
m_isUTF8
init
new
WriterToUTF8Buffered
output
format
defaultProperties
else
if
encoding
equals
encoding
equals
encoding
equals
init
new
WriterToASCI
output
format
defaultProperties
else
Writer
osw
try
osw
Encodings
getWriter
output
encoding
catch
UnsupportedEncodingException
uee
System
out
println
encoding
Encodings
DEFAULT_MIME_ENCODING
encoding
Encodings
DEFAULT_MIME_ENCODING
setEncoding
encoding
osw
Encodings
getWriter
output
encoding
m_maxCharacter
Encodings
getLastPrintable
encoding
init
osw
format
defaultProperties
public
Properties
getOutputFormat
return
m_format
public
void
setWriter
Writer
writer
if
m_tracer
writer
instanceof
SerializerTraceWriter
m_writer
new
SerializerTraceWriter
writer
m_tracer
else
m_writer
writer
public
boolean
setLineSepUse
boolean
use_sytem_line_break
boolean
oldValue
m_lineSepUse
m_lineSepUse
use_sytem_line_break
return
oldValue
public
void
setOutputStream
OutputStream
output
try
Properties
format
if
m_format
format
OutputPropertiesFactory
getDefaultMethodProperties
Method
XML
else
format
m_format
init
output
format
catch
UnsupportedEncodingException
uee
public
boolean
setEscaping
boolean
escape
final
boolean
temp
m_escaping
m_escaping
escape
return
temp
protected
void
indent
int
depth
throws
IOException
if
m_startNewLine
outputLineSep
if
m_indentAmount
printSpace
depth
m_indentAmount
protected
void
indent
throws
IOException
indent
m_elemContext
m_currentElemDepth
private
void
printSpace
int
n
throws
IOException
final
java
io
Writer
writer
m_writer
for
int
i
i
n
i
writer
write
public
void
attributeDecl
String
eName
String
aName
String
type
String
valueDefault
String
value
throws
SAXException
if
m_inExternalDTD
return
try
final
java
io
Writer
writer
m_writer
if
m_needToOutputDocTypeDecl
outputDocTypeDecl
m_elemContext
m_elementName
m_needToOutputDocTypeDecl
if
m_inDoctype
writer
write
writer
write
m_lineSep
m_lineSepLen
m_inDoctype
writer
write
writer
write
eName
writer
write
writer
write
aName
writer
write
writer
write
type
if
valueDefault
writer
write
writer
write
valueDefault
writer
write
writer
write
m_lineSep
m_lineSepLen
catch
IOException
e
throw
new
SAXException
e
public
Writer
getWriter
return
m_writer
public
void
externalEntityDecl
String
name
String
publicId
String
systemId
throws
SAXException
protected
boolean
escapingNotNeeded
char
ch
if
ch
if
ch
ch
ch
ch
return
else
return
if
m_charToByteConverter
m_triedToGetConverter
m_triedToGetConverter
try
m_charToByteConverter
Encodings
getCharToByteConverter
getEncoding
if
m_charToByteConverter
Class
argsTypes
new
Class
argsTypes
Character
TYPE
Class
convClass
m_charToByteConverter
getClass
m_canConvertMeth
convClass
getMethod
argsTypes
catch
Exception
e
System
err
println
e
getMessage
if
m_charToByteConverter
try
Object
args
new
Object
args
new
Character
ch
Boolean
bool
Boolean
m_canConvertMeth
invoke
m_charToByteConverter
args
return
bool
booleanValue
Character
isISOControl
ch
catch
java
lang
reflect
InvocationTargetException
ite
System
err
println
catch
java
lang
IllegalAccessException
iae
System
err
println
return
ch
m_maxCharacter
protected
void
writeUTF16Surrogate
char
c
char
ch
int
i
int
end
throws
IOException
int
surrogateValue
getURF16SurrogateValue
c
ch
i
end
final
java
io
Writer
writer
m_writer
writer
write
writer
write
writer
write
Integer
toString
surrogateValue
writer
write
int
getURF16SurrogateValue
char
c
char
ch
int
i
int
end
throws
IOException
int
next
if
i
end
throw
new
IOException
XMLMessages
createXMLMessage
XMLErrorResources
ER_INVALID_UTF16_SURROGATE
new
Object
Integer
toHexString
int
c
else
next
ch
i
if
next
next
throw
new
IOException
XMLMessages
createXMLMessage
XMLErrorResources
ER_INVALID_UTF16_SURROGATE
new
Object
Integer
toHexString
int
c
Integer
toHexString
next
next
c
next
return
next
protected
int
accumDefaultEntity
java
io
Writer
writer
char
ch
int
i
char
chars
int
len
boolean
fromTextNode
boolean
escLF
throws
IOException
if
escLF
CharInfo
S_LINEFEED
ch
writer
write
m_lineSep
m_lineSepLen
else
if
fromTextNode
m_charInfo
isSpecialTextChar
ch
fromTextNode
m_charInfo
isSpecialAttrChar
ch
String
entityRef
m_charInfo
getEntityNameForChar
ch
if
entityRef
writer
write
writer
write
entityRef
writer
write
else
return
i
else
return
i
return
i
void
writeNormalizedChars
char
ch
int
start
int
length
boolean
isCData
boolean
useSystemLineSeparator
throws
IOException
org
xml
sax
SAXException
final
java
io
Writer
writer
m_writer
int
end
start
length
for
int
i
start
i
end
i
char
c
ch
i
if
CharInfo
S_LINEFEED
c
useSystemLineSeparator
writer
write
m_lineSep
m_lineSepLen
else
if
isCData
escapingNotNeeded
c
if
m_cdataTagOpen
closeCDATA
if
isUTF16Surrogate
c
writeUTF16Surrogate
c
ch
i
end
i
else
writer
write
String
intStr
Integer
toString
int
c
writer
write
intStr
writer
write
else
if
isCData
i
end
c
ch
i
ch
i
writer
write
CDATA_CONTINUE
i
else
if
escapingNotNeeded
c
if
isCData
m_cdataTagOpen
writer
write
CDATA_DELIMITER_OPEN
m_cdataTagOpen
writer
write
c
else
if
isUTF16Surrogate
c
if
m_cdataTagOpen
closeCDATA
writeUTF16Surrogate
c
ch
i
end
i
else
if
m_cdataTagOpen
closeCDATA
writer
write
String
intStr
Integer
toString
int
c
writer
write
intStr
writer
write
public
void
endNonEscaping
throws
org
xml
sax
SAXException
m_disableOutputEscapingStates
pop
public
void
startNonEscaping
throws
org
xml
sax
SAXException
m_disableOutputEscapingStates
push
protected
void
cdata
char
ch
int
start
final
int
length
throws
org
xml
sax
SAXException
try
final
int
old_start
start
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
m_ispreserve
if
shouldIndent
indent
boolean
writeCDataBrackets
length
escapingNotNeeded
ch
start
if
writeCDataBrackets
m_cdataTagOpen
m_writer
write
CDATA_DELIMITER_OPEN
m_cdataTagOpen
if
isEscapingDisabled
charactersRaw
ch
start
length
else
writeNormalizedChars
ch
start
length
m_lineSepUse
if
writeCDataBrackets
if
ch
start
length
closeCDATA
if
m_tracer
super
fireCDATAEvent
ch
old_start
length
catch
IOException
ioe
throw
new
org
xml
sax
SAXException
XMLMessages
createXMLMessage
XMLErrorResources
ER_OIERROR
ioe
private
boolean
isEscapingDisabled
return
m_disableOutputEscapingStates
peekOrFalse
protected
void
charactersRaw
char
ch
int
start
int
length
throws
org
xml
sax
SAXException
if
m_inEntityRef
return
try
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
m_ispreserve
m_writer
write
ch
start
length
catch
IOException
e
throw
new
SAXException
e
public
void
characters
final
char
chars
final
int
start
final
int
length
throws
org
xml
sax
SAXException
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
else
if
m_needToCallStartDocument
startDocumentInternal
if
m_cdataStartCalled
m_elemContext
m_isCdataSection
cdata
chars
start
length
return
if
m_cdataTagOpen
closeCDATA
if
m_disableOutputEscapingStates
peekOrFalse
m_escaping
charactersRaw
chars
start
length
if
m_tracer
super
fireCharEvent
chars
start
length
return
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
try
int
i
char
ch1
int
startClean
final
int
end
start
length
int
lastDirty
start
for
i
start
i
end
ch1
chars
i
ch1
m_lineSepUse
ch1
ch1
i
if
m_charInfo
isTextASCIIClean
ch1
lastDirty
processDirty
chars
end
i
ch1
lastDirty
i
lastDirty
if
i
end
m_ispreserve
for
i
end
i
char
ch2
while
i
end
ch2
chars
i
m_charInfo
isTextASCIIClean
ch2
i
if
i
end
break
final
char
ch
chars
i
if
escapingNotNeeded
ch
m_charInfo
isSpecialTextChar
ch
ch
else
lastDirty
processDirty
chars
end
i
ch
lastDirty
i
lastDirty
startClean
lastDirty
if
i
startClean
int
lengthClean
i
startClean
m_writer
write
chars
startClean
lengthClean
m_isprevtext
catch
IOException
e
throw
new
SAXException
e
if
m_tracer
super
fireCharEvent
chars
start
length
private
int
processDirty
char
chars
int
end
int
i
char
ch
int
lastDirty
boolean
fromTextNode
throws
IOException
int
startClean
lastDirty
if
i
startClean
int
lengthClean
i
startClean
m_writer
write
chars
startClean
lengthClean
if
CharInfo
S_LINEFEED
ch
fromTextNode
m_writer
write
m_lineSep
m_lineSepLen
else
startClean
accumDefaultEscape
m_writer
char
ch
i
chars
end
fromTextNode
i
startClean
return
i
public
void
characters
String
s
throws
org
xml
sax
SAXException
final
int
length
s
length
if
length
m_charsBuff
length
m_charsBuff
new
char
length
s
getChars
length
m_charsBuff
characters
m_charsBuff
length
protected
int
accumDefaultEscape
Writer
writer
char
ch
int
i
char
chars
int
len
boolean
fromTextNode
boolean
escLF
throws
IOException
int
pos
accumDefaultEntity
writer
ch
i
chars
len
fromTextNode
escLF
if
i
pos
if
ch
ch
int
next
if
i
len
throw
new
IOException
XMLMessages
createXMLMessage
XMLErrorResources
ER_INVALID_UTF16_SURROGATE
new
Object
Integer
toHexString
ch
else
next
chars
i
if
next
next
throw
new
IOException
XMLMessages
createXMLMessage
XMLErrorResources
ER_INVALID_UTF16_SURROGATE
new
Object
Integer
toHexString
ch
Integer
toHexString
next
next
ch
next
writer
write
writer
write
Integer
toString
next
writer
write
pos
else
if
escapingNotNeeded
ch
fromTextNode
m_charInfo
isSpecialTextChar
ch
fromTextNode
m_charInfo
isSpecialAttrChar
ch
writer
write
writer
write
Integer
toString
ch
writer
write
else
writer
write
ch
pos
return
pos
public
void
startElement
String
namespaceURI
String
localName
String
name
Attributes
atts
throws
org
xml
sax
SAXException
if
m_inEntityRef
return
if
m_needToCallStartDocument
startDocumentInternal
m_needToCallStartDocument
else
if
m_cdataTagOpen
closeCDATA
try
if
m_needToOutputDocTypeDecl
getDoctypeSystem
outputDocTypeDecl
name
m_needToOutputDocTypeDecl
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
if
namespaceURI
ensurePrefixIsDeclared
namespaceURI
name
m_ispreserve
if
shouldIndent
m_startNewLine
indent
m_startNewLine
final
java
io
Writer
writer
m_writer
writer
write
writer
write
name
catch
IOException
e
throw
new
SAXException
e
if
atts
addAttributes
atts
m_elemContext
m_elemContext
push
namespaceURI
localName
name
m_isprevtext
if
m_tracer
firePseudoAttributes
public
void
startElement
String
elementNamespaceURI
String
elementLocalName
String
elementName
throws
SAXException
startElement
elementNamespaceURI
elementLocalName
elementName
public
void
startElement
String
elementName
throws
SAXException
startElement
elementName
void
outputDocTypeDecl
String
name
boolean
closeDecl
throws
SAXException
if
m_cdataTagOpen
closeCDATA
try
final
java
io
Writer
writer
m_writer
writer
write
writer
write
name
String
doctypePublic
getDoctypePublic
if
doctypePublic
writer
write
writer
write
doctypePublic
writer
write
String
doctypeSystem
getDoctypeSystem
if
doctypeSystem
if
doctypePublic
writer
write
else
writer
write
writer
write
doctypeSystem
if
closeDecl
writer
write
writer
write
m_lineSep
m_lineSepLen
closeDecl
else
writer
write
boolean
dothis
if
dothis
if
closeDecl
writer
write
writer
write
m_lineSep
m_lineSepLen
catch
IOException
e
throw
new
SAXException
e
public
void
processAttributes
java
io
Writer
writer
int
nAttrs
throws
IOException
SAXException
String
encoding
getEncoding
for
int
i
i
nAttrs
i
final
String
name
m_attributes
getQName
i
final
String
value
m_attributes
getValue
i
writer
write
writer
write
name
writer
write
writeAttrString
writer
value
encoding
writer
write
public
void
writeAttrString
Writer
writer
String
string
String
encoding
throws
IOException
final
int
len
string
length
if
len
m_attrBuff
length
m_attrBuff
new
char
len
string
getChars
len
m_attrBuff
final
char
stringChars
m_attrBuff
for
int
i
i
len
i
char
ch
stringChars
i
if
escapingNotNeeded
ch
m_charInfo
isSpecialAttrChar
ch
writer
write
ch
else
accumDefaultEscape
writer
ch
i
stringChars
len
public
void
endElement
String
namespaceURI
String
localName
String
name
throws
org
xml
sax
SAXException
if
m_inEntityRef
return
m_prefixMap
popNamespaces
m_elemContext
m_currentElemDepth
try
final
java
io
Writer
writer
m_writer
if
m_elemContext
m_startTagOpen
if
m_tracer
super
fireStartElem
m_elemContext
m_elementName
int
nAttrs
m_attributes
getLength
if
nAttrs
processAttributes
m_writer
nAttrs
m_attributes
clear
if
m_spaceBeforeClose
writer
write
else
writer
write
else
if
m_cdataTagOpen
closeCDATA
if
shouldIndent
indent
m_elemContext
m_currentElemDepth
writer
write
writer
write
writer
write
name
writer
write
catch
IOException
e
throw
new
SAXException
e
if
m_elemContext
m_startTagOpen
m_doIndent
m_ispreserve
m_preserves
isEmpty
m_preserves
pop
m_isprevtext
if
m_tracer
super
fireEndElem
name
m_elemContext
m_elemContext
m_prev
public
void
endElement
String
name
throws
org
xml
sax
SAXException
endElement
name
public
void
startPrefixMapping
String
prefix
String
uri
throws
org
xml
sax
SAXException
startPrefixMapping
prefix
uri
public
boolean
startPrefixMapping
String
prefix
String
uri
boolean
shouldFlush
throws
org
xml
sax
SAXException
boolean
pushed
int
pushDepth
if
shouldFlush
flushPending
pushDepth
m_elemContext
m_currentElemDepth
else
pushDepth
m_elemContext
m_currentElemDepth
pushed
m_prefixMap
pushNamespace
prefix
uri
pushDepth
if
pushed
String
name
if
EMPTYSTRING
equals
prefix
name
addAttributeAlways
XMLNS_URI
prefix
name
uri
else
if
EMPTYSTRING
equals
uri
name
prefix
addAttributeAlways
XMLNS_URI
prefix
name
uri
return
pushed
public
void
comment
char
ch
int
start
int
length
throws
org
xml
sax
SAXException
int
start_old
start
if
m_inEntityRef
return
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
else
if
m_needToCallStartDocument
startDocumentInternal
m_needToCallStartDocument
try
if
shouldIndent
indent
final
int
limit
start
length
boolean
wasDash
if
m_cdataTagOpen
closeCDATA
final
java
io
Writer
writer
m_writer
writer
write
COMMENT_BEGIN
for
int
i
start
i
limit
i
if
wasDash
ch
i
writer
write
ch
start
i
start
writer
write
start
i
wasDash
ch
i
if
length
final
int
remainingChars
limit
start
if
remainingChars
writer
write
ch
start
remainingChars
if
ch
limit
writer
write
writer
write
COMMENT_END
catch
IOException
e
throw
new
SAXException
e
m_startNewLine
if
m_tracer
super
fireCommentEvent
ch
start_old
length
public
void
endCDATA
throws
org
xml
sax
SAXException
if
m_cdataTagOpen
closeCDATA
m_cdataStartCalled
public
void
endDTD
throws
org
xml
sax
SAXException
try
if
m_needToOutputDocTypeDecl
outputDocTypeDecl
m_elemContext
m_elementName
m_needToOutputDocTypeDecl
final
java
io
Writer
writer
m_writer
if
m_inDoctype
writer
write
else
writer
write
writer
write
m_lineSep
m_lineSepLen
catch
IOException
e
throw
new
SAXException
e
public
void
endPrefixMapping
String
prefix
throws
org
xml
sax
SAXException
public
void
ignorableWhitespace
char
ch
int
start
int
length
throws
org
xml
sax
SAXException
if
length
return
characters
ch
start
length
public
void
skippedEntity
String
name
throws
org
xml
sax
SAXException
public
void
startCDATA
throws
org
xml
sax
SAXException
m_cdataStartCalled
public
void
startEntity
String
name
throws
org
xml
sax
SAXException
if
name
equals
m_inExternalDTD
m_inEntityRef
protected
void
closeStartTag
throws
SAXException
if
m_elemContext
m_startTagOpen
try
if
m_tracer
super
fireStartElem
m_elemContext
m_elementName
int
nAttrs
m_attributes
getLength
if
nAttrs
processAttributes
m_writer
nAttrs
m_attributes
clear
m_writer
write
catch
IOException
e
throw
new
SAXException
e
if
m_cdataSectionElements
m_elemContext
m_isCdataSection
isCdataSection
if
m_doIndent
m_isprevtext
m_preserves
push
m_ispreserve
public
void
startDTD
String
name
String
publicId
String
systemId
throws
org
xml
sax
SAXException
setDoctypeSystem
systemId
setDoctypePublic
publicId
m_elemContext
m_elementName
name
m_inDoctype
public
int
getIndentAmount
return
m_indentAmount
public
void
setIndentAmount
int
m_indentAmount
this
m_indentAmount
m_indentAmount
protected
boolean
shouldIndent
return
m_doIndent
m_ispreserve
m_isprevtext
private
void
setCdataSectionElements
String
key
Properties
props
String
s
props
getProperty
key
if
s
Vector
v
new
Vector
int
l
s
length
boolean
inCurly
FastStringBuffer
buf
new
FastStringBuffer
for
int
i
i
l
i
char
c
s
charAt
i
if
Character
isWhitespace
c
if
inCurly
if
buf
length
addCdataSectionElement
buf
toString
v
buf
reset
continue
else
if
c
inCurly
else
if
c
inCurly
buf
append
c
if
buf
length
addCdataSectionElement
buf
toString
v
buf
reset
setCdataSectionElements
v
private
void
addCdataSectionElement
String
URI_and_localName
Vector
v
StringTokenizer
tokenizer
new
StringTokenizer
URI_and_localName
QName
qname
String
s1
tokenizer
nextToken
String
s2
tokenizer
hasMoreTokens
tokenizer
nextToken
if
s2
v
addElement
v
addElement
s1
else
v
addElement
s1
v
addElement
s2
public
void
setCdataSectionElements
Vector
URI_and_localNames
m_cdataSectionElements
URI_and_localNames
protected
String
ensureAttributesNamespaceIsDeclared
String
ns
String
localName
String
rawName
throws
org
xml
sax
SAXException
if
ns
ns
length
int
index
String
prefixFromRawName
index
rawName
indexOf
rawName
substring
index
if
index
String
uri
m_prefixMap
lookupNamespace
prefixFromRawName
if
uri
uri
equals
ns
return
else
this
startPrefixMapping
prefixFromRawName
ns
this
addAttribute
prefixFromRawName
prefixFromRawName
ns
return
prefixFromRawName
else
String
prefix
m_prefixMap
lookupPrefix
ns
if
prefix
prefix
m_prefixMap
generateNextPrefix
this
startPrefixMapping
prefix
ns
this
addAttribute
prefix
prefix
ns
return
prefix
return
void
ensurePrefixIsDeclared
String
ns
String
rawName
throws
org
xml
sax
SAXException
if
ns
ns
length
int
index
String
prefix
index
rawName
indexOf
rawName
substring
index
if
prefix
String
foundURI
m_prefixMap
lookupNamespace
prefix
if
foundURI
foundURI
equals
ns
this
startPrefixMapping
prefix
ns
this
addAttributeAlways
prefix
prefix
length
prefix
ns
public
void
flushPending
throws
SAXException
if
m_needToCallStartDocument
startDocumentInternal
m_needToCallStartDocument
if
m_elemContext
m_startTagOpen
closeStartTag
m_elemContext
m_startTagOpen
if
m_cdataTagOpen
closeCDATA
m_cdataTagOpen
public
void
setContentHandler
ContentHandler
ch
public
void
addAttributeAlways
String
uri
String
localName
String
rawName
String
type
String
value
int
index
index
m_attributes
getIndex
rawName
if
index
String
old_value
if
m_tracer
old_value
m_attributes
getValue
index
if
value
equals
old_value
old_value
m_attributes
setValue
index
value
if
old_value
firePseudoAttributes
else
m_attributes
addAttribute
uri
localName
rawName
type
value
if
m_tracer
firePseudoAttributes
protected
void
firePseudoAttributes
if
m_tracer
try
m_writer
flush
StringBuffer
sb
new
StringBuffer
int
nAttrs
m_attributes
getLength
if
nAttrs
java
io
Writer
writer
new
ToStream
WritertoStringBuffer
sb
processAttributes
writer
nAttrs
sb
append
char
ch
sb
toString
toCharArray
m_tracer
fireGenerateEvent
SerializerTrace
EVENTTYPE_OUTPUT_PSEUDO_CHARACTERS
ch
ch
length
catch
IOException
ioe
catch
SAXException
se
private
class
WritertoStringBuffer
extends
java
io
Writer
final
private
StringBuffer
m_stringbuf
WritertoStringBuffer
StringBuffer
sb
m_stringbuf
sb
public
void
write
char
arg0
int
arg1
int
arg2
throws
IOException
m_stringbuf
append
arg0
arg1
arg2
public
void
flush
throws
IOException
public
void
close
throws
IOException
public
void
write
int
i
m_stringbuf
append
char
i
public
void
write
String
s
m_stringbuf
append
s
public
void
setTransformer
Transformer
transformer
super
setTransformer
transformer
if
m_tracer
m_writer
instanceof
SerializerTraceWriter
m_writer
new
SerializerTraceWriter
m_writer
m_tracer
public
boolean
reset
boolean
wasReset
if
super
reset
resetToStream
wasReset
return
wasReset
private
void
resetToStream
this
m_canConvertMeth
this
m_cdataStartCalled
this
m_charToByteConverter
this
m_disableOutputEscapingStates
clear
this
m_escaping
this
m_inDoctype
this
m_ispreserve
this
m_ispreserve
this
m_isprevtext
this
m_isUTF8
this
m_maxCharacter
Encodings
getLastPrintable
this
m_preserves
clear
this
m_shouldFlush
this
m_spaceBeforeClose
this
m_startNewLine
this
m_triedToGetConverter
this
m_lineSepUse
