package
org
apache
xpath
functions
import
java
util
StringTokenizer
import
org
apache
xml
dtm
DTM
import
org
apache
xml
dtm
DTMIterator
import
org
apache
xml
utils
StringVector
import
org
apache
xpath
NodeSetDTM
import
org
apache
xpath
XPathContext
import
org
apache
xpath
objects
XNodeSet
import
org
apache
xpath
objects
XObject
import
org
apache
xpath
res
XPATHErrorResources
public
class
FuncId
extends
FunctionOneArg
private
StringVector
getNodesByID
XPathContext
xctxt
int
docContext
String
refval
StringVector
usedrefs
NodeSetDTM
nodeSet
boolean
mayBeMore
if
refval
String
ref
StringTokenizer
tokenizer
new
StringTokenizer
refval
boolean
hasMore
tokenizer
hasMoreTokens
DTM
dtm
xctxt
getDTM
docContext
while
hasMore
ref
tokenizer
nextToken
hasMore
tokenizer
hasMoreTokens
if
usedrefs
usedrefs
contains
ref
ref
continue
int
node
dtm
getElementById
ref
if
DTM
NULL
node
nodeSet
addNodeInDocOrder
node
xctxt
if
ref
hasMore
mayBeMore
if
usedrefs
usedrefs
new
StringVector
usedrefs
addElement
ref
return
usedrefs
public
XObject
execute
XPathContext
xctxt
throws
javax
xml
transform
TransformerException
int
context
xctxt
getCurrentNode
DTM
dtm
xctxt
getDTM
context
int
docContext
dtm
getDocument
if
DTM
NULL
docContext
error
xctxt
XPATHErrorResources
ER_CONTEXT_HAS_NO_OWNERDOC
XObject
arg
m_arg0
execute
xctxt
int
argType
arg
getType
XNodeSet
nodes
new
XNodeSet
xctxt
getDTMManager
NodeSetDTM
nodeSet
nodes
mutableNodeset
if
XObject
CLASS_NODESET
argType
DTMIterator
ni
arg
iter
StringVector
usedrefs
int
pos
ni
nextNode
while
DTM
NULL
pos
DTM
ndtm
ni
getDTM
pos
String
refval
ndtm
getStringValue
pos
toString
pos
ni
nextNode
usedrefs
getNodesByID
xctxt
docContext
refval
usedrefs
nodeSet
DTM
NULL
pos
else
if
XObject
CLASS_NULL
argType
return
nodes
else
String
refval
arg
str
getNodesByID
xctxt
docContext
refval
nodeSet
return
nodes
