package
org
apache
xalan
xsltc
compiler
import
java
util
Enumeration
import
java
util
Vector
import
org
apache
bcel
generic
ConstantPoolGen
import
org
apache
bcel
generic
INVOKESPECIAL
import
org
apache
bcel
generic
INVOKEVIRTUAL
import
org
apache
bcel
generic
Instruction
import
org
apache
bcel
generic
InstructionList
import
org
apache
bcel
generic
NEW
import
org
apache
xalan
xsltc
compiler
util
ClassGenerator
import
org
apache
xalan
xsltc
compiler
util
ErrorMsg
import
org
apache
xalan
xsltc
compiler
util
MethodGenerator
import
org
apache
xalan
xsltc
compiler
util
Type
import
org
apache
xalan
xsltc
compiler
util
TypeCheckError
final
class
AttributeValueTemplate
extends
AttributeValue
public
AttributeValueTemplate
String
value
Parser
parser
SyntaxTreeNode
parent
setParent
parent
setParser
parser
if
check
value
parser
parseAVTemplate
value
parser
private
void
parseAVTemplate
final
int
start
String
text
Parser
parser
String
str
if
text
return
int
open
start
do
open
text
indexOf
open
while
open
open
text
length
text
charAt
open
if
open
int
close
open
do
close
text
indexOf
close
while
close
close
text
length
text
charAt
close
if
open
start
str
removeDuplicateBraces
text
substring
start
open
addElement
new
LiteralExpr
str
if
close
open
str
text
substring
open
close
str
removeDuplicateBraces
text
substring
open
close
addElement
parser
parseExpression
this
str
parseAVTemplate
close
text
parser
else
if
start
text
length
str
removeDuplicateBraces
text
substring
start
addElement
new
LiteralExpr
str
public
String
removeDuplicateBraces
String
orig
String
result
orig
int
index
while
index
result
indexOf
result
result
substring
index
result
substring
index
result
length
while
index
result
indexOf
result
result
substring
index
result
substring
index
result
length
return
result
public
Type
typeCheck
SymbolTable
stable
throws
TypeCheckError
final
Vector
contents
getContents
final
int
n
contents
size
for
int
i
i
n
i
final
Expression
exp
Expression
contents
elementAt
i
if
exp
typeCheck
stable
identicalTo
Type
String
contents
setElementAt
new
CastExpr
exp
Type
String
i
return
_type
Type
String
public
String
toString
final
StringBuffer
buffer
new
StringBuffer
final
int
count
elementCount
for
int
i
i
count
i
buffer
append
elementAt
i
toString
if
i
count
buffer
append
return
buffer
append
toString
public
void
translate
ClassGenerator
classGen
MethodGenerator
methodGen
if
elementCount
final
Expression
exp
Expression
elementAt
exp
translate
classGen
methodGen
else
final
ConstantPoolGen
cpg
classGen
getConstantPool
final
InstructionList
il
methodGen
getInstructionList
final
int
initBuffer
cpg
addMethodref
STRING_BUFFER_CLASS
final
Instruction
append
new
INVOKEVIRTUAL
cpg
addMethodref
STRING_BUFFER_CLASS
STRING_SIG
STRING_BUFFER_SIG
final
int
toString
cpg
addMethodref
STRING_BUFFER_CLASS
STRING_SIG
il
append
new
NEW
cpg
addClass
STRING_BUFFER_CLASS
il
append
DUP
il
append
new
INVOKESPECIAL
initBuffer
final
Enumeration
elements
elements
while
elements
hasMoreElements
final
Expression
exp
Expression
elements
nextElement
exp
translate
classGen
methodGen
il
append
append
il
append
new
INVOKEVIRTUAL
toString
private
boolean
check
String
value
Parser
parser
if
value
return
final
char
chars
value
toCharArray
int
level
for
int
i
i
chars
length
i
switch
chars
i
case
if
i
chars
length
chars
i
level
else
i
break
case
if
i
chars
length
chars
i
level
else
i
break
default
continue
switch
level
case
case
continue
default
reportError
getParent
parser
ErrorMsg
ATTR_VAL_TEMPLATE_ERR
value
return
if
level
reportError
getParent
parser
ErrorMsg
ATTR_VAL_TEMPLATE_ERR
value
return
return
