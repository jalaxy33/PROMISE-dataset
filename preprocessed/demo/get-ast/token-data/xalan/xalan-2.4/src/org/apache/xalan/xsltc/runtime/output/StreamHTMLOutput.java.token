package
org
apache
xalan
xsltc
runtime
output
import
java
util
Vector
import
java
io
Writer
import
java
io
IOException
import
java
io
OutputStream
import
java
io
OutputStreamWriter
import
java
io
UnsupportedEncodingException
import
org
apache
xalan
xsltc
import
org
apache
xalan
xsltc
runtime
import
org
apache
xalan
xsltc
runtime
Hashtable
public
class
StreamHTMLOutput
extends
StreamOutput
private
static
final
String
HREF_STR
private
static
final
String
CITE_STR
private
static
final
String
SRC_STR
private
static
final
Hashtable
_emptyElements
new
Hashtable
private
static
final
String
tags
static
for
int
i
i
tags
length
i
_emptyElements
put
tags
i
private
boolean
_headTagOpen
private
boolean
_inStyleScript
private
String
_mediaType
public
StreamHTMLOutput
StreamOutput
output
super
output
setIndent
public
StreamHTMLOutput
Writer
writer
String
encoding
super
writer
encoding
setIndent
public
StreamHTMLOutput
OutputStream
out
String
encoding
throws
IOException
super
out
encoding
setIndent
public
void
startDocument
throws
TransletException
public
void
endDocument
throws
TransletException
outputBuffer
public
void
startElement
String
elementName
throws
TransletException
if
_startTagOpen
closeStartTag
if
_firstElement
if
_doctypeSystem
_doctypePublic
appendDTD
elementName
_firstElement
if
_indent
if
_emptyElements
containsKey
elementName
toLowerCase
indent
_lineFeedNextStartTag
_lineFeedNextStartTag
_indentNextEndTag
_indentLevel
_buffer
append
append
elementName
_startTagOpen
_indentNextEndTag
if
elementName
equalsIgnoreCase
_headTagOpen
else
if
elementName
equalsIgnoreCase
elementName
equalsIgnoreCase
_inStyleScript
public
void
endElement
String
elementName
throws
TransletException
if
_inStyleScript
elementName
equalsIgnoreCase
elementName
equalsIgnoreCase
_inStyleScript
if
_startTagOpen
appendAttributes
if
_emptyElements
containsKey
elementName
toLowerCase
_buffer
append
else
closeStartTag
_buffer
append
append
elementName
append
_startTagOpen
if
_indent
_indentLevel
_indentNextEndTag
else
if
_indent
_indentLevel
if
_indentNextEndTag
indent
_indentNextEndTag
_indentNextEndTag
_lineFeedNextStartTag
_buffer
append
append
elementName
append
_indentNextEndTag
public
void
characters
String
characters
throws
TransletException
if
_startTagOpen
closeStartTag
if
_escaping
_inStyleScript
escapeCharacters
characters
toCharArray
characters
length
else
_buffer
append
characters
public
void
characters
char
characters
int
offset
int
length
throws
TransletException
if
_startTagOpen
closeStartTag
if
_escaping
_inStyleScript
escapeCharacters
characters
offset
length
else
_buffer
append
characters
offset
length
public
void
attribute
String
name
String
value
throws
TransletException
if
_startTagOpen
int
k
Attribute
attr
if
name
equalsIgnoreCase
HREF_STR
name
equalsIgnoreCase
SRC_STR
name
equals
CITE_STR
attr
new
Attribute
name
escapeURL
value
else
attr
new
Attribute
name
escapeNonURL
value
if
k
_attributes
indexOf
attr
_attributes
setElementAt
attr
k
else
_attributes
add
attr
public
void
comment
String
comment
throws
TransletException
if
_startTagOpen
closeStartTag
appendComment
comment
public
void
processingInstruction
String
target
String
data
throws
TransletException
if
_startTagOpen
closeStartTag
if
_firstElement
if
_doctypeSystem
_doctypePublic
appendDTD
_firstElement
_buffer
append
append
target
append
append
data
append
public
boolean
setEscaping
boolean
escape
throws
TransletException
final
boolean
temp
_escaping
_escaping
escape
return
temp
public
void
close
try
_writer
close
catch
Exception
e
public
void
namespace
String
prefix
String
uri
throws
TransletException
public
void
setCdataElements
Hashtable
elements
public
void
setType
int
type
public
void
setMediaType
String
mediaType
_mediaType
mediaType
private
String
escapeNonURL
String
base
final
int
length
base
length
final
StringBuffer
result
new
StringBuffer
for
int
i
i
length
i
final
char
ch
base
charAt
i
if
ch
ch
_is8859Encoded
ch
result
append
CHAR_ESC_START
append
Integer
toString
int
ch
append
else
result
append
ch
return
result
toString
private
String
escapeURL
String
base
final
char
chs
base
toCharArray
final
StringBuffer
result
new
StringBuffer
final
int
length
chs
length
for
int
i
i
length
i
final
char
ch
chs
i
if
ch
result
append
append
makeHHString
ch
else
if
ch
result
append
append
makeHHString
ch
append
append
makeHHString
ch
else
switch
ch
case
case
case
case
case
case
case
case
case
case
case
case
result
append
append
Integer
toHexString
int
ch
break
case
result
append
break
default
result
append
ch
break
return
result
toString
private
String
makeHHString
int
i
final
String
s
Integer
toHexString
i
toUpperCase
return
s
length
s
s
private
void
appendHeader
_buffer
append
append
_mediaType
append
append
_encoding
append
protected
void
closeStartTag
throws
TransletException
super
closeStartTag
if
_headTagOpen
appendHeader
_headTagOpen
protected
void
escapeCharacters
char
ch
int
off
int
len
int
limit
off
len
int
offset
off
if
limit
ch
length
limit
ch
length
for
int
i
off
i
limit
i
final
char
current
ch
i
switch
current
case
_buffer
append
ch
offset
i
offset
append
AMP
offset
i
break
case
_buffer
append
ch
offset
i
offset
append
LT
offset
i
break
case
_buffer
append
ch
offset
i
offset
append
GT
offset
i
break
case
_buffer
append
ch
offset
i
offset
append
NBSP
offset
i
break
default
if
current
current
_is8859Encoded
current
_buffer
append
ch
offset
i
offset
append
CHAR_ESC_START
append
Integer
toString
int
ch
i
append
offset
i
if
offset
limit
_buffer
append
ch
offset
limit
offset
