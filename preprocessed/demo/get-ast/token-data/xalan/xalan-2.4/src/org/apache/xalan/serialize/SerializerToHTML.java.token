package
org
apache
xalan
serialize
import
java
util
Stack
import
java
io
Writer
import
java
io
IOException
import
java
util
Hashtable
import
java
util
Vector
import
java
util
Properties
import
java
util
BitSet
import
org
xml
sax
import
org
apache
xml
utils
BoolStack
import
org
apache
xml
utils
Trie
import
org
apache
xml
utils
FastStringBuffer
import
org
apache
xalan
res
XSLMessages
import
org
apache
xpath
res
XPATHErrorResources
import
org
apache
xml
utils
StringToIntTable
import
org
apache
xalan
templates
OutputProperties
import
javax
xml
transform
OutputKeys
import
javax
xml
transform
Result
public
class
SerializerToHTML
extends
SerializerToXML
protected
BoolStack
m_isRawStack
new
BoolStack
private
boolean
m_inBlockElem
protected
static
CharInfo
m_htmlcharInfo
new
CharInfo
CharInfo
HTML_ENTITIES_RESOURCE
static
Trie
m_elementFlags
new
Trie
static
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
WHITESPACESENSITIVE
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
PHRASE
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEADMISC
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
ElemDesc
EMPTY
ElemDesc
WHITESPACESENSITIVE
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
ElemDesc
HEADMISC
ElemDesc
WHITESPACESENSITIVE
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
ElemDesc
EMPTY
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
HEAD
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEAD
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEAD
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEAD
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEAD
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEAD
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
PREFORMATTED
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
LIST
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
LIST
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
FORMCTRL
m_elementFlags
put
new
ElemDesc
ElemDesc
FORMCTRL
ElemDesc
INLINELABEL
ElemDesc
EMPTY
m_elementFlags
put
new
ElemDesc
ElemDesc
FORMCTRL
ElemDesc
INLINELABEL
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
ElemDesc
FORMCTRL
ElemDesc
INLINELABEL
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
ElemDesc
FORMCTRL
ElemDesc
INLINELABEL
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
HEADELEM
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEADMISC
ElemDesc
EMPTY
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
HEADMISC
ElemDesc
RAW
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
SPECIAL
ElemDesc
ASPECIAL
ElemDesc
HEADMISC
ElemDesc
RAW
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
FONTSTYLE
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
m_elementFlags
put
new
ElemDesc
ElemDesc
BLOCK
ElemDesc
BLOCKFORM
ElemDesc
BLOCKFORMFIELDSET
ElemDesc
elemDesc
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTREMPTY
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
elemDesc
ElemDesc
m_elementFlags
get
elemDesc
setAttr
ElemDesc
ATTRURL
static
private
ElemDesc
m_dummy
new
ElemDesc
ElemDesc
BLOCK
private
boolean
m_specialEscapeURLs
private
boolean
m_omitMetaTag
public
void
setSpecialEscapeURLs
boolean
bool
m_specialEscapeURLs
bool
public
void
setOmitMetaTag
boolean
bool
m_omitMetaTag
bool
public
void
setOutputFormat
Properties
format
m_specialEscapeURLs
OutputProperties
getBooleanProperty
OutputProperties
S_USE_URL_ESCAPING
format
m_omitMetaTag
OutputProperties
getBooleanProperty
OutputProperties
S_OMIT_META_TAG
format
super
setOutputFormat
format
public
boolean
getSpecialEscapeURLs
return
m_specialEscapeURLs
public
boolean
getOmitMetaTag
return
m_omitMetaTag
ElemDesc
getElemDesc
String
name
if
name
Object
obj
m_elementFlags
get
name
if
obj
return
ElemDesc
obj
return
m_dummy
public
SerializerToHTML
super
m_charInfo
m_htmlcharInfo
private
String
m_currentElementName
public
void
startDocument
throws
org
xml
sax
SAXException
m_needToOutputDocTypeDecl
m_startNewLine
m_shouldNotWriteXMLHeader
if
m_needToOutputDocTypeDecl
if
m_doctypeSystem
m_doctypePublic
accum
if
m_doctypePublic
accum
accum
m_doctypePublic
accum
if
m_doctypeSystem
if
m_doctypePublic
accum
else
accum
accum
m_doctypeSystem
accum
accum
outputLineSep
m_needToOutputDocTypeDecl
public
void
startElement
String
namespaceURI
String
localName
String
name
Attributes
atts
throws
org
xml
sax
SAXException
if
namespaceURI
namespaceURI
length
super
startElement
namespaceURI
localName
name
atts
return
boolean
savedDoIndent
m_doIndent
boolean
noLineBreak
writeParentTagEnd
pushState
namespaceURI
localName
m_cdataSectionNames
m_cdataSectionStates
ElemDesc
elemDesc
getElemDesc
name
boolean
isBlockElement
elemDesc
is
ElemDesc
BLOCK
boolean
isHeadElement
elemDesc
is
ElemDesc
HEADELEM
if
m_ispreserve
m_ispreserve
else
if
m_doIndent
m_currentElementName
m_inBlockElem
isBlockElement
m_startNewLine
indent
m_currentIndent
m_inBlockElem
isBlockElement
m_isRawStack
push
elemDesc
is
ElemDesc
RAW
m_currentElementName
name
this
accum
this
accum
name
int
nAttrs
atts
getLength
for
int
i
i
nAttrs
i
processAttribute
atts
getQName
i
elemDesc
atts
getValue
i
openElementForChildren
m_currentIndent
this
m_indentAmount
m_isprevtext
m_doIndent
savedDoIndent
if
isHeadElement
writeParentTagEnd
if
m_omitMetaTag
if
m_doIndent
indent
m_currentIndent
accum
String
encoding
Encodings
getMimeEncoding
m_encoding
accum
encoding
accum
accum
public
void
endElement
String
namespaceURI
String
localName
String
name
throws
org
xml
sax
SAXException
if
namespaceURI
namespaceURI
length
super
endElement
namespaceURI
localName
name
return
m_currentIndent
this
m_indentAmount
boolean
hasChildNodes
childNodesWereAdded
m_isRawStack
pop
ElemDesc
elemDesc
getElemDesc
name
boolean
isBlockElement
elemDesc
is
ElemDesc
BLOCK
boolean
shouldIndent
if
m_ispreserve
m_ispreserve
else
if
m_doIndent
m_inBlockElem
isBlockElement
m_startNewLine
shouldIndent
m_inBlockElem
isBlockElement
if
hasChildNodes
if
shouldIndent
indent
m_currentIndent
this
accum
this
accum
name
this
accum
m_currentElementName
name
else
if
elemDesc
is
ElemDesc
EMPTY
this
accum
this
accum
this
accum
this
accum
name
this
accum
else
this
accum
if
elemDesc
is
ElemDesc
WHITESPACESENSITIVE
m_ispreserve
if
hasChildNodes
if
m_preserves
isEmpty
m_preserves
pop
m_isprevtext
m_cdataSectionStates
pop
protected
void
processAttribute
String
name
ElemDesc
elemDesc
String
value
throws
org
xml
sax
SAXException
this
accum
if
value
length
value
equalsIgnoreCase
name
elemDesc
isAttrFlagSet
name
ElemDesc
ATTREMPTY
this
accum
name
else
this
accum
name
this
accum
this
accum
if
elemDesc
isAttrFlagSet
name
ElemDesc
ATTRURL
writeAttrURI
value
m_specialEscapeURLs
else
writeAttrString
value
this
m_encoding
this
accum
private
boolean
isASCIIDigit
char
c
return
c
c
private
String
makeHHString
int
i
String
s
Integer
toHexString
i
toUpperCase
if
s
length
s
s
return
s
private
boolean
isHHSign
String
str
boolean
sign
try
char
r
char
Integer
parseInt
str
catch
NumberFormatException
e
sign
return
sign
public
void
writeAttrURI
String
string
boolean
doURLEscaping
throws
org
xml
sax
SAXException
char
stringArray
string
toCharArray
int
len
stringArray
length
for
int
i
i
len
i
char
ch
stringArray
i
if
ch
ch
if
doURLEscaping
if
ch
accum
accum
makeHHString
ch
else
if
ch
int
high
ch
int
low
ch
accum
accum
makeHHString
high
accum
accum
makeHHString
low
else
if
isUTF16Surrogate
ch
int
highSurrogate
int
ch
int
wwww
highSurrogate
int
uuuuu
wwww
int
zzzz
highSurrogate
int
yyyyyy
highSurrogate
ch
stringArray
i
int
lowSurrogate
int
ch
yyyyyy
yyyyyy
lowSurrogate
int
xxxxxx
lowSurrogate
int
byte1
uuuuu
int
byte2
uuuuu
zzzz
int
byte3
yyyyyy
int
byte4
xxxxxx
accum
accum
makeHHString
byte1
accum
accum
makeHHString
byte2
accum
accum
makeHHString
byte3
accum
accum
makeHHString
byte4
else
int
high
ch
int
middle
ch
int
low
ch
accum
accum
makeHHString
high
accum
accum
makeHHString
middle
accum
accum
makeHHString
low
else
if
canConvert
ch
accum
ch
else
accum
accum
Integer
toString
ch
accum
else
if
ch
accum
ch
else
if
ch
if
doURLEscaping
accum
else
accum
else
accum
ch
public
void
writeAttrString
String
string
String
encoding
throws
org
xml
sax
SAXException
final
char
chars
string
toCharArray
final
int
strLen
chars
length
for
int
i
i
strLen
i
char
ch
chars
i
if
canConvert
ch
m_charInfo
isSpecial
ch
accum
ch
else
if
ch
ch
accum
ch
else
if
ch
i
strLen
chars
i
accum
ch
else
int
pos
accumDefaultEntity
ch
i
chars
strLen
if
i
pos
i
pos
else
if
isUTF16Surrogate
ch
try
i
writeUTF16Surrogate
ch
chars
i
strLen
catch
IOException
ioe
throw
new
SAXException
ioe
String
entityName
m_charInfo
getEntityNameForChar
ch
if
entityName
accum
accum
entityName
accum
else
if
canConvert
ch
accum
ch
else
accum
accum
Integer
toString
ch
accum
private
int
copyEntityIntoBuf
String
s
int
pos
throws
org
xml
sax
SAXException
int
l
s
length
accum
for
int
i
i
l
i
accum
s
charAt
i
accum
return
pos
public
void
characters
char
chars
int
start
int
length
throws
org
xml
sax
SAXException
if
m_isRawStack
peekOrFalse
try
writeParentTagEnd
m_ispreserve
if
shouldIndent
indent
m_currentIndent
writeNormalizedChars
chars
start
length
return
catch
IOException
ioe
throw
new
org
xml
sax
SAXException
XSLMessages
createXPATHMessage
XPATHErrorResources
ER_OIERROR
ioe
else
super
characters
chars
start
length
public
void
cdata
char
ch
int
start
int
length
throws
org
xml
sax
SAXException
if
m_currentElementName
m_currentElementName
equalsIgnoreCase
m_currentElementName
equalsIgnoreCase
try
writeParentTagEnd
m_ispreserve
if
shouldIndent
indent
m_currentIndent
writeNormalizedChars
ch
start
length
catch
IOException
ioe
throw
new
org
xml
sax
SAXException
XSLMessages
createXPATHMessage
XPATHErrorResources
ER_OIERROR
ioe
else
super
cdata
ch
start
length
public
void
processingInstruction
String
target
String
data
throws
org
xml
sax
SAXException
if
target
equals
Result
PI_DISABLE_OUTPUT_ESCAPING
startNonEscaping
else
if
target
equals
Result
PI_ENABLE_OUTPUT_ESCAPING
endNonEscaping
else
writeParentTagEnd
if
shouldIndent
indent
m_currentIndent
this
accum
target
if
data
length
Character
isSpaceChar
data
charAt
this
accum
this
accum
data
if
m_elemStack
isEmpty
outputLineSep
m_startNewLine
public
void
entityReference
String
name
throws
org
xml
sax
SAXException
this
accum
this
accum
name
this
accum
