package
org
apache
xalan
extensions
import
java
lang
reflect
Constructor
import
java
lang
reflect
Method
import
java
lang
reflect
Modifier
import
javax
xml
transform
TransformerException
import
org
apache
xalan
res
XSLMessages
import
org
apache
xalan
res
XSLTErrorResources
import
org
apache
xml
dtm
DTM
import
org
apache
xml
dtm
DTMIterator
import
org
apache
xml
dtm
ref
DTMNodeIterator
import
org
apache
xpath
objects
XObject
import
org
apache
xpath
objects
XRTreeFrag
import
org
apache
xpath
objects
XString
import
org
w3c
dom
Node
import
org
w3c
dom
NodeList
import
org
w3c
dom
traversal
NodeIterator
public
class
MethodResolver
public
static
final
int
STATIC_ONLY
public
static
final
int
INSTANCE_ONLY
public
static
final
int
STATIC_AND_INSTANCE
public
static
final
int
DYNAMIC
public
static
Constructor
getConstructor
Class
classObj
Object
argsIn
Object
argsOut
ExpressionContext
exprContext
throws
NoSuchMethodException
SecurityException
TransformerException
Constructor
bestConstructor
Class
bestParamTypes
Constructor
constructors
classObj
getConstructors
int
nMethods
constructors
length
int
bestScore
Integer
MAX_VALUE
int
bestScoreCount
for
int
i
i
nMethods
i
Constructor
ctor
constructors
i
Class
paramTypes
ctor
getParameterTypes
int
numberMethodParams
paramTypes
length
int
paramStart
boolean
isFirstExpressionContext
int
scoreStart
if
numberMethodParams
argsIn
length
Class
javaClass
paramTypes
if
ExpressionContext
class
isAssignableFrom
javaClass
isFirstExpressionContext
scoreStart
paramStart
else
continue
else
scoreStart
if
argsIn
length
numberMethodParams
paramStart
int
score
scoreMatch
paramTypes
paramStart
argsIn
scoreStart
if
score
continue
if
score
bestScore
bestConstructor
ctor
bestParamTypes
paramTypes
bestScore
score
bestScoreCount
else
if
score
bestScore
bestScoreCount
if
bestConstructor
throw
new
NoSuchMethodException
errString
classObj
argsIn
else
convertParams
argsIn
argsOut
bestParamTypes
exprContext
return
bestConstructor
public
static
Method
getMethod
Class
classObj
String
name
Object
argsIn
Object
argsOut
ExpressionContext
exprContext
int
searchMethod
throws
NoSuchMethodException
SecurityException
TransformerException
if
name
indexOf
name
replaceDash
name
Method
bestMethod
Class
bestParamTypes
Method
methods
classObj
getMethods
int
nMethods
methods
length
int
bestScore
Integer
MAX_VALUE
int
bestScoreCount
boolean
isStatic
for
int
i
i
nMethods
i
Method
method
methods
i
int
xsltParamStart
if
method
getName
equals
name
isStatic
Modifier
isStatic
method
getModifiers
switch
searchMethod
case
STATIC_ONLY
if
isStatic
continue
break
case
INSTANCE_ONLY
if
isStatic
continue
break
case
STATIC_AND_INSTANCE
break
case
DYNAMIC
if
isStatic
xsltParamStart
int
javaParamStart
Class
paramTypes
method
getParameterTypes
int
numberMethodParams
paramTypes
length
boolean
isFirstExpressionContext
int
scoreStart
int
argsLen
argsIn
argsIn
length
if
numberMethodParams
argsLen
xsltParamStart
Class
javaClass
paramTypes
if
ExpressionContext
class
isAssignableFrom
javaClass
isFirstExpressionContext
scoreStart
javaParamStart
else
continue
else
scoreStart
if
argsLen
xsltParamStart
numberMethodParams
javaParamStart
int
score
scoreMatch
paramTypes
javaParamStart
argsIn
scoreStart
if
score
continue
if
score
bestScore
bestMethod
method
bestParamTypes
paramTypes
bestScore
score
bestScoreCount
else
if
score
bestScore
bestScoreCount
if
bestMethod
throw
new
NoSuchMethodException
errString
classObj
name
searchMethod
argsIn
else
convertParams
argsIn
argsOut
bestParamTypes
exprContext
return
bestMethod
private
static
String
replaceDash
String
name
char
dash
StringBuffer
buff
new
StringBuffer
for
int
i
i
name
length
i
if
name
charAt
i
dash
else
if
i
name
charAt
i
dash
buff
append
Character
toUpperCase
name
charAt
i
else
buff
append
name
charAt
i
return
buff
toString
public
static
Method
getElementMethod
Class
classObj
String
name
throws
NoSuchMethodException
SecurityException
TransformerException
Method
bestMethod
Method
methods
classObj
getMethods
int
nMethods
methods
length
int
bestScoreCount
for
int
i
i
nMethods
i
Method
method
methods
i
if
method
getName
equals
name
Class
paramTypes
method
getParameterTypes
if
paramTypes
length
paramTypes
isAssignableFrom
org
apache
xalan
templates
ElemExtensionCall
class
paramTypes
isAssignableFrom
org
apache
xalan
extensions
XSLProcessorContext
class
if
bestScoreCount
bestMethod
method
else
break
if
bestMethod
throw
new
NoSuchMethodException
errString
classObj
name
else
if
bestScoreCount
throw
new
TransformerException
XSLMessages
createMessage
XSLTErrorResources
ER_MORE_MATCH_ELEMENT
new
Object
name
return
bestMethod
public
static
void
convertParams
Object
argsIn
Object
argsOut
Class
paramTypes
ExpressionContext
exprContext
throws
javax
xml
transform
TransformerException
if
paramTypes
argsOut
else
int
nParams
paramTypes
length
argsOut
new
Object
nParams
int
paramIndex
if
nParams
ExpressionContext
class
isAssignableFrom
paramTypes
argsOut
exprContext
paramIndex
if
argsIn
for
int
i
argsIn
length
nParams
paramIndex
paramIndex
nParams
i
paramIndex
argsOut
paramIndex
convert
argsIn
i
paramTypes
paramIndex
static
class
ConversionInfo
ConversionInfo
Class
cl
int
score
m_class
cl
m_score
score
Class
m_class
int
m_score
private
static
final
int
SCOREBASE
static
ConversionInfo
m_javaObjConversions
new
ConversionInfo
Double
TYPE
new
ConversionInfo
Float
TYPE
new
ConversionInfo
Long
TYPE
new
ConversionInfo
Integer
TYPE
new
ConversionInfo
Short
TYPE
new
ConversionInfo
Character
TYPE
new
ConversionInfo
Byte
TYPE
new
ConversionInfo
java
lang
String
class
static
ConversionInfo
m_booleanConversions
new
ConversionInfo
Boolean
TYPE
new
ConversionInfo
java
lang
Boolean
class
new
ConversionInfo
java
lang
Object
class
new
ConversionInfo
java
lang
String
class
static
ConversionInfo
m_numberConversions
new
ConversionInfo
Double
TYPE
new
ConversionInfo
java
lang
Double
class
new
ConversionInfo
Float
TYPE
new
ConversionInfo
Long
TYPE
new
ConversionInfo
Integer
TYPE
new
ConversionInfo
Short
TYPE
new
ConversionInfo
Character
TYPE
new
ConversionInfo
Byte
TYPE
new
ConversionInfo
Boolean
TYPE
new
ConversionInfo
java
lang
String
class
new
ConversionInfo
java
lang
Object
class
static
ConversionInfo
m_stringConversions
new
ConversionInfo
java
lang
String
class
new
ConversionInfo
java
lang
Object
class
new
ConversionInfo
Character
TYPE
new
ConversionInfo
Double
TYPE
new
ConversionInfo
Float
TYPE
new
ConversionInfo
Long
TYPE
new
ConversionInfo
Integer
TYPE
new
ConversionInfo
Short
TYPE
new
ConversionInfo
Byte
TYPE
new
ConversionInfo
Boolean
TYPE
static
ConversionInfo
m_rtfConversions
new
ConversionInfo
org
w3c
dom
traversal
NodeIterator
class
new
ConversionInfo
org
w3c
dom
NodeList
class
new
ConversionInfo
org
w3c
dom
Node
class
new
ConversionInfo
java
lang
String
class
new
ConversionInfo
java
lang
Object
class
new
ConversionInfo
Character
TYPE
new
ConversionInfo
Double
TYPE
new
ConversionInfo
Float
TYPE
new
ConversionInfo
Long
TYPE
new
ConversionInfo
Integer
TYPE
new
ConversionInfo
Short
TYPE
new
ConversionInfo
Byte
TYPE
new
ConversionInfo
Boolean
TYPE
static
ConversionInfo
m_nodesetConversions
new
ConversionInfo
org
w3c
dom
traversal
NodeIterator
class
new
ConversionInfo
org
w3c
dom
NodeList
class
new
ConversionInfo
org
w3c
dom
Node
class
new
ConversionInfo
java
lang
String
class
new
ConversionInfo
java
lang
Object
class
new
ConversionInfo
Character
TYPE
new
ConversionInfo
Double
TYPE
new
ConversionInfo
Float
TYPE
new
ConversionInfo
Long
TYPE
new
ConversionInfo
Integer
TYPE
new
ConversionInfo
Short
TYPE
new
ConversionInfo
Byte
TYPE
new
ConversionInfo
Boolean
TYPE
static
ConversionInfo
m_conversions
m_javaObjConversions
m_booleanConversions
m_numberConversions
m_stringConversions
m_nodesetConversions
m_rtfConversions
public
static
int
scoreMatch
Class
javaParamTypes
int
javaParamsStart
Object
xsltArgs
int
score
if
xsltArgs
javaParamTypes
return
score
int
nParams
xsltArgs
length
for
int
i
nParams
javaParamTypes
length
javaParamsStart
javaParamTypesIndex
javaParamsStart
i
nParams
i
javaParamTypesIndex
Object
xsltObj
xsltArgs
i
int
xsltClassType
xsltObj
instanceof
XObject
XObject
xsltObj
getType
XObject
CLASS_UNKNOWN
Class
javaClass
javaParamTypes
javaParamTypesIndex
if
xsltClassType
XObject
CLASS_NULL
if
javaClass
isPrimitive
score
continue
else
return
ConversionInfo
convInfo
m_conversions
xsltClassType
int
nConversions
convInfo
length
int
k
for
k
k
nConversions
k
ConversionInfo
cinfo
convInfo
k
if
javaClass
isAssignableFrom
cinfo
m_class
score
cinfo
m_score
break
if
k
nConversions
if
XObject
CLASS_UNKNOWN
xsltClassType
Class
realClass
if
xsltObj
instanceof
XObject
Object
realObj
XObject
xsltObj
object
if
realObj
realClass
realObj
getClass
else
score
continue
else
realClass
xsltObj
getClass
if
javaClass
isAssignableFrom
realClass
score
else
return
else
return
return
score
static
Object
convert
Object
xsltObj
Class
javaClass
throws
javax
xml
transform
TransformerException
if
xsltObj
instanceof
XObject
XObject
xobj
XObject
xsltObj
int
xsltClassType
xobj
getType
switch
xsltClassType
case
XObject
CLASS_NULL
return
case
XObject
CLASS_BOOLEAN
if
javaClass
java
lang
String
class
return
xobj
str
else
return
new
Boolean
xobj
bool
case
XObject
CLASS_NUMBER
if
javaClass
java
lang
String
class
return
xobj
str
else
if
javaClass
Boolean
TYPE
return
new
Boolean
xobj
bool
else
return
convertDoubleToNumber
xobj
num
javaClass
case
XObject
CLASS_STRING
if
javaClass
java
lang
String
class
javaClass
java
lang
Object
class
return
xobj
str
else
if
javaClass
Character
TYPE
String
str
xobj
str
if
str
length
return
new
Character
str
charAt
else
return
else
if
javaClass
Boolean
TYPE
return
new
Boolean
xobj
bool
else
return
convertDoubleToNumber
xobj
num
javaClass
case
XObject
CLASS_RTREEFRAG
if
javaClass
NodeIterator
class
javaClass
java
lang
Object
class
DTMIterator
dtmIter
XRTreeFrag
xobj
asNodeIterator
return
new
DTMNodeIterator
dtmIter
else
if
javaClass
NodeList
class
return
XRTreeFrag
xobj
convertToNodeset
else
if
javaClass
Node
class
DTMIterator
iter
XRTreeFrag
xobj
asNodeIterator
int
rootHandle
iter
nextNode
DTM
dtm
iter
getDTM
rootHandle
return
dtm
getNode
dtm
getFirstChild
rootHandle
else
if
javaClass
java
lang
String
class
return
xobj
str
else
if
javaClass
Boolean
TYPE
return
new
Boolean
xobj
bool
else
if
javaClass
isPrimitive
return
convertDoubleToNumber
xobj
num
javaClass
else
DTMIterator
iter
XRTreeFrag
xobj
asNodeIterator
int
rootHandle
iter
nextNode
DTM
dtm
iter
getDTM
rootHandle
Node
child
dtm
getNode
dtm
getFirstChild
rootHandle
if
javaClass
isAssignableFrom
child
getClass
return
child
else
return
case
XObject
CLASS_NODESET
if
javaClass
NodeIterator
class
javaClass
java
lang
Object
class
return
xobj
nodeset
else
if
javaClass
NodeList
class
return
xobj
nodelist
else
if
javaClass
Node
class
DTMIterator
ni
xobj
iter
int
handle
ni
nextNode
if
handle
DTM
NULL
return
ni
getDTM
handle
getNode
handle
else
return
else
if
javaClass
java
lang
String
class
return
xobj
str
else
if
javaClass
Boolean
TYPE
return
new
Boolean
xobj
bool
else
if
javaClass
isPrimitive
return
convertDoubleToNumber
xobj
num
javaClass
else
DTMIterator
iter
xobj
iter
int
childHandle
iter
nextNode
DTM
dtm
iter
getDTM
childHandle
Node
child
dtm
getNode
childHandle
if
javaClass
isAssignableFrom
child
getClass
return
child
else
return
xsltObj
xobj
object
if
xsltObj
if
javaClass
java
lang
String
class
return
xsltObj
toString
else
if
javaClass
isPrimitive
XString
xstr
new
XString
xsltObj
toString
double
num
xstr
num
return
convertDoubleToNumber
num
javaClass
else
if
javaClass
java
lang
Class
class
return
xsltObj
getClass
else
return
xsltObj
else
return
xsltObj
static
Object
convertDoubleToNumber
double
num
Class
javaClass
if
javaClass
Double
TYPE
javaClass
java
lang
Double
class
return
new
Double
num
else
if
javaClass
Float
TYPE
return
new
Float
num
else
if
javaClass
Long
TYPE
return
new
Long
long
num
else
if
javaClass
Integer
TYPE
return
new
Integer
int
num
else
if
javaClass
Short
TYPE
return
new
Short
short
num
else
if
javaClass
Character
TYPE
return
new
Character
char
num
else
if
javaClass
Byte
TYPE
return
new
Byte
byte
num
else
return
new
Double
num
private
static
String
errString
String
callType
String
searchType
Class
classObj
String
funcName
int
searchMethod
Object
xsltArgs
String
resultString
callType
searchType
switch
searchMethod
case
STATIC_ONLY
return
resultString
classObj
getName
funcName
errArgs
xsltArgs
case
INSTANCE_ONLY
return
resultString
classObj
getName
funcName
errArgs
xsltArgs
case
STATIC_AND_INSTANCE
return
resultString
classObj
getName
funcName
errArgs
xsltArgs
case
DYNAMIC
return
resultString
classObj
getName
funcName
errArgs
xsltArgs
classObj
funcName
errArgs
xsltArgs
default
if
callType
equals
return
resultString
classObj
getName
errArgs
xsltArgs
else
return
resultString
classObj
getName
funcName
private
static
String
errArgs
Object
xsltArgs
int
startingArg
StringBuffer
returnArgs
new
StringBuffer
for
int
i
startingArg
i
xsltArgs
length
i
if
i
startingArg
returnArgs
append
if
xsltArgs
i
instanceof
XObject
returnArgs
append
XObject
xsltArgs
i
getTypeString
else
returnArgs
append
xsltArgs
i
getClass
getName
return
returnArgs
toString
