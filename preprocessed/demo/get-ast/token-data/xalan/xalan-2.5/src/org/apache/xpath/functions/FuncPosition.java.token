package
org
apache
xpath
functions
import
org
apache
xml
dtm
DTM
import
org
apache
xml
dtm
DTMIterator
import
org
apache
xpath
XPathContext
import
org
apache
xpath
axes
SubContextList
import
org
apache
xpath
compiler
Compiler
import
org
apache
xpath
objects
XNumber
import
org
apache
xpath
objects
XObject
public
class
FuncPosition
extends
Function
private
boolean
m_isTopLevel
public
void
postCompileStep
Compiler
compiler
m_isTopLevel
compiler
getLocationPathDepth
public
int
getPositionInContextNodeList
XPathContext
xctxt
SubContextList
iter
m_isTopLevel
xctxt
getSubContextList
if
iter
int
prox
iter
getProximityPosition
xctxt
return
prox
DTMIterator
cnl
xctxt
getContextNodeList
if
cnl
int
n
cnl
getCurrentNode
if
n
DTM
NULL
if
cnl
getCurrentPos
return
try
cnl
cnl
cloneWithReset
catch
CloneNotSupportedException
cnse
throw
new
org
apache
xml
utils
WrappedRuntimeException
cnse
int
currentNode
xctxt
getContextNode
while
DTM
NULL
n
cnl
nextNode
if
n
currentNode
break
return
cnl
getCurrentPos
return
public
XObject
execute
XPathContext
xctxt
throws
javax
xml
transform
TransformerException
double
pos
double
getPositionInContextNodeList
xctxt
return
new
XNumber
pos
public
void
fixupVariables
java
util
Vector
vars
int
globalsSize
